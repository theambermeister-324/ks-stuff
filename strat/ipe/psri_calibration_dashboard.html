<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PSRI Calibration Dashboard</title>
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #0f0f1a;
      color: #fff;
      min-height: 100vh;
    }
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 24px;
    }
    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 32px;
      padding-bottom: 24px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    .header h1 {
      font-size: 1.8rem;
      font-weight: 700;
      background: linear-gradient(135deg, #fff 0%, #a78bfa 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .version-badge {
      background: linear-gradient(135deg, #6436bf 0%, #42247f 100%);
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      margin-bottom: 32px;
    }
    .grid-2 {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      margin-bottom: 32px;
    }
    .card {
      background: linear-gradient(145deg, #16213e 0%, #1a1a2e 100%);
      border-radius: 16px;
      padding: 24px;
      border: 1px solid rgba(100, 54, 191, 0.3);
    }
    .card-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 16px;
    }
    .card-header h3 {
      font-size: 0.85rem;
      font-weight: 600;
      color: rgba(255,255,255,0.7);
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .metric-value {
      font-size: 2.5rem;
      font-weight: 700;
      color: #fff;
      margin-bottom: 4px;
    }
    .metric-label {
      font-size: 0.8rem;
      color: rgba(255,255,255,0.5);
    }
    .metric-change {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 0.8rem;
      margin-top: 8px;
      padding: 4px 8px;
      border-radius: 4px;
    }
    .metric-change.positive { background: rgba(16, 185, 129, 0.2); color: #6ee7b7; }
    .metric-change.negative { background: rgba(239, 68, 68, 0.2); color: #fca5a5; }
    .metric-change.neutral { background: rgba(255,255,255,0.1); color: rgba(255,255,255,0.6); }
    .chart-container {
      position: relative;
      height: 300px;
    }
    .data-table {
      width: 100%;
      border-collapse: collapse;
    }
    .data-table th,
    .data-table td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    .data-table th {
      font-size: 0.75rem;
      font-weight: 600;
      color: rgba(255,255,255,0.5);
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .data-table td {
      font-size: 0.875rem;
      color: rgba(255,255,255,0.8);
    }
    .data-table tr:hover {
      background: rgba(255,255,255,0.03);
    }
    .status-badge {
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 600;
    }
    .status-badge.success { background: rgba(16, 185, 129, 0.2); color: #6ee7b7; }
    .status-badge.warning { background: rgba(251, 191, 36, 0.2); color: #fde047; }
    .status-badge.danger { background: rgba(239, 68, 68, 0.2); color: #fca5a5; }
    .status-badge.info { background: rgba(59, 130, 246, 0.2); color: #93c5fd; }
    .btn {
      padding: 10px 20px;
      border-radius: 8px;
      font-weight: 600;
      font-size: 0.875rem;
      border: none;
      cursor: pointer;
      transition: all 0.2s;
    }
    .btn-primary {
      background: linear-gradient(135deg, #6436bf 0%, #42247f 100%);
      color: white;
    }
    .btn-secondary {
      background: rgba(255,255,255,0.1);
      color: white;
      border: 1px solid rgba(255,255,255,0.2);
    }
    .btn:hover { transform: translateY(-2px); }
    .config-panel {
      background: rgba(255,255,255,0.03);
      border-radius: 12px;
      padding: 20px;
      margin-top: 16px;
    }
    .config-row {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 12px;
    }
    .config-label {
      font-size: 0.8rem;
      color: rgba(255,255,255,0.6);
      min-width: 150px;
    }
    .config-input {
      padding: 8px 12px;
      border-radius: 6px;
      border: 1px solid rgba(100, 54, 191, 0.4);
      background: rgba(255,255,255,0.03);
      color: #fff;
      font-size: 0.875rem;
      width: 100px;
    }
    .correlation-indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 16px;
      background: rgba(255,255,255,0.03);
      border-radius: 8px;
      margin-bottom: 12px;
    }
    .correlation-bar {
      flex: 1;
      height: 8px;
      background: rgba(255,255,255,0.1);
      border-radius: 4px;
      overflow: hidden;
    }
    .correlation-fill {
      height: 100%;
      border-radius: 4px;
      transition: width 0.3s;
    }
    .tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 24px;
    }
    .tab {
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 0.875rem;
      font-weight: 500;
      cursor: pointer;
      background: rgba(255,255,255,0.05);
      color: rgba(255,255,255,0.6);
      border: none;
      transition: all 0.2s;
    }
    .tab.active {
      background: rgba(100, 54, 191, 0.3);
      color: #fff;
    }
    .tab:hover:not(.active) {
      background: rgba(255,255,255,0.1);
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <div>
        <h1>PSRI Calibration Dashboard</h1>
        <p style="color: rgba(255,255,255,0.5); margin-top: 4px;">Track score-to-outcome correlation and validate index accuracy</p>
      </div>
      <div style="display: flex; align-items: center; gap: 16px;">
        <span class="version-badge">PSRI v1.0</span>
        <button class="btn btn-secondary" onclick="refreshData()">
          <i data-lucide="refresh-cw" style="width: 16px; height: 16px; margin-right: 6px;"></i>
          Refresh
        </button>
      </div>
    </div>

    <!-- Tabs -->
    <div class="tabs">
      <button class="tab active" onclick="showTab('overview')">Overview</button>
      <button class="tab" onclick="showTab('correlation')">Correlation Analysis</button>
      <button class="tab" onclick="showTab('questions')">Question Validation</button>
      <button class="tab" onclick="showTab('calibration')">Calibration Tools</button>
    </div>

    <!-- Overview Tab -->
    <div id="tab-overview">
      <!-- Key Metrics -->
      <div class="grid">
        <div class="card">
          <div class="card-header">
            <i data-lucide="users" style="width: 18px; height: 18px; color: #a78bfa;"></i>
            <h3>Total Assessments</h3>
          </div>
          <div class="metric-value" id="total-assessments">—</div>
          <div class="metric-label">All time</div>
          <div class="metric-change positive" id="assessments-change">
            <i data-lucide="trending-up" style="width: 14px; height: 14px;"></i>
            <span>+12 this week</span>
          </div>
        </div>
        <div class="card">
          <div class="card-header">
            <i data-lucide="gauge" style="width: 18px; height: 18px; color: #3b82f6;"></i>
            <h3>Average PSRI</h3>
          </div>
          <div class="metric-value" id="avg-psri">—</div>
          <div class="metric-label">Across all orgs</div>
          <div class="metric-change neutral" id="psri-change">
            <i data-lucide="minus" style="width: 14px; height: 14px;"></i>
            <span>No change</span>
          </div>
        </div>
        <div class="card">
          <div class="card-header">
            <i data-lucide="target" style="width: 18px; height: 18px; color: #10b981;"></i>
            <h3>Prediction Accuracy</h3>
          </div>
          <div class="metric-value" id="prediction-accuracy">—%</div>
          <div class="metric-label">Score → Outcome match</div>
          <div class="metric-change positive">
            <i data-lucide="trending-up" style="width: 14px; height: 14px;"></i>
            <span>+3% vs last month</span>
          </div>
        </div>
        <div class="card">
          <div class="card-header">
            <i data-lucide="git-compare" style="width: 18px; height: 18px; color: #fbbf24;"></i>
            <h3>Follow-up Rate</h3>
          </div>
          <div class="metric-value" id="followup-rate">—%</div>
          <div class="metric-label">Baseline → Follow-up</div>
          <div class="metric-change neutral">
            <i data-lucide="minus" style="width: 14px; height: 14px;"></i>
            <span>Target: 40%</span>
          </div>
        </div>
      </div>

      <!-- Charts -->
      <div class="grid-2">
        <div class="card">
          <div class="card-header">
            <i data-lucide="bar-chart-3" style="width: 18px; height: 18px; color: #a78bfa;"></i>
            <h3>PSRI Distribution</h3>
          </div>
          <div class="chart-container">
            <canvas id="distribution-chart"></canvas>
          </div>
        </div>
        <div class="card">
          <div class="card-header">
            <i data-lucide="pie-chart" style="width: 18px; height: 18px; color: #3b82f6;"></i>
            <h3>Archetype Distribution</h3>
          </div>
          <div class="chart-container">
            <canvas id="archetype-chart"></canvas>
          </div>
        </div>
      </div>

      <!-- Recent Assessments -->
      <div class="card">
        <div class="card-header">
          <i data-lucide="clock" style="width: 18px; height: 18px; color: #a78bfa;"></i>
          <h3>Recent Assessments</h3>
        </div>
        <table class="data-table">
          <thead>
            <tr>
              <th>Organization</th>
              <th>Industry</th>
              <th>PSRI</th>
              <th>Archetype</th>
              <th>Type</th>
              <th>Gating Applied</th>
              <th>Date</th>
            </tr>
          </thead>
          <tbody id="recent-assessments">
            <tr>
              <td colspan="7" style="text-align: center; color: rgba(255,255,255,0.4);">Loading...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Correlation Tab -->
    <div id="tab-correlation" style="display: none;">
      <div class="grid-2">
        <div class="card">
          <div class="card-header">
            <i data-lucide="trending-up" style="width: 18px; height: 18px; color: #10b981;"></i>
            <h3>Score-to-Outcome Correlation</h3>
          </div>
          <p style="font-size: 0.8rem; color: rgba(255,255,255,0.5); margin-bottom: 16px;">
            Correlation between PSRI score and engagement success metrics
          </p>
          
          <div class="correlation-indicator">
            <span style="font-size: 0.8rem; color: rgba(255,255,255,0.7); min-width: 120px;">PSRI → TTV</span>
            <div class="correlation-bar">
              <div class="correlation-fill" style="width: 78%; background: #10b981;"></div>
            </div>
            <span style="font-size: 0.8rem; font-weight: 600; color: #6ee7b7;">r = 0.78</span>
          </div>
          
          <div class="correlation-indicator">
            <span style="font-size: 0.8rem; color: rgba(255,255,255,0.7); min-width: 120px;">Foundation → Adoption</span>
            <div class="correlation-bar">
              <div class="correlation-fill" style="width: 82%; background: #10b981;"></div>
            </div>
            <span style="font-size: 0.8rem; font-weight: 600; color: #6ee7b7;">r = 0.82</span>
          </div>
          
          <div class="correlation-indicator">
            <span style="font-size: 0.8rem; color: rgba(255,255,255,0.7); min-width: 120px;">AI → Cycle Time</span>
            <div class="correlation-bar">
              <div class="correlation-fill" style="width: 71%; background: #3b82f6;"></div>
            </div>
            <span style="font-size: 0.8rem; font-weight: 600; color: #93c5fd;">r = 0.71</span>
          </div>
          
          <div class="correlation-indicator">
            <span style="font-size: 0.8rem; color: rgba(255,255,255,0.7); min-width: 120px;">Governance → Expansion</span>
            <div class="correlation-bar">
              <div class="correlation-fill" style="width: 65%; background: #3b82f6;"></div>
            </div>
            <span style="font-size: 0.8rem; font-weight: 600; color: #93c5fd;">r = 0.65</span>
          </div>
          
          <div class="correlation-indicator">
            <span style="font-size: 0.8rem; color: rgba(255,255,255,0.7); min-width: 120px;">Delivery → Retention</span>
            <div class="correlation-bar">
              <div class="correlation-fill" style="width: 58%; background: #fbbf24;"></div>
            </div>
            <span style="font-size: 0.8rem; font-weight: 600; color: #fde047;">r = 0.58</span>
          </div>
          
          <div style="margin-top: 16px; padding: 12px; background: rgba(16, 185, 129, 0.1); border-radius: 8px; border: 1px solid rgba(16, 185, 129, 0.3);">
            <p style="font-size: 0.8rem; color: #6ee7b7;">
              <strong>Interpretation:</strong> r > 0.7 = strong correlation, 0.5-0.7 = moderate, < 0.5 = weak
            </p>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <i data-lucide="scatter-chart" style="width: 18px; height: 18px; color: #a78bfa;"></i>
            <h3>PSRI vs Time-to-Value</h3>
          </div>
          <div class="chart-container">
            <canvas id="correlation-chart"></canvas>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <i data-lucide="git-branch" style="width: 18px; height: 18px; color: #fbbf24;"></i>
          <h3>Archetype Prediction Accuracy</h3>
        </div>
        <p style="font-size: 0.8rem; color: rgba(255,255,255,0.5); margin-bottom: 16px;">
          How well does PSRI archetype predict actual engagement path?
        </p>
        <table class="data-table">
          <thead>
            <tr>
              <th>Predicted Archetype</th>
              <th>Matched Outcome</th>
              <th>Upgraded</th>
              <th>Downgraded</th>
              <th>Accuracy</th>
              <th>n</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><span class="status-badge info">Foundation</span></td>
              <td>12</td>
              <td>3</td>
              <td>0</td>
              <td><span style="color: #6ee7b7; font-weight: 600;">80%</span></td>
              <td>15</td>
            </tr>
            <tr>
              <td><span class="status-badge info">Momentum</span></td>
              <td>8</td>
              <td>2</td>
              <td>1</td>
              <td><span style="color: #6ee7b7; font-weight: 600;">73%</span></td>
              <td>11</td>
            </tr>
            <tr>
              <td><span class="status-badge success">Scale</span></td>
              <td>18</td>
              <td>1</td>
              <td>2</td>
              <td><span style="color: #6ee7b7; font-weight: 600;">86%</span></td>
              <td>21</td>
            </tr>
            <tr>
              <td><span class="status-badge success">Intelligence</span></td>
              <td>5</td>
              <td>0</td>
              <td>1</td>
              <td><span style="color: #6ee7b7; font-weight: 600;">83%</span></td>
              <td>6</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Question Validation Tab -->
    <div id="tab-questions" style="display: none;">
      <div class="card">
        <div class="card-header">
          <i data-lucide="clipboard-check" style="width: 18px; height: 18px; color: #a78bfa;"></i>
          <h3>Question Predictive Power</h3>
        </div>
        <p style="font-size: 0.8rem; color: rgba(255,255,255,0.5); margin-bottom: 16px;">
          How well does each question predict engagement outcomes? Questions with low correlation may need revision.
        </p>
        <table class="data-table">
          <thead>
            <tr>
              <th>#</th>
              <th>Question</th>
              <th>Category</th>
              <th>Weight</th>
              <th>Correlation</th>
              <th>Status</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Q1</td>
              <td>Current state of design system</td>
              <td>Foundation</td>
              <td>1.5</td>
              <td><span style="color: #6ee7b7;">r = 0.81</span></td>
              <td><span class="status-badge success">Strong</span></td>
              <td>—</td>
            </tr>
            <tr>
              <td>Q2</td>
              <td>Governance structure</td>
              <td>Foundation</td>
              <td>2.0</td>
              <td><span style="color: #6ee7b7;">r = 0.85</span></td>
              <td><span class="status-badge success">Strong</span></td>
              <td>—</td>
            </tr>
            <tr>
              <td>Q3</td>
              <td>Documentation quality</td>
              <td>Foundation</td>
              <td>1.0</td>
              <td><span style="color: #93c5fd;">r = 0.62</span></td>
              <td><span class="status-badge info">Moderate</span></td>
              <td>—</td>
            </tr>
            <tr>
              <td>Q4</td>
              <td>AI tool usage</td>
              <td>AI Readiness</td>
              <td>1.5</td>
              <td><span style="color: #6ee7b7;">r = 0.74</span></td>
              <td><span class="status-badge success">Strong</span></td>
              <td>—</td>
            </tr>
            <tr>
              <td>Q5</td>
              <td>API maturity</td>
              <td>AI Readiness</td>
              <td>2.0</td>
              <td><span style="color: #6ee7b7;">r = 0.79</span></td>
              <td><span class="status-badge success">Strong</span></td>
              <td>—</td>
            </tr>
            <tr>
              <td>Q6</td>
              <td>Product data quality</td>
              <td>AI Readiness</td>
              <td>1.5</td>
              <td><span style="color: #93c5fd;">r = 0.68</span></td>
              <td><span class="status-badge info">Moderate</span></td>
              <td>—</td>
            </tr>
            <tr>
              <td>Q7</td>
              <td>Executive sponsor</td>
              <td>Governance</td>
              <td>2.0</td>
              <td><span style="color: #6ee7b7;">r = 0.88</span></td>
              <td><span class="status-badge success">Strong</span></td>
              <td>—</td>
            </tr>
            <tr>
              <td>Q8</td>
              <td>Budget commitment</td>
              <td>Governance</td>
              <td>1.5</td>
              <td><span style="color: #6ee7b7;">r = 0.76</span></td>
              <td><span class="status-badge success">Strong</span></td>
              <td>—</td>
            </tr>
            <tr>
              <td>Q9</td>
              <td>Change capacity</td>
              <td>Governance</td>
              <td>1.0</td>
              <td><span style="color: #fde047;">r = 0.48</span></td>
              <td><span class="status-badge warning">Weak</span></td>
              <td><button class="btn btn-secondary" style="padding: 4px 12px; font-size: 0.75rem;">Review</button></td>
            </tr>
            <tr>
              <td>Q10</td>
              <td>Decision clarity</td>
              <td>Delivery</td>
              <td>1.0</td>
              <td><span style="color: #93c5fd;">r = 0.55</span></td>
              <td><span class="status-badge info">Moderate</span></td>
              <td>—</td>
            </tr>
          </tbody>
        </table>
        <div style="margin-top: 16px; padding: 12px; background: rgba(251, 191, 36, 0.1); border-radius: 8px; border: 1px solid rgba(251, 191, 36, 0.3);">
          <p style="font-size: 0.8rem; color: #fde047;">
            <strong>⚠️ Action Required:</strong> Q9 (Change capacity) has weak correlation (r = 0.48). Consider revising the question wording or adjusting its weight.
          </p>
        </div>
      </div>
    </div>

    <!-- Calibration Tools Tab -->
    <div id="tab-calibration" style="display: none;">
      <div class="grid-2">
        <div class="card">
          <div class="card-header">
            <i data-lucide="sliders" style="width: 18px; height: 18px; color: #a78bfa;"></i>
            <h3>Weight Simulator</h3>
          </div>
          <p style="font-size: 0.8rem; color: rgba(255,255,255,0.5); margin-bottom: 16px;">
            Test how weight changes affect PSRI distribution and prediction accuracy
          </p>
          
          <div class="config-panel">
            <div class="config-row">
              <span class="config-label">Foundation Weight</span>
              <input type="number" class="config-input" id="sim-foundation" value="0.25" min="0" max="1" step="0.05">
              <span style="font-size: 0.75rem; color: rgba(255,255,255,0.4);">Current: 0.25</span>
            </div>
            <div class="config-row">
              <span class="config-label">AI Readiness Weight</span>
              <input type="number" class="config-input" id="sim-ai" value="0.30" min="0" max="1" step="0.05">
              <span style="font-size: 0.75rem; color: rgba(255,255,255,0.4);">Current: 0.30</span>
            </div>
            <div class="config-row">
              <span class="config-label">Governance Weight</span>
              <input type="number" class="config-input" id="sim-governance" value="0.25" min="0" max="1" step="0.05">
              <span style="font-size: 0.75rem; color: rgba(255,255,255,0.4);">Current: 0.25</span>
            </div>
            <div class="config-row">
              <span class="config-label">Delivery Weight</span>
              <input type="number" class="config-input" id="sim-delivery" value="0.20" min="0" max="1" step="0.05">
              <span style="font-size: 0.75rem; color: rgba(255,255,255,0.4);">Current: 0.20</span>
            </div>
            <div style="margin-top: 16px; display: flex; gap: 12px;">
              <button class="btn btn-primary" onclick="runSimulation()">Run Simulation</button>
              <button class="btn btn-secondary" onclick="resetWeights()">Reset to Current</button>
            </div>
          </div>
          
          <div id="simulation-results" style="display: none; margin-top: 16px; padding: 16px; background: rgba(255,255,255,0.03); border-radius: 8px;">
            <h4 style="font-size: 0.85rem; font-weight: 600; color: #fff; margin-bottom: 12px;">Simulation Results</h4>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">
              <div>
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5);">Avg PSRI Change</p>
                <p style="font-size: 1.1rem; font-weight: 600; color: #fff;">+2.3 points</p>
              </div>
              <div>
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5);">Prediction Accuracy</p>
                <p style="font-size: 1.1rem; font-weight: 600; color: #6ee7b7;">+1.2%</p>
              </div>
              <div>
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5);">Archetype Shifts</p>
                <p style="font-size: 1.1rem; font-weight: 600; color: #fde047;">4 orgs</p>
              </div>
              <div>
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5);">Recommendation</p>
                <p style="font-size: 0.85rem; font-weight: 600; color: #93c5fd;">Consider adopting</p>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <i data-lucide="shield-check" style="width: 18px; height: 18px; color: #10b981;"></i>
            <h3>Gating Threshold Tuning</h3>
          </div>
          <p style="font-size: 0.8rem; color: rgba(255,255,255,0.5); margin-bottom: 16px;">
            Adjust foundation and governance thresholds for gated progression
          </p>
          
          <div class="config-panel">
            <div class="config-row">
              <span class="config-label">Foundation Threshold</span>
              <input type="number" class="config-input" id="gate-foundation" value="40" min="0" max="100">
              <span style="font-size: 0.75rem; color: rgba(255,255,255,0.4);">AI gated if below</span>
            </div>
            <div class="config-row">
              <span class="config-label">AI Discount Factor</span>
              <input type="number" class="config-input" id="gate-ai-discount" value="0.5" min="0" max="1" step="0.1">
              <span style="font-size: 0.75rem; color: rgba(255,255,255,0.4);">Multiplier when gated</span>
            </div>
            <div class="config-row">
              <span class="config-label">Governance Threshold</span>
              <input type="number" class="config-input" id="gate-governance" value="30" min="0" max="100">
              <span style="font-size: 0.75rem; color: rgba(255,255,255,0.4);">Delivery gated if below</span>
            </div>
            <div class="config-row">
              <span class="config-label">Delivery Discount Factor</span>
              <input type="number" class="config-input" id="gate-delivery-discount" value="0.7" min="0" max="1" step="0.1">
              <span style="font-size: 0.75rem; color: rgba(255,255,255,0.4);">Multiplier when gated</span>
            </div>
            <div style="margin-top: 16px;">
              <button class="btn btn-primary" onclick="testGating()">Test Gating Impact</button>
            </div>
          </div>
          
          <div style="margin-top: 16px; padding: 12px; background: rgba(59, 130, 246, 0.1); border-radius: 8px; border: 1px solid rgba(59, 130, 246, 0.3);">
            <p style="font-size: 0.8rem; color: #93c5fd;">
              <strong>Current Impact:</strong> 23% of assessments have AI gating applied, 8% have Delivery gating applied.
            </p>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <i data-lucide="download" style="width: 18px; height: 18px; color: #a78bfa;"></i>
          <h3>Export & Version Control</h3>
        </div>
        <div style="display: flex; gap: 16px; flex-wrap: wrap;">
          <button class="btn btn-primary" onclick="exportConfig()">
            <i data-lucide="download" style="width: 16px; height: 16px; margin-right: 6px;"></i>
            Export Current Config
          </button>
          <button class="btn btn-secondary" onclick="exportData()">
            <i data-lucide="table" style="width: 16px; height: 16px; margin-right: 6px;"></i>
            Export Assessment Data
          </button>
          <button class="btn btn-secondary" onclick="showVersionHistory()">
            <i data-lucide="history" style="width: 16px; height: 16px; margin-right: 6px;"></i>
            Version History
          </button>
        </div>
        
        <div style="margin-top: 24px;">
          <h4 style="font-size: 0.85rem; font-weight: 600; color: rgba(255,255,255,0.7); margin-bottom: 12px;">Configuration History</h4>
          <table class="data-table">
            <thead>
              <tr>
                <th>Version</th>
                <th>Date</th>
                <th>Changes</th>
                <th>Author</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>v1.0</td>
                <td>2026-02-04</td>
                <td>Initial release with 4 pillars, gated progression</td>
                <td>Knapsack</td>
                <td><span class="status-badge success">Current</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Sample data for demonstration
    const sampleData = {
      totalAssessments: 158,
      avgPsri: 54,
      predictionAccuracy: 81,
      followupRate: 32,
      recentAssessments: [
        { org: 'acme-corp.com', industry: 'Financial Services', psri: 67, archetype: 'Scale', type: 'baseline', gating: { ai: false, delivery: false }, date: '2026-02-04' },
        { org: 'techstart.io', industry: 'Technology', psri: 42, archetype: 'Foundation', type: 'follow-up', gating: { ai: true, delivery: false }, date: '2026-02-03' },
        { org: 'healthco.com', industry: 'Healthcare', psri: 58, archetype: 'Momentum', type: 'baseline', gating: { ai: false, delivery: true }, date: '2026-02-02' },
        { org: 'retailmax.com', industry: 'Retail', psri: 71, archetype: 'Scale', type: 'baseline', gating: { ai: false, delivery: false }, date: '2026-02-01' },
        { org: 'finserv-global.com', industry: 'Financial Services', psri: 83, archetype: 'Intelligence', type: 'follow-up', gating: { ai: false, delivery: false }, date: '2026-01-31' }
      ]
    };

    // Initialize dashboard
    function init() {
      updateMetrics();
      renderRecentAssessments();
      initCharts();
      lucide.createIcons();
    }

    function updateMetrics() {
      document.getElementById('total-assessments').textContent = sampleData.totalAssessments;
      document.getElementById('avg-psri').textContent = sampleData.avgPsri;
      document.getElementById('prediction-accuracy').textContent = sampleData.predictionAccuracy + '%';
      document.getElementById('followup-rate').textContent = sampleData.followupRate + '%';
    }

    function renderRecentAssessments() {
      const tbody = document.getElementById('recent-assessments');
      tbody.innerHTML = sampleData.recentAssessments.map(a => `
        <tr>
          <td>${a.org}</td>
          <td>${a.industry}</td>
          <td><strong>${a.psri}</strong></td>
          <td><span class="status-badge ${a.archetype === 'Intelligence' || a.archetype === 'Scale' ? 'success' : 'info'}">${a.archetype}</span></td>
          <td><span class="status-badge ${a.type === 'follow-up' ? 'warning' : 'info'}">${a.type}</span></td>
          <td>${a.gating.ai || a.gating.delivery ? '<span style="color: #fde047;">Yes</span>' : '<span style="color: rgba(255,255,255,0.4);">No</span>'}</td>
          <td>${a.date}</td>
        </tr>
      `).join('');
    }

    function initCharts() {
      // Distribution Chart
      const distCtx = document.getElementById('distribution-chart').getContext('2d');
      new Chart(distCtx, {
        type: 'bar',
        data: {
          labels: ['0-20', '21-40', '41-60', '61-80', '81-100'],
          datasets: [{
            label: 'Assessments',
            data: [8, 32, 58, 42, 18],
            backgroundColor: 'rgba(100, 54, 191, 0.6)',
            borderColor: 'rgba(100, 54, 191, 1)',
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } },
          scales: {
            y: { grid: { color: 'rgba(255,255,255,0.1)' }, ticks: { color: 'rgba(255,255,255,0.6)' } },
            x: { grid: { display: false }, ticks: { color: 'rgba(255,255,255,0.6)' } }
          }
        }
      });

      // Archetype Chart
      const archCtx = document.getElementById('archetype-chart').getContext('2d');
      new Chart(archCtx, {
        type: 'doughnut',
        data: {
          labels: ['Foundation', 'Momentum', 'Scale', 'Intelligence'],
          datasets: [{
            data: [35, 28, 42, 15],
            backgroundColor: [
              'rgba(100, 100, 120, 0.8)',
              'rgba(59, 130, 246, 0.8)',
              'rgba(16, 185, 129, 0.8)',
              'rgba(139, 92, 246, 0.8)'
            ],
            borderWidth: 0
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'right',
              labels: { color: 'rgba(255,255,255,0.8)', padding: 16 }
            }
          }
        }
      });

      // Correlation Chart (scatter)
      const corrCtx = document.getElementById('correlation-chart').getContext('2d');
      new Chart(corrCtx, {
        type: 'scatter',
        data: {
          datasets: [{
            label: 'PSRI vs TTV (weeks)',
            data: [
              { x: 35, y: 16 }, { x: 42, y: 14 }, { x: 48, y: 12 },
              { x: 55, y: 10 }, { x: 62, y: 9 }, { x: 68, y: 8 },
              { x: 72, y: 7 }, { x: 78, y: 6 }, { x: 85, y: 5 },
              { x: 38, y: 15 }, { x: 52, y: 11 }, { x: 65, y: 8 },
              { x: 45, y: 13 }, { x: 58, y: 10 }, { x: 75, y: 6 }
            ],
            backgroundColor: 'rgba(100, 54, 191, 0.6)',
            borderColor: 'rgba(100, 54, 191, 1)',
            pointRadius: 6
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } },
          scales: {
            y: {
              title: { display: true, text: 'Time to Value (weeks)', color: 'rgba(255,255,255,0.6)' },
              grid: { color: 'rgba(255,255,255,0.1)' },
              ticks: { color: 'rgba(255,255,255,0.6)' },
              reverse: true
            },
            x: {
              title: { display: true, text: 'PSRI Score', color: 'rgba(255,255,255,0.6)' },
              grid: { color: 'rgba(255,255,255,0.1)' },
              ticks: { color: 'rgba(255,255,255,0.6)' }
            }
          }
        }
      });
    }

    function showTab(tabId) {
      // Hide all tabs
      document.querySelectorAll('[id^="tab-"]').forEach(tab => tab.style.display = 'none');
      // Show selected tab
      document.getElementById('tab-' + tabId).style.display = 'block';
      // Update tab buttons
      document.querySelectorAll('.tab').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
    }

    function refreshData() {
      alert('Data refresh would connect to Google Sheets API. Configure GOOGLE_SHEETS_WEBAPP_URL in the assessment to enable.');
    }

    function runSimulation() {
      const f = parseFloat(document.getElementById('sim-foundation').value);
      const a = parseFloat(document.getElementById('sim-ai').value);
      const g = parseFloat(document.getElementById('sim-governance').value);
      const d = parseFloat(document.getElementById('sim-delivery').value);
      
      if (Math.abs(f + a + g + d - 1.0) > 0.01) {
        alert('Weights must sum to 1.0. Current sum: ' + (f + a + g + d).toFixed(2));
        return;
      }
      
      document.getElementById('simulation-results').style.display = 'block';
    }

    function resetWeights() {
      document.getElementById('sim-foundation').value = 0.25;
      document.getElementById('sim-ai').value = 0.30;
      document.getElementById('sim-governance').value = 0.25;
      document.getElementById('sim-delivery').value = 0.20;
      document.getElementById('simulation-results').style.display = 'none';
    }

    function testGating() {
      alert('Gating impact analysis would recalculate all assessments with new thresholds. Configure data source to enable.');
    }

    function exportConfig() {
      const config = {
        version: '1.0',
        date: new Date().toISOString(),
        weights: {
          foundation: 0.25,
          ai: 0.30,
          governance: 0.25,
          delivery: 0.20
        },
        gating: {
          foundationThreshold: 40,
          aiDiscountFactor: 0.5,
          governanceThreshold: 30,
          deliveryDiscountFactor: 0.7
        }
      };
      
      const blob = new Blob([JSON.stringify(config, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'psri-config-v1.0.json';
      a.click();
      URL.revokeObjectURL(url);
    }

    function exportData() {
      alert('Data export would download all assessment records from Google Sheets. Configure data source to enable.');
    }

    function showVersionHistory() {
      alert('Version history would show all configuration changes over time. This is v1.0 - initial release.');
    }

    // Initialize on load
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>

