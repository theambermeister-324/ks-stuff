<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IPE Strategic Playbook</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    [data-section] { display: none; }
    [data-section].active { display: block; }
    .chevron { transition: transform 0.2s; }
    .chevron.rotated { transform: rotate(180deg); }
    .icon { width: 1em; height: 1em; display: inline-block; vertical-align: middle; }
  </style>
</head>
<body class="min-h-screen bg-slate-50 flex">
  <!-- Sidebar Navigation -->
  <nav class="w-56 bg-slate-900 text-white p-4 flex-shrink-0">
    <div class="mb-6">
      <h1 class="text-lg font-bold">IPE Playbook</h1>
      <p class="text-xs text-slate-400">Internal Leadership Guide</p>
      <span class="inline-block mt-2 px-2 py-0.5 bg-red-500/20 text-red-300 text-xs rounded">CONFIDENTIAL</span>
    </div>
    <div class="space-y-1" id="sidebar-nav">
      <!-- Navigation buttons will be rendered here by JS -->
    </div>
  </nav>

  <!-- Main Content -->
  <main class="flex-1 p-6 overflow-auto">
    <div id="content-sections" class="space-y-6 max-w-5xl">
      <!-- Sections will be rendered here by JS -->
    </div>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      let activeSection = 'vision';
      let selectedJourney = null;
      let selectedPhase = null;
      let selectedQuadrant = null;
      let showDecisionTree = false;
      let selectedExample = null;

      const iconSVG = {
        target: '<svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>',
        layers: '<svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="m12.83 2.18a1 1 0 0 0-1.66 0L2 6v12l9.17-3.82a1 1 0 0 0 .66 0L22 18V6l-9.17-3.82Z"/><path d="m22 6-9.17 3.82a1 1 0 0 1-.66 0L2 6"/><path d="m22 12-9.17 3.82a1 1 0 0 1-.66 0L2 12"/></svg>',
        barChart: '<svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M3 3v18h18"/><path d="M7 16l4-4 4 4 6-6"/><path d="M7 12h10"/></svg>',
        gitBranch: '<svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M6 3v12"/><circle cx="18" cy="6" r="3"/><circle cx="6" cy="18" r="3"/><path d="M18 9a9 9 0 0 1-9 9"/></svg>',
        clock: '<svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>',
        shield: '<svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10Z"/></svg>',
        trendingUp: '<svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="m3 17 9-9 5 5 7-7"/><path d="M14 7h7v7"/></svg>',
        alertTriangle: '<svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><path d="M12 9v4"/><path d="M12 17h.01"/></svg>',
        building: '<svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M6 22V7M18 22V7M2 22h20M2 7h20M10 10h4M10 14h4M10 18h4M5 7V4h14v3"/></svg>',
        star: '<svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="m12 2 3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2Z"/></svg>',
        lock: '<svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>',
        unlock: '<svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 9.9-1"/></svg>',
        checkCircle: '<svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>',
        xCircle: '<svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg>',
        chevronDown: '<svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="m6 9 6 6 6-6"/></svg>',
      };

      const sectionsData = [
        { id: 'vision', label: 'Vision & Market', icon: iconSVG.target },
        { id: 'maturity', label: 'Maturity Model', icon: iconSVG.layers },
        { id: 'assessment', label: 'Assessment Framework', icon: iconSVG.barChart },
        { id: 'journeys', label: 'Customer Journeys', icon: iconSVG.gitBranch },
        { id: 'phases', label: 'Engagement Phases', icon: iconSVG.clock },
        { id: 'guidance', label: 'Operating Guidance', icon: iconSVG.shield },
        { id: 'metrics', label: 'Metrics', icon: iconSVG.trendingUp },
      ];

      const journeysData = [
        { id: 'j1', name: 'Progressive Maturation', path: 'A → B → F → H', arr: '~10%', risk: 'low', color: 'slate', desc: 'True non-ICP or low readiness — don\'t overinvest', expansion: false, accounts: ['Associated Press', 'Bright Horizons', 'MSK', 'Accutech'] },
        { id: 'j2', name: 'Independent Maturation', path: 'A → D → H', arr: '~5%', risk: 'low', color: 'blue', desc: 'Mature orgs; sudden trigger; fast activation required', expansion: true, accounts: ['Adobe'] },
        { id: 'j3', name: 'Services Transformation', path: 'E → F/G → H', arr: '~60%', risk: 'high', color: 'emerald', desc: 'High-value ICP accounts blocked on activation + trust', expansion: false, accounts: ['PNC', 'Edward Jones', 'DoubleVerify', 'Qualcomm', 'GSK US', 'HealthEdge'], primary: true },
        { id: 'j4', name: 'Timing Play', path: 'D → H', arr: '~25%', risk: 'medium', color: 'violet', desc: 'Mature systems; latent interest; needs trigger + crisp activation', expansion: true, accounts: ['The Home Depot', 'CSX', 'GSK Global', 'Crown Equipment'] },
      ];

      const phasesData = [
        { num: 1, name: 'Stabilize & Complete', level: 'Level 3 → Operational', mcp: 'locked', color: 'slate', goal: 'Make the platform reliably usable for real teams, without heroics.', workstreams: ['Workspace Go-Live', 'Entitlement setup', 'Repo/Figma access', 'Deployment checklists'], exitCriteria: ['Teams can publish without intervention', 'Workspace 2 live', 'Access no longer blocking work'] },
        { num: 2, name: 'Control Plane & Governance', level: 'Level 3 → Level 4', mcp: 'locked', color: 'blue', goal: 'Turn "systems" into a system of record with decision authority.', workstreams: ['Token Strategy POV', 'Governance model definition', 'System Charter', 'PI prioritization rubric'], exitCriteria: ['Token strategy approved', 'Governance model active', 'Clear cross-system rules'] },
        { num: 3, name: 'Execution Enablement', level: 'Level 4 Operational', mcp: 'prep', color: 'amber', goal: 'Prove that governed intent can safely become production change.', workstreams: ['Component modularization', 'Testing architecture', 'Code Connect mapping', 'Migration docs'], exitCriteria: ['One change ships end-to-end', 'Upgrade path validated', 'Teams trust the system'] },
        { num: 4, name: 'Signals & Intelligence', level: 'Level 4 → Level 5', mcp: 'unlocked', color: 'emerald', goal: 'Introduce intelligence only after trust exists.', workstreams: ['Signal capture + dashboards', 'MCP onboarding', 'Change readiness surveys', 'FDE assignment'], exitCriteria: ['Signals prove faster change', 'MCP adds value safely', 'Execs articulate ROI'] },
      ];

      const quadrantsData = [
        { id: 'A', profile: 'Low context, Low AI', journey: 'J1', color: 'slate', x: 0, y: 0 },
        { id: 'B', profile: 'Low context, High AI', journey: 'J1→J3', color: 'slate', x: 1, y: 0 },
        { id: 'C', profile: 'High context, Low interest', journey: 'J1/Exit', color: 'slate', x: 0, y: 1 },
        { id: 'D', profile: 'High context, Latent', journey: 'J2/J4', color: 'blue', x: 1, y: 1 },
        { id: 'E', profile: 'Interest w/o structure', journey: 'J3', color: 'emerald', x: 0, y: 2, active: true },
        { id: 'F', profile: 'AI ambition w/o context', journey: 'J3', color: 'emerald', x: 1, y: 2, active: true },
        { id: 'G', profile: 'Strong system, Low intel', journey: 'J3', color: 'emerald', x: 0, y: 3, active: true },
        { id: 'H', profile: 'IPE-ready', journey: 'J2/J4', color: 'violet', x: 1, y: 3 },
      ];

      const examplesData = [
        { name: 'PNC', maturity: 3, ai: 'Medium', interest: 'High', implemented: false, trust: 'Yellow', fit: true, quadrant: 'E', result: 'J3', color: 'emerald' },
        { name: 'Adobe', maturity: 4, ai: 'High', interest: 'High', implemented: true, trust: 'Green', fit: true, quadrant: 'H', result: 'J2', color: 'blue' },
        { name: 'Home Depot', maturity: 4, ai: 'Medium', interest: 'Latent', implemented: true, trust: 'Green', fit: true, quadrant: 'D', result: 'J4', color: 'violet' },
      ];

      const getColorClass = (color, type) => {
        const colors = {
          slate: { bg: 'bg-slate-100', border: 'border-slate-300', text: 'text-slate-700', accent: 'bg-slate-600', light: 'bg-slate-50' },
          blue: { bg: 'bg-blue-100', border: 'border-blue-300', text: 'text-blue-700', accent: 'bg-blue-600', light: 'bg-blue-50' },
          emerald: { bg: 'bg-emerald-100', border: 'border-emerald-300', text: 'text-emerald-700', accent: 'bg-emerald-600', light: 'bg-emerald-50' },
          violet: { bg: 'bg-violet-100', border: 'border-violet-300', text: 'text-violet-700', accent: 'bg-violet-600', light: 'bg-violet-50' },
          amber: { bg: 'bg-amber-100', border: 'border-amber-300', text: 'text-amber-700', accent: 'bg-amber-600', light: 'bg-amber-50' },
          rose: { bg: 'bg-rose-100', border: 'border-rose-300', text: 'text-rose-700', accent: 'bg-rose-600', light: 'bg-rose-50' },
        };
        return colors[color]?.[type] || '';
      };

      const renderSidebar = () => {
        const navContainer = document.getElementById('sidebar-nav');
        if (!navContainer) return;
        navContainer.innerHTML = sectionsData.map(s => `
          <button data-section-id="${s.id}" class="nav-btn w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm transition-all ${activeSection === s.id ? 'bg-emerald-500 text-white' : 'text-slate-300 hover:bg-slate-800'}">
            ${s.icon}
            ${s.label}
          </button>
        `).join('');

        navContainer.querySelectorAll('.nav-btn').forEach(button => {
          button.addEventListener('click', () => {
            activeSection = button.dataset.sectionId;
            renderContent();
            renderSidebar();
          });
        });
      };

      const renderContent = () => {
        const contentContainer = document.getElementById('content-sections');
        if (!contentContainer) return;
        contentContainer.innerHTML = '';

        if (activeSection === 'vision') {
          contentContainer.innerHTML = `
            <div class="bg-gradient-to-r from-slate-900 to-slate-800 text-white rounded-xl p-6">
              <p class="text-emerald-400 text-sm font-semibold mb-2">STRATEGIC NORTH STAR</p>
              <h2 class="text-xl font-bold mb-4">Knapsack becomes the Intelligent Product Engine enterprises trust to execute product change—safely, governably, and at scale—in the AI era.</h2>
              <div class="grid grid-cols-4 gap-3 mt-4">
                ${[{ label: 'Product intent', value: 'Executable, not descriptive' }, { label: 'Systems', value: 'Evolve as one' }, { label: 'AI context', value: 'Trusted & structured' }, { label: 'Delivery', value: 'Faster via governance' }].map((s, i) => `
                  <div class="bg-white/10 rounded-lg p-3">
                    <p class="text-emerald-400 text-xs">${s.label}</p>
                    <p class="text-sm font-medium">${s.value}</p>
                  </div>
                `).join('')}
              </div>
            </div>

            <div class="grid grid-cols-2 gap-4">
              <div class="bg-white rounded-xl border p-5">
                <h3 class="font-semibold mb-3">Market Definition</h3>
                <p class="text-sm text-slate-600 mb-3">Knapsack competes in <span class="font-semibold text-slate-900">Product Intelligence Infrastructure</span>:</p>
                <div class="space-y-2">
                  ${['Product system infrastructure', 'Orchestration & governance', 'Product intelligence', 'AI product enablement'].map((item, i) => `
                    <div class="flex items-center gap-2 text-sm">
                      <div class="w-1.5 h-1.5 rounded-full bg-emerald-500"></div>
                      ${item}
                    </div>
                  `).join('')}
                </div>
              </div>
              <div class="bg-white rounded-xl border p-5">
                <h3 class="font-semibold mb-3">TAM by Capability Layer</h3>
                <div class="space-y-2">
                  ${[{ l: 'L1 Product System Infrastructure', v: '$5–8B' }, { l: 'L2 Product Orchestration', v: '$12–18B' }, { l: 'L3 Product Intelligence', v: '$30–40B' }, { l: 'L4 AI Product Enablement', v: '$15–25B' }].map((r, i) => `
                    <div class="flex justify-between text-sm py-1 border-b border-slate-100">
                      <span class="text-slate-600">${r.l}</span>
                      <span class="font-semibold">${r.v}</span>
                    </div>
                  `).join('')}
                  <div class="flex justify-between text-sm py-2 bg-emerald-50 rounded px-2 mt-2">
                    <span class="font-semibold text-emerald-700">Total TAM</span>
                    <span class="font-bold text-emerald-700">$62–91B</span>
                  </div>
                </div>
              </div>
            </div>

            <div class="bg-amber-50 border border-amber-200 rounded-xl p-5">
              <h3 class="font-semibold text-amber-800 mb-2">The Problem We Solve</h3>
              <p class="text-sm text-amber-700 mb-3">Modern enterprises don't fail because they lack tools. They fail because product knowledge is fragmented, implicit, and non-operational:</p>
              <div class="flex flex-wrap gap-2">
                ${['Design intent lives in files', 'Engineering reality lives in code', 'Decisions live in meetings', 'AI operates without structure'].map((t, i) => `
                  <span class="px-3 py-1 bg-amber-100 text-amber-800 rounded-full text-xs">${t}</span>
                `).join('')}
              </div>
            </div>
          `;
        } else if (activeSection === 'maturity') {
          contentContainer.innerHTML = `
            <h2 class="text-2xl font-bold">Product System Maturity Model</h2>
            <p class="text-slate-600">Five levels define where customers are and where they need to go.</p>
            
            <div class="bg-white rounded-xl border p-5 space-y-3">
              ${[{ l: 1, name: 'UI Artifacts', desc: 'Static mockups, no system connection', sam: false },
                { l: 2, name: 'Design Library', desc: 'Organized components, limited code integration', sam: false },
                { l: 3, name: 'Integrated Product System', desc: 'Design-to-code connection, basic governance', sam: true },
                { l: 4, name: 'Scaled Product System', desc: 'Control plane operating, cross-system governance', sam: true },
                { l: 5, name: 'IPE-Activated System', desc: 'Control plane operated + governed, full intelligence layer', sam: true }].map((level) => `
                <div class="flex items-center gap-4 p-3 rounded-lg transition-all hover:bg-slate-50 ${level.sam ? 'border-l-4 border-emerald-500' : ''}">
                  <div class="w-10 h-10 rounded-full flex items-center justify-center text-white font-bold ${level.l === 1 ? 'bg-slate-400' : level.l === 2 ? 'bg-amber-500' : level.l === 3 ? 'bg-blue-500' : level.l === 4 ? 'bg-emerald-500' : 'bg-violet-500'}">
                    ${level.l}
                  </div>
                  <div class="flex-1">
                    <p class="font-semibold">${level.name}</p>
                    <p class="text-sm text-slate-500">${level.desc}</p>
                  </div>
                  ${level.sam ? '<span class="px-2 py-1 bg-emerald-100 text-emerald-700 text-xs rounded">SAM</span>' : ''}
                </div>
              `).join('')}
            </div>

            <div class="bg-rose-50 border-2 border-rose-200 rounded-xl p-5">
              <div class="flex items-start gap-3">
                <span class="text-rose-500 flex-shrink-0 mt-0.5 w-5 h-5">${iconSVG.alertTriangle}</span>
                <div>
                  <h3 class="font-semibold text-rose-800">"Implemented" ≠ "Activated"</h3>
                  <p class="text-sm text-rose-700 mt-1">Many customers are technically implemented but still operating at Quadrant G (strong system, low intelligence) until signals, governance cadence, and MCP execution are in place. This gap is the primary driver of churn.</p>
                </div>
              </div>
            </div>
          `;
        } else if (activeSection === 'assessment') {
          contentContainer.innerHTML = `
            <h2 class="text-2xl font-bold">Assessment Framework</h2>
            
            <div class="bg-white rounded-xl border p-5">
              <h3 class="font-semibold mb-4">From Assessment to Journey: A Step-by-Step Process</h3>
              <p class="text-sm text-slate-600 mb-4">Follow these five steps to correctly identify which journey an account belongs to and where they should enter.</p>
              <div class="space-y-3">
                ${[{ step: 1, title: 'Score the Account', desc: 'Rate on all three dimensions: Product System Maturity (1-5), AI & Automation Capability (Low/Med/High), and Interest State (Low/Latent/High)' },
                  { step: 2, title: 'Plot the Quadrant', desc: 'Use scores to identify the account\'s current quadrant (A-H). Context depth (Maturity + AI capability) forms one axis; Interest State forms the other.' },
                  { step: 3, title: 'Check Account State Flags', desc: 'Confirm all five CRM flags: Implemented (Y/N), Trust Status (G/Y/R), Activation Depth, MCP/IPE Interest (Y/N), Strategic Fit (Y/N)' },
                  { step: 4, title: 'Apply the Routing Rule', desc: 'If Strategic Fit = YES and Implemented = NO → Journey 3 (no exceptions). This rule overrides quadrant-based assignment.' },
                  { step: 5, title: 'Confirm Journey & Entry Phase', desc: 'Match the journey to the appropriate entry phase based on current maturity level and activation depth.' }].map(s => `
                  <div class="flex gap-4 p-3 rounded-lg ${s.step % 2 === 1 ? 'bg-slate-50' : ''}">
                    <div class="w-8 h-8 rounded-full bg-emerald-500 text-white flex items-center justify-center font-bold text-sm flex-shrink-0">${s.step}</div>
                    <div>
                      <p class="font-semibold text-sm">${s.title}</p>
                      <p class="text-xs text-slate-600">${s.desc}</p>
                    </div>
                  </div>
                `).join('')}
              </div>
            </div>

            <div class="bg-white rounded-xl border p-5">
              <h3 class="font-semibold mb-4">Required Scoring (No Exceptions)</h3>
              <div class="grid grid-cols-3 gap-4">
                ${[{ name: 'Product System Maturity', scale: '1-5' }, { name: 'AI & Automation Capability', scale: 'Low/Med/High' }, { name: 'Interest State', scale: 'Low/Latent/High' }].map((s, i) => `
                  <div class="bg-slate-50 rounded-lg p-4 text-center">
                    <p class="font-semibold text-sm">${s.name}</p>
                    <p class="text-xs text-slate-500 mt-1">${s.scale}</p>
                  </div>
                `).join('')}
              </div>
            </div>

            <div class="bg-slate-900 text-white rounded-xl p-5">
              <h3 class="font-semibold mb-4">Account State Flags (Required in CRM)</h3>
              <div class="space-y-2">
                ${[{ n: 'Implemented?', v: 'Y/N', d: 'Platform technically deployed' },
                  { n: 'Trust Status', v: 'G/Y/R', d: 'Red = data loss / severe performance / support failure' },
                  { n: 'Activation Depth', v: 'Docs → CP → MCP → AI', d: 'How deeply they use the platform' },
                  { n: 'MCP/IPE Interest', v: 'Y/N', d: 'Expressed interest in AI capabilities' },
                  { n: 'Strategic Fit', v: 'Y/N', d: 'True ICP match' }].map((f, i) => `
                  <div class="flex items-center gap-4 py-2 border-b border-slate-700">
                    <span class="font-medium w-40">${f.n}</span>
                    <span class="text-slate-400 w-32">${f.v}</span>
                    <span class="text-slate-400 text-sm">${f.d}</span>
                  </div>
                `).join('')}
              </div>
            </div>

            <div class="bg-rose-100 border-2 border-rose-300 rounded-xl p-5">
              <h3 class="font-semibold text-rose-800 mb-2">Routing Rule (Non-negotiable)</h3>
              <div class="bg-white rounded-lg p-4">
                <p class="text-rose-700">If <span class="bg-rose-200 px-2 py-0.5 rounded">Strategic Fit = TRUE</span> and <span class="bg-rose-200 px-2 py-0.5 rounded">Implemented = NO</span>, the account is <strong>Journey 3 by default</strong> until activation is complete.</p>
              </div>
              <p class="text-sm text-rose-700 mt-2">This prevents the most common sequencing mistake: selling platform expansion before activation is real.</p>
            </div>

            <div class="bg-white rounded-xl border p-5">
              <div class="flex items-center justify-between mb-4">
                <h3 class="font-semibold">Journey Selection Decision Tree</h3>
                <button id="toggle-decision-tree" class="text-sm text-emerald-600 hover:text-emerald-700 flex items-center gap-1">
                  <span id="decision-tree-text">Show</span> Decision Logic
                  <span class="chevron" id="decision-tree-chevron">${iconSVG.chevronDown}</span>
                </button>
              </div>
              <div id="decision-tree-content" class="hidden bg-slate-50 rounded-lg p-4 text-sm space-y-4">
                <div class="font-semibold text-slate-900">START: Is Strategic Fit = YES?</div>
                
                <div class="ml-4 pl-4 border-l-2 border-emerald-500 space-y-3">
                  <div class="font-semibold text-emerald-700">YES → Is Implemented = NO?</div>
                  <div class="ml-4 pl-4 border-l-2 border-emerald-500">
                    <div class="flex items-center gap-2 mb-1">
                      <span class="font-semibold text-emerald-700">YES →</span>
                      <span class="px-2 py-1 bg-emerald-100 text-emerald-700 rounded font-bold">JOURNEY 3</span>
                      <span class="text-slate-500">(Services Transformation)</span>
                    </div>
                    <p class="text-xs text-slate-600">Account needs activation before any platform expansion. Enter at Phase 1.</p>
                  </div>
                  <div class="ml-4 pl-4 border-l-2 border-blue-500 space-y-2">
                    <div class="font-semibold text-blue-700">NO (Implemented = YES) → Check for Triggers</div>
                    <div class="ml-4 text-slate-600">
                      <p class="mb-2">Is there an active trigger (exec change, reorg, tech consolidation, budget cycle)?</p>
                      <div class="space-y-2 ml-2">
                        <div class="flex items-center gap-2">
                          <span class="font-medium">YES →</span>
                          <span class="px-2 py-1 bg-violet-100 text-violet-700 rounded font-bold">JOURNEY 4</span>
                          <span class="text-slate-500">(Timing Play)</span>
                        </div>
                        <div>
                          <p class="mb-1"><span class="font-medium">NO →</span> Is Maturity Level 4+ with high MCP interest and sudden need?</p>
                          <div class="ml-4 space-y-1">
                            <div class="flex items-center gap-2">
                              <span class="font-medium">YES →</span>
                              <span class="px-2 py-1 bg-blue-100 text-blue-700 rounded font-bold">JOURNEY 2</span>
                              <span class="text-slate-500">(Independent Maturation)</span>
                            </div>
                            <div class="flex items-center gap-2">
                              <span class="font-medium">NO →</span>
                              <span class="text-slate-500">Monitor, maintain relationship, watch for triggers</span>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="ml-4 pl-4 border-l-2 border-slate-400">
                  <div class="flex items-center gap-2 mb-1">
                    <span class="font-semibold text-slate-600">NO (Strategic Fit = NO) →</span>
                    <span class="px-2 py-1 bg-slate-200 text-slate-700 rounded font-bold">JOURNEY 1</span>
                    <span class="text-slate-500">(Progressive Maturation)</span>
                  </div>
                  <p class="text-xs text-slate-600">Maintain relationship without platform pressure. Do not overinvest.</p>
                </div>
              </div>
            </div>

            <div class="bg-white rounded-xl border p-5">
              <h3 class="font-semibold mb-2">Quadrant-to-Journey Mapping</h3>
              <p class="text-sm text-slate-600 mb-4">Starting quadrant suggests likely journey, but the routing rule and account flags determine final assignment.</p>
              <div class="overflow-x-auto">
                <table class="w-full text-sm">
                  <thead>
                    <tr class="bg-slate-900 text-white">
                      <th class="px-3 py-2 text-left rounded-tl-lg">Quadrant</th>
                      <th class="px-3 py-2 text-left">Profile</th>
                      <th class="px-3 py-2 text-left">Likely Journey</th>
                      <th class="px-3 py-2 text-left rounded-tr-lg">Rationale</th>
                    </tr>
                  </thead>
                  <tbody>
                    ${[{ q: 'A', p: 'Low context, Low AI interest', j: 'J1', r: 'Long nurture cycle; not ready for platform investment', active: false },
                      { q: 'B', p: 'Low context, High AI interest', j: 'J1 → J3', r: 'Educate on structure first; may accelerate to J3 if ICP', active: false },
                      { q: 'C', p: 'High context, Low interest', j: 'J1 or Exit', r: 'Monitor only; exit if no path to activation', active: false },
                      { q: 'D', p: 'High context, Latent interest', j: 'J2 or J4', r: 'Trigger-dependent; ready for fast activation when timing aligns', active: false },
                      { q: 'E', p: 'Interest without structure', j: 'J3 (if ICP)', r: 'Heavy services needed; documentation + implementation focus', active: true },
                      { q: 'F', p: 'AI ambition without context', j: 'J3 (if ICP)', r: 'Light services + docs; build foundation before AI enablement', active: true },
                      { q: 'G', p: 'Strong system, Low intelligence', j: 'J3 (if ICP)', r: 'IPE enablement path; control plane → signals → MCP', active: true },
                      { q: 'H', p: 'IPE-ready', j: 'J2 or J4', r: 'Fast activation; expansion-ready', active: false }].map((row, i) => `
                      <tr class="${row.active ? 'bg-emerald-50' : i % 2 === 0 ? 'bg-slate-50' : ''}">
                        <td class="px-3 py-2">
                          <span class="px-2 py-0.5 rounded text-xs font-bold ${row.active ? 'bg-emerald-200 text-emerald-700' : 'bg-slate-200 text-slate-600'}">${row.q}</span>
                        </td>
                        <td class="px-3 py-2">${row.p}</td>
                        <td class="px-3 py-2 font-semibold">${row.j}</td>
                        <td class="px-3 py-2 text-slate-600 text-xs">${row.r}</td>
                      </tr>
                    `).join('')}
                  </tbody>
                </table>
              </div>
              <div class="mt-4 p-3 bg-rose-50 border border-rose-200 rounded-lg">
                <p class="text-sm text-rose-700"><strong>Remember:</strong> The routing rule overrides quadrant logic. If Strategic Fit = YES and Implemented = NO, the account is Journey 3 regardless of quadrant.</p>
              </div>
            </div>

            <div class="bg-white rounded-xl border p-5">
              <h3 class="font-semibold mb-4">Readiness Quadrants (Click to explore)</h3>
              <div class="grid grid-cols-4 gap-2" id="quadrant-grid">
                ${quadrantsData.map(q => `
                  <button data-quadrant-id="${q.id}" class="quadrant-btn p-3 rounded-lg border-2 transition-all text-left ${selectedQuadrant === q.id ? 'border-slate-900 shadow-lg' : 'border-slate-200 hover:border-slate-400'} ${q.active ? getColorClass(q.color, 'light') : 'bg-slate-50'}">
                    <div class="flex items-center justify-between mb-1">
                      <span class="px-2 py-0.5 rounded text-xs font-bold ${q.active ? getColorClass(q.color, 'bg') + ' ' + getColorClass(q.color, 'text') : 'bg-slate-200 text-slate-600'}">${q.id}</span>
                      <span class="text-xs text-slate-500">${q.journey}</span>
                    </div>
                    <p class="text-xs text-slate-600">${q.profile}</p>
                  </button>
                `).join('')}
              </div>
              <div id="selected-quadrant-info" class="mt-4 p-4 bg-slate-50 rounded-lg ${selectedQuadrant ? '' : 'hidden'}">
                ${selectedQuadrant ? `
                  <p class="text-sm"><strong>Quadrant ${selectedQuadrant}:</strong> ${quadrantsData.find(q => q.id === selectedQuadrant)?.profile || ''}</p>
                  <p class="text-sm text-slate-600 mt-1">Likely Journey: <strong>${quadrantsData.find(q => q.id === selectedQuadrant)?.journey || ''}</strong></p>
                ` : ''}
              </div>
            </div>

            <div class="bg-white rounded-xl border p-5">
              <h3 class="font-semibold mb-2">Worked Examples</h3>
              <p class="text-sm text-slate-600 mb-4">Three examples showing how assessment inputs determine journey assignment.</p>
              <div class="space-y-4" id="examples-container">
                ${examplesData.map(ex => {
                  const isExpanded = selectedExample === ex.name;
                  return `
                    <div class="example-card rounded-xl border-2 overflow-hidden transition-all ${isExpanded ? 'shadow-lg' : ''} ${getColorClass(ex.color, 'border')}">
                      <button data-example-name="${ex.name}" class="example-toggle-btn w-full p-4 text-left flex items-center justify-between ${getColorClass(ex.color, 'light')}">
                        <div class="flex items-center gap-3">
                          <span class="w-5 h-5 text-slate-600">${iconSVG.building}</span>
                          <span class="font-semibold">${ex.name}</span>
                          <span class="px-2 py-0.5 rounded text-xs font-bold ${getColorClass(ex.color, 'bg')} ${getColorClass(ex.color, 'text')}">→ ${ex.result}</span>
                        </div>
                        <span class="chevron ${isExpanded ? 'rotated' : ''} w-4 h-4">${iconSVG.chevronDown}</span>
                      </button>
                      <div class="example-content p-4 bg-white border-t ${isExpanded ? '' : 'hidden'}">
                        <div class="grid grid-cols-2 gap-6">
                          <div>
                            <p class="text-xs text-slate-500 uppercase tracking-wide mb-2">Assessment Scores</p>
                            <div class="space-y-1 text-sm">
                              <p>Product System Maturity: <strong>Level ${ex.maturity}</strong></p>
                              <p>AI & Automation Capability: <strong>${ex.ai}</strong></p>
                              <p>Interest State: <strong>${ex.interest}</strong></p>
                            </div>
                          </div>
                          <div>
                            <p class="text-xs text-slate-500 uppercase tracking-wide mb-2">Account State Flags</p>
                            <div class="space-y-1 text-sm">
                              <p>Implemented: <strong class="${ex.implemented ? 'text-emerald-600' : 'text-rose-600'}">${ex.implemented ? 'YES' : 'NO'}</strong></p>
                              <p>Trust Status: <strong class="${ex.trust === 'Green' ? 'text-emerald-600' : 'text-amber-600'}">${ex.trust}</strong></p>
                              <p>Strategic Fit: <strong class="text-emerald-600">YES</strong></p>
                            </div>
                          </div>
                        </div>
                        <div class="mt-4 pt-4 border-t space-y-2">
                          <p class="text-sm"><strong>Quadrant:</strong> ${ex.quadrant} (${quadrantsData.find(q => q.id === ex.quadrant)?.profile || ''})</p>
                          <p class="text-sm"><strong>Routing Rule Check:</strong> Strategic Fit = YES ${ex.implemented ? 'but Implemented = YES, so rule does not apply' : '+ Implemented = NO'}</p>
                          ${ex.implemented ? `<p class="text-sm"><strong>Trigger Check:</strong> ${ex.name === 'Adobe' ? 'Enterprise rollout pattern identified (active trigger)' : 'Org consolidation trigger identified'}</p>` : ''}
                          <div class="mt-3 p-3 rounded-lg ${getColorClass(ex.color, 'light')}">
                            <p class="text-sm font-semibold ${getColorClass(ex.color, 'text')}">
                              Result: ${ex.result} — ${ex.result === 'J3' ? 'Enter at Phase 1 (Stabilize & Complete). Focus on trust repair and basic activation before any platform expansion discussion.' : ex.result === 'J2' ? 'Mature org with sudden trigger requiring fast activation. Treat as reference implementation. Platform expansion is appropriate.' : 'Timing play. Do not drag into long services. Prepare executive activation package and move quickly when trigger fires.'}
                            </p>
                          </div>
                        </div>
                      </div>
                    </div>
                  `;
                }).join('')}
              </div>
            </div>
          `;

          // Add event listeners for decision tree toggle
          setTimeout(() => {
            const toggleBtn = document.getElementById('toggle-decision-tree');
            const treeContent = document.getElementById('decision-tree-content');
            const treeText = document.getElementById('decision-tree-text');
            const treeChevron = document.getElementById('decision-tree-chevron');
            
            if (toggleBtn && treeContent) {
              toggleBtn.addEventListener('click', () => {
                showDecisionTree = !showDecisionTree;
                treeContent.classList.toggle('hidden', !showDecisionTree);
                if (treeText) treeText.textContent = showDecisionTree ? 'Hide' : 'Show';
                if (treeChevron) treeChevron.classList.toggle('rotated', showDecisionTree);
              });
            }

            // Quadrant buttons
            document.querySelectorAll('.quadrant-btn').forEach(btn => {
              btn.addEventListener('click', () => {
                const qId = btn.dataset.quadrantId;
                selectedQuadrant = selectedQuadrant === qId ? null : qId;
                renderContent();
              });
            });

            // Example toggles
            document.querySelectorAll('.example-toggle-btn').forEach(btn => {
              btn.addEventListener('click', () => {
                const exName = btn.dataset.exampleName;
                selectedExample = selectedExample === exName ? null : exName;
                renderContent();
              });
            });
          }, 100);

        } else if (activeSection === 'journeys') {
          contentContainer.innerHTML = `
            <h2 class="text-2xl font-bold">Customer Journeys</h2>
            
            <div class="bg-emerald-50 border border-emerald-200 rounded-xl p-4">
              <div class="flex items-center gap-3">
                <span class="text-emerald-600 w-5 h-5">${iconSVG.star}</span>
                <div>
                  <p class="font-semibold text-emerald-800">Journey 3 holds the majority of ARR and the majority of meaningful churn risk</p>
                  <p class="text-sm text-emerald-700">Services capacity is the growth bottleneck (not top-of-funnel)</p>
                </div>
              </div>
            </div>

            <div class="space-y-4" id="journeys-container">
              ${journeysData.map(j => {
                const isExpanded = selectedJourney === j.id;
                return `
                  <div data-journey-id="${j.id}" class="journey-card bg-white rounded-xl border-2 p-5 cursor-pointer transition-all ${j.primary ? 'border-emerald-500' : 'border-slate-200'} ${isExpanded ? 'shadow-lg ring-2 ring-offset-2 ring-slate-300' : 'hover:shadow-md'}">
                    <div class="flex items-start gap-4">
                      <div class="w-12 h-12 rounded-lg flex items-center justify-center font-bold text-lg ${getColorClass(j.color, 'bg')} ${getColorClass(j.color, 'text')} ${j.primary ? 'ring-2 ring-emerald-500' : ''}">
                        ${j.id.toUpperCase()}
                      </div>
                      <div class="flex-1">
                        <div class="flex items-center gap-2 flex-wrap">
                          <h3 class="font-semibold">${j.name}</h3>
                          ${j.primary ? '<span class="px-2 py-0.5 bg-emerald-500 text-white text-xs rounded">PRIMARY FOCUS</span>' : ''}
                          <span class="px-2 py-0.5 bg-slate-100 text-slate-600 text-xs font-mono rounded">${j.path}</span>
                          <span class="px-2 py-0.5 text-xs rounded ${j.risk === 'high' ? 'bg-rose-100 text-rose-700' : j.risk === 'medium' ? 'bg-amber-100 text-amber-700' : 'bg-slate-100 text-slate-600'}">${j.arr} ARR • ${j.risk} risk</span>
                        </div>
                        <p class="text-sm text-slate-600 mt-1">${j.desc}</p>
                        ${isExpanded ? `
                          <div class="mt-4 pt-4 border-t space-y-3">
                            <div>
                              <p class="text-xs text-slate-500 uppercase tracking-wide mb-1">Accounts</p>
                              <div class="flex flex-wrap gap-1">
                                ${j.accounts.map(a => `<span class="px-2 py-0.5 bg-slate-100 rounded text-xs">${a}</span>`).join('')}
                              </div>
                            </div>
                            <div class="p-3 rounded-lg ${j.expansion ? 'bg-emerald-50 border border-emerald-200' : 'bg-rose-50 border border-rose-200'}">
                              <p class="text-sm font-medium ${j.expansion ? 'text-emerald-700' : 'text-rose-700'} flex items-center gap-1">
                                <span class="w-4 h-4">${j.expansion ? iconSVG.checkCircle : iconSVG.xCircle}</span>
                                ${j.expansion ? 'Expansion allowed' : 'Expansion blocked'}
                              </p>
                              <p class="text-xs ${j.expansion ? 'text-emerald-600' : 'text-rose-600'}">
                                ${j.expansion ? 'Platform sale allowed when triggers appear' : 'No platform expansion until activation complete'}
                              </p>
                            </div>
                          </div>
                        ` : ''}
                      </div>
                      <span class="chevron ${isExpanded ? 'rotated' : ''} w-5 h-5">${iconSVG.chevronDown}</span>
                    </div>
                  </div>
                `;
              }).join('')}
            </div>
          `;

          setTimeout(() => {
            document.querySelectorAll('.journey-card').forEach(card => {
              card.addEventListener('click', () => {
                const jId = card.dataset.journeyId;
                selectedJourney = selectedJourney === jId ? null : jId;
                renderContent();
              });
            });
          }, 100);

        } else if (activeSection === 'phases') {
          contentContainer.innerHTML = `
            <h2 class="text-2xl font-bold">Engagement Phases (Journey 3 Model)</h2>
            <p class="text-slate-600">PNC Partnership Example — illustrating how the IPE maturity model adapts to specific customer contexts.</p>

            <div class="space-y-4" id="phases-container">
              ${phasesData.map(p => {
                const isExpanded = selectedPhase === p.num;
                const mcpIcon = p.mcp === 'locked' ? iconSVG.lock : p.mcp === 'prep' ? iconSVG.clock : iconSVG.unlock;
                return `
                  <div data-phase-num="${p.num}" class="phase-card bg-white rounded-xl border p-5 cursor-pointer transition-all ${isExpanded ? 'shadow-lg ring-2 ring-offset-2 ring-slate-300' : 'hover:shadow-md'}">
                    <div class="flex items-center gap-4">
                      <div class="w-10 h-10 rounded-lg flex items-center justify-center font-bold ${p.mcp === 'locked' ? 'bg-slate-200 text-slate-600' : p.mcp === 'prep' ? 'bg-amber-200 text-amber-700' : 'bg-emerald-200 text-emerald-700'}">
                        ${p.num}
                      </div>
                      <div class="flex-1">
                        <div class="flex items-center gap-2">
                          <h3 class="font-semibold">${p.name}</h3>
                          <span class="w-4 h-4">${mcpIcon}</span>
                          <span class="text-sm text-slate-500">${p.level}</span>
                          <span class="px-2 py-0.5 text-xs rounded flex items-center gap-1 ${p.mcp === 'locked' ? 'bg-rose-100 text-rose-700' : p.mcp === 'prep' ? 'bg-amber-100 text-amber-700' : 'bg-emerald-100 text-emerald-700'}">
                            ${p.mcp === 'locked' ? 'MCP locked' : p.mcp === 'prep' ? 'MCP prep' : 'MCP ready'}
                          </span>
                        </div>
                        <p class="text-sm text-slate-600 mt-1">${p.goal}</p>
                      </div>
                      <span class="chevron ${isExpanded ? 'rotated' : ''} w-5 h-5">${iconSVG.chevronDown}</span>
                    </div>
                    ${isExpanded ? `
                      <div class="mt-4 pt-4 border-t grid grid-cols-2 gap-4">
                        <div>
                          <p class="text-xs text-slate-500 uppercase tracking-wide mb-2">Workstreams</p>
                          <div class="space-y-1">
                            ${p.workstreams.map(w => `
                              <div class="flex items-center gap-2 text-sm">
                                <div class="w-1.5 h-1.5 rounded-full bg-slate-400"></div>
                                ${w}
                              </div>
                            `).join('')}
                          </div>
                        </div>
                        <div>
                          <p class="text-xs text-slate-500 uppercase tracking-wide mb-2">Exit Criteria</p>
                          <div class="space-y-1">
                            ${p.exitCriteria.map(c => `
                              <div class="flex items-center gap-2 text-sm">
                                <span class="text-emerald-500 w-4 h-4">${iconSVG.checkCircle}</span>
                                ${c}
                              </div>
                            `).join('')}
                          </div>
                        </div>
                      </div>
                    ` : ''}
                  </div>
                `;
              }).join('')}
            </div>
          `;

          setTimeout(() => {
            document.querySelectorAll('.phase-card').forEach(card => {
              card.addEventListener('click', () => {
                const pNum = parseInt(card.dataset.phaseNum);
                selectedPhase = selectedPhase === pNum ? null : pNum;
                renderContent();
              });
            });
          }, 100);

        } else if (activeSection === 'guidance') {
          contentContainer.innerHTML = `
            <h2 class="text-2xl font-bold">Operating Guidance</h2>
            
            <div class="bg-white rounded-xl border p-5">
              <h3 class="font-semibold mb-4">Where to Place Bets</h3>
              <div class="space-y-2">
                ${[{ j: 'J3', desc: "Portfolio's growth and retention engine", primary: true },
                  { j: 'J4', desc: 'Fastest expansion engine when triggers appear' },
                  { j: 'J1', desc: 'Must be protected from premature platform selling' },
                  { j: 'J2', desc: 'Rare but high-impact; treat as lighthouse wins' }].map(b => `
                  <div class="flex items-center gap-3 p-3 rounded-lg ${b.primary ? 'bg-emerald-50' : 'bg-slate-50'}">
                    <span class="font-bold ${b.primary ? 'text-emerald-700' : 'text-slate-700'}">${b.j}</span>
                    <span class="text-sm ${b.primary ? 'text-emerald-700 font-medium' : 'text-slate-600'}">${b.desc}</span>
                  </div>
                `).join('')}
              </div>
            </div>

            <div class="grid grid-cols-2 gap-4">
              <div class="bg-rose-50 border border-rose-200 rounded-xl p-5">
                <h3 class="font-semibold text-rose-800 mb-3 flex items-center gap-2">
                  <span class="w-5 h-5">${iconSVG.xCircle}</span>
                  What to STOP Doing
                </h3>
                <div class="space-y-2">
                  ${['Treating MCP Support as a substitute for activation', 'Treating "implemented" as "successful"', 'Running long implementations without ownership', 'Over-serving non-ICP accounts'].map((item, i) => `
                    <div class="flex items-start gap-2 text-sm text-rose-700">
                      <span class="w-4 h-4 mt-0.5">${iconSVG.xCircle}</span>
                      ${item}
                    </div>
                  `).join('')}
                </div>
              </div>
              <div class="bg-emerald-50 border border-emerald-200 rounded-xl p-5">
                <h3 class="font-semibold text-emerald-800 mb-3 flex items-center gap-2">
                  <span class="w-5 h-5">${iconSVG.checkCircle}</span>
                  What to START Doing
                </h3>
                <div class="space-y-2">
                  ${['Gate all work by maturity phase', 'Require Account State Flags in CRM', 'Apply the routing rule without exception', 'Invest services capacity in Journey 3', 'Treat J4 triggers as expansion opps'].map((item, i) => `
                    <div class="flex items-start gap-2 text-sm text-emerald-700">
                      <span class="w-4 h-4 mt-0.5">${iconSVG.checkCircle}</span>
                      ${item}
                    </div>
                  `).join('')}
                </div>
              </div>
            </div>
          `;
        } else if (activeSection === 'metrics') {
          contentContainer.innerHTML = `
            <h2 class="text-2xl font-bold">Metrics That Matter</h2>
            
            <div class="grid grid-cols-3 gap-4">
              ${[{ title: 'Activation Metrics', color: 'blue', items: ['Implemented rate by ICP segment', 'Trust status distribution (G/Y/R)', 'Activation depth distribution', 'Time-to-first-production value'] },
                { title: 'Product Intelligence', color: 'violet', items: ['% decisions via MCP workflows', 'Time: intent → governed execution', 'AI output acceptance rate', 'Signal reuse across teams'] },
                { title: 'Business Metrics', color: 'emerald', items: ['ARR concentration by journey', 'ARR at risk by journey', 'J3 conversion velocity', 'Services → platform conversion'] }].map(cat => `
                <div class="bg-white rounded-xl border p-5">
                  <h3 class="font-semibold mb-3 ${getColorClass(cat.color, 'text')}">${cat.title}</h3>
                  <div class="space-y-2">
                    ${cat.items.map((item, i) => `
                      <div class="flex items-center gap-2 text-sm">
                        <div class="w-2 h-2 rounded-full ${getColorClass(cat.color, 'accent')}"></div>
                        ${item}
                      </div>
                    `).join('')}
                  </div>
                </div>
              `).join('')}
            </div>

            <div class="bg-gradient-to-r from-slate-900 to-slate-800 text-white rounded-xl p-6">
              <h3 class="text-lg font-bold mb-3">Final Word</h3>
              <p class="text-slate-300 mb-2">Knapsack's opportunity is not to be the best design system platform. It is to become the <span class="text-white font-semibold">governed engine enterprises trust to execute product change in the AI era</span>.</p>
              <p class="text-slate-400">The biggest wins are not "more pipeline." They are <span class="text-emerald-400">better sequencing</span>, <span class="text-emerald-400">stronger activation</span>, and <span class="text-emerald-400">durable trust</span> — especially in Journey 3.</p>
            </div>
          `;
        }
      };

      renderSidebar();
      renderContent();
    });
  </script>
</body>
</html>
