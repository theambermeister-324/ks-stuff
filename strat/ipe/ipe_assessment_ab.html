<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product System Maturity & AI Readiness Assessment</title>
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #1a1a2e;
      color: #fff;
      min-height: 100vh;
    }
    .container {
      max-width: 1000px;
      margin: 0 auto;
      padding: 20px;
    }
    .card {
      background: linear-gradient(145deg, #16213e 0%, #1a1a2e 100%);
      border-radius: 16px;
      padding: 32px 48px;
      margin-bottom: 24px;
      border: 1px solid rgba(100, 54, 191, 0.3);
      box-shadow: 0 20px 60px rgba(0,0,0,0.4);
    }
    .progress-bar { transition: width 0.3s ease; }
    .option-card { 
      transition: all 0.2s; 
      background: rgba(255,255,255,0.03);
      border: 1px solid rgba(100, 54, 191, 0.3);
      color: rgba(255,255,255,0.8);
    }
    .option-card:hover { 
      transform: translateY(-2px); 
      box-shadow: 0 4px 12px rgba(100, 54, 191, 0.3);
      border-color: rgba(100, 54, 191, 0.5);
    }
    .option-card.selected { 
      border-color: #6436bf; 
      background: rgba(100, 54, 191, 0.15);
    }
    .fade-in { animation: fadeIn 0.3s ease-in; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    h1 {
      font-size: 2.4rem;
      font-weight: 700;
      line-height: 1.2;
      margin-bottom: 16px;
      background: linear-gradient(135deg, #fff 0%, #e0d4f7 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    h2 {
      font-size: 1.8rem;
      font-weight: 700;
      margin-bottom: 24px;
      color: #fff;
    }
    h3 {
      font-size: 1.1rem;
      font-weight: 600;
      color: #a78bfa;
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .logo-badge {
      display: inline-block;
      background: linear-gradient(135deg, #6436bf 0%, #42247f 100%);
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 1px;
      margin-bottom: 24px;
    }
    .btn-primary {
      background: linear-gradient(135deg, #6436bf 0%, #42247f 100%);
      color: white;
      padding: 12px 32px;
      border-radius: 8px;
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(100, 54, 191, 0.4);
    }
    .content-box {
      background: rgba(255,255,255,0.03);
      border-radius: 12px;
      padding: 24px;
      border: 1px solid rgba(255,255,255,0.08);
    }
    .text-muted { color: rgba(255,255,255,0.6); }
    .text-light { color: rgba(255,255,255,0.8); }
    .form-row { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; }
    .form-label { font-size: 0.75rem; font-weight: 600; color: rgba(255,255,255,0.8); text-transform: uppercase; letter-spacing: 1px; }
    .form-input {
      margin-top: 8px;
      width: 100%;
      padding: 12px 14px;
      border-radius: 8px;
      border: 1px solid rgba(100, 54, 191, 0.4);
      background: rgba(255,255,255,0.03);
      color: #fff;
      font-size: 0.9rem;
    }
    .form-input:focus { outline: 2px solid rgba(100, 54, 191, 0.6); border-color: rgba(100, 54, 191, 0.8); }
    .form-helper { font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-top: 8px; }
    .question-helper {
      font-size: 0.8rem;
      color: rgba(255,255,255,0.6);
      margin-bottom: 12px;
    }
    .question-instruction {
      font-size: 0.75rem;
      color: rgba(255,255,255,0.5);
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
  </style>
</head>
<body>
  <!-- Main Content -->
  <main id="app" class="container">
    <!-- Intro Section (shown before assessment starts) -->
    <div id="intro-container">
      <!-- Hero Section -->
      <div class="card" style="text-align: center;">
        <div class="logo-badge">KNAPSACK ASSESSMENT</div>
        <h1>Assess Your Product System Maturity & AI Readiness</h1>
        <p class="subtitle" style="max-width: 640px; margin: 0 auto 16px;">Get a benchmarked readiness score, a recommended path, and clear next steps to move from AI experimentation to governed execution.</p>
        <div style="max-width: 680px; margin: 0 auto 14px; padding: 10px 14px; background: rgba(255,255,255,0.04); border: 1px solid rgba(100, 54, 191, 0.35); border-radius: 10px;">
          <p style="font-size: 0.9rem; color: rgba(255,255,255,0.85); margin-bottom: 6px;">
            This assessment evaluates your <span style="font-weight: 600; color: #fff;">Product System</span> foundation, AI readiness, and organizational capacity to help you identify the right path forward.
          </p>
          <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">
            The only assessment that evaluates AI readiness alongside product system maturity—because governance without AI execution is incomplete.
          </p>
        </div>
        <div style="display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; margin: 0 auto 16px;">
          <span style="padding: 6px 10px; background: rgba(255,255,255,0.08); color: rgba(255,255,255,0.8); border-radius: 999px; font-size: 0.75rem; font-weight: 600;">Benchmark</span>
          <span style="padding: 6px 10px; background: rgba(255,255,255,0.08); color: rgba(255,255,255,0.8); border-radius: 999px; font-size: 0.75rem; font-weight: 600;">Path</span>
          <span style="padding: 6px 10px; background: rgba(255,255,255,0.08); color: rgba(255,255,255,0.8); border-radius: 999px; font-size: 0.75rem; font-weight: 600;">Action Plan</span>
        </div>
        <button onclick="startAssessment()" class="btn-primary" style="display: inline-flex; align-items: center; gap: 8px; font-size: 1rem; padding: 16px 32px;">
          <span>Get My Readiness Score</span>
          <i data-lucide="arrow-right" style="width: 20px; height: 20px;"></i>
        </button>
        <p style="font-size: 0.85rem; color: rgba(255,255,255,0.55); margin-top: 18px;">Takes 5 minutes • Compare to 50+ enterprise organizations</p>
      </div>

      <div class="card" style="padding: 16px 20px;">
        <div style="display: flex; flex-direction: column; gap: 12px;">
          <details style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.08); border-radius: 12px; padding: 12px 14px;">
            <summary style="cursor: pointer; font-weight: 600; color: #fff; display: flex; align-items: center; gap: 8px;">
              <i data-lucide="sparkles" style="width: 18px; height: 18px; color: #a78bfa;"></i>
              Why this assessment is different
            </summary>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-top: 12px;">
              <div class="content-box">
                <p style="font-size: 0.8rem; font-weight: 600; color: #fff; margin-bottom: 6px;">Governance + AI readiness</p>
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">We evaluate activation and AI execution, not just tool adoption.</p>
              </div>
              <div class="content-box">
                <p style="font-size: 0.8rem; font-weight: 600; color: #fff; margin-bottom: 6px;">Actionable path</p>
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">You get a personalized path with timelines and success criteria.</p>
              </div>
            </div>
          </details>

          <details style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.08); border-radius: 12px; padding: 12px 14px;">
            <summary style="cursor: pointer; font-weight: 600; color: #fff; display: flex; align-items: center; gap: 8px;">
              <i data-lucide="users" style="width: 18px; height: 18px; color: #3b82f6;"></i>
              Benchmarking context
            </summary>
            <div style="margin-top: 12px;">
              <p style="font-size: 0.8rem; color: rgba(255,255,255,0.7); margin-bottom: 10px;">Benchmarked against 50+ enterprise product systems (PNC, Edward Jones, The Home Depot, CSX) across Financial Services, Retail, Technology, and Healthcare.</p>
              <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                <span style="padding: 4px 10px; background: rgba(255,255,255,0.1); color: rgba(255,255,255,0.8); border-radius: 8px; font-size: 0.75rem; font-weight: 500;">Financial Services</span>
                <span style="padding: 4px 10px; background: rgba(255,255,255,0.1); color: rgba(255,255,255,0.8); border-radius: 8px; font-size: 0.75rem; font-weight: 500;">Retail</span>
                <span style="padding: 4px 10px; background: rgba(255,255,255,0.1); color: rgba(255,255,255,0.8); border-radius: 8px; font-size: 0.75rem; font-weight: 500;">Technology</span>
                <span style="padding: 4px 10px; background: rgba(255,255,255,0.1); color: rgba(255,255,255,0.8); border-radius: 8px; font-size: 0.75rem; font-weight: 500;">Healthcare</span>
              </div>
            </div>
          </details>

          <details style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.08); border-radius: 12px; padding: 12px 14px;">
            <summary style="cursor: pointer; font-weight: 600; color: #fff; display: flex; align-items: center; gap: 8px;">
              <i data-lucide="book-open" style="width: 18px; height: 18px; color: #a78bfa;"></i>
              Key terms
            </summary>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-top: 12px;">
              <div class="content-box">
                <p style="font-size: 0.8rem; font-weight: 600; color: #fff; margin-bottom: 6px;">Product System</p>
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">Shared design + engineering assets that ensure consistency and speed.</p>
              </div>
              <div class="content-box">
                <p style="font-size: 0.8rem; font-weight: 600; color: #fff; margin-bottom: 6px;">API Maturity</p>
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">How well APIs are documented, versioned, and reusable.</p>
              </div>
              <div class="content-box">
                <p style="font-size: 0.8rem; font-weight: 600; color: #fff; margin-bottom: 6px;">Product Data & Metadata</p>
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">Structured UI data that powers tools and AI.</p>
              </div>
              <div class="content-box">
                <p style="font-size: 0.8rem; font-weight: 600; color: #fff; margin-bottom: 6px;">AI Readiness</p>
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">Ability to adopt AI with governance that reduces rework.</p>
              </div>
            </div>
          </details>
        </div>
      </div>
    </div>

    <!-- Assessment Form -->
    <div id="assessment-container" style="display: none;">
      <!-- Progress Indicator -->
      <div class="card" style="padding: 24px;">
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
          <span style="font-size: 0.875rem; font-weight: 500; color: rgba(255,255,255,0.6);">Assessment Progress</span>
          <span style="font-size: 0.875rem; color: rgba(255,255,255,0.5);" id="progress-text">0%</span>
        </div>
        <div style="height: 8px; background: rgba(255,255,255,0.1); border-radius: 9999px; overflow: hidden;">
          <div id="progress-bar" class="progress-bar" style="height: 100%; background: linear-gradient(90deg, #6436bf 0%, #a78bfa 100%); width: 0%;"></div>
        </div>
      </div>

      <!-- Current Question -->
      <div id="question-container"></div>
    </div>

    <!-- Results -->
    <div id="results-container" style="display: none;">
      <!-- Lead Capture -->
      <div id="lead-form-container" class="card" style="background: rgba(255,255,255,0.03);">
        <h3 style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px;">
          <i data-lucide="mail" style="width: 20px; height: 20px; color: #a78bfa;"></i>
          Get Your Results
        </h3>
        <p style="font-size: 0.875rem; color: rgba(255,255,255,0.7); margin-bottom: 16px;">
          Share a few details and we’ll reveal your full readiness score and recommendations.
        </p>
        <form id="lead-form" onsubmit="submitLeadForm(event)">
          <div class="form-row">
            <label class="form-label">
              First Name
              <input class="form-input" name="firstName" type="text" autocomplete="given-name" required>
            </label>
            <label class="form-label">
              Last Name
              <input class="form-input" name="lastName" type="text" autocomplete="family-name" required>
            </label>
          </div>
          <div class="form-row" style="margin-top: 16px;">
            <label class="form-label">
              Work Email
              <input class="form-input" name="workEmail" type="email" autocomplete="email" required>
            </label>
            <label class="form-label">
              Company
              <input class="form-input" name="company" type="text" autocomplete="organization" required>
            </label>
          </div>
          <div class="form-row" style="margin-top: 16px;">
            <label class="form-label">
              Role
              <input class="form-input" name="role" type="text" autocomplete="organization-title">
            </label>
          </div>
          <div class="form-row" style="margin-top: 16px;">
            <label class="form-label">
              Industry
              <select class="form-input" name="industry" required>
                <option value="" disabled selected>Select your industry</option>
                <option value="Financial Services">Financial Services</option>
                <option value="Enterprise Software">Enterprise Software</option>
                <option value="Technology / Media">Technology / Media</option>
                <option value="Healthcare">Healthcare</option>
                <option value="Retail / E-commerce">Retail / E-commerce</option>
                <option value="Telecommunications / Media">Telecommunications / Media</option>
                <option value="Regulated / Industrial">Regulated / Industrial</option>
                <option value="International / Industrial">International / Industrial</option>
                <option value="Travel / Hospitality">Travel / Hospitality</option>
                <option value="Aerospace / Space">Aerospace / Space</option>
                <option value="Education (Nonprofit)">Education (Nonprofit)</option>
                <option value="Utilities (Electric)">Utilities (Electric)</option>
                <option value="Other / Unknown">Other / Unknown</option>
              </select>
            </label>
          </div>
          <label class="form-label" style="margin-top: 16px;">
            Additional Context (optional)
            <textarea class="form-input" name="context" rows="4" placeholder="Share any context that could help interpret your results."></textarea>
          </label>
          <p class="form-helper">We’ll only use this to personalize your assessment results.</p>
          <button type="submit" class="btn-primary" style="margin-top: 16px; width: 100%;">
            Reveal My Results
          </button>
        </form>
      </div>

      <div id="results-content" style="display: none;">
      <!-- Benchmark Comparison -->
      <div id="benchmark-comparison" class="card"></div>

      <!-- Benchmark Visualization -->
      <div id="benchmark-visuals" class="card"></div>

      <!-- Overall Score -->
      <div class="card" style="background: linear-gradient(135deg, #6436bf 0%, #42247f 100%); padding: 32px;">
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px;">
          <div>
            <p style="color: rgba(255,255,255,0.8); font-size: 0.875rem; font-weight: 500; margin-bottom: 4px;">READINESS TIER</p>
            <div style="display: flex; align-items: baseline; gap: 12px; flex-wrap: wrap;">
              <h2 style="font-size: 2.2rem; font-weight: 700; color: #fff; margin: 0;" id="readiness-tier">Foundation</h2>
              <span id="overall-grade" style="font-size: 1rem; font-weight: 700; color: #e0d4f7;">Grade —</span>
              <span style="font-size: 0.875rem; color: rgba(255,255,255,0.7);">Score <span id="overall-score">0</span>/100</span>
            </div>
            <p id="tier-outcome" style="color: rgba(255,255,255,0.85); font-size: 0.875rem; margin-top: 8px;">—</p>
            <p style="color: rgba(255,255,255,0.7); font-size: 0.75rem; margin-top: 6px;">Implemented ≠ activated. Activation is the unlock for measurable outcomes.</p>
            <div style="margin-top: 12px; display: inline-flex; align-items: center; gap: 8px; background: rgba(255,255,255,0.15); border-radius: 999px; padding: 6px 10px;">
              <span style="font-size: 0.7rem; letter-spacing: 1px; text-transform: uppercase; color: rgba(255,255,255,0.7);">MCP Readiness</span>
              <span id="mcp-readiness" style="font-size: 0.75rem; font-weight: 700; color: #fff;">—</span>
            </div>
            <div style="margin-top: 12px; background: rgba(59, 130, 246, 0.2); border-radius: 8px; padding: 10px; border: 1px solid rgba(59, 130, 246, 0.4);">
              <p style="font-size: 0.8rem; color: #bfdbfe;">
                Intelligent Product Engine is the governable control plane that turns AI from advisory to production-safe execution.
              </p>
            </div>
          </div>
          <div style="width: 96px; height: 96px; border-radius: 50%; background: rgba(255,255,255,0.2); display: flex; align-items: center; justify-content: center;">
            <i data-lucide="target" style="width: 48px; height: 48px; color: #fff;"></i>
          </div>
        </div>
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-top: 24px;">
          <div style="background: rgba(255,255,255,0.1); border-radius: 12px; padding: 12px;">
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.8); margin-bottom: 4px;">Product System Foundation</p>
            <p style="font-size: 1.5rem; font-weight: 700; color: #fff;" id="foundation-score">0</p>
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.8);">/ 40</p>
          </div>
          <div style="background: rgba(255,255,255,0.1); border-radius: 12px; padding: 12px;">
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.8); margin-bottom: 4px;">AI & Automation Readiness</p>
            <p style="font-size: 1.5rem; font-weight: 700; color: #fff;" id="ai-score">0</p>
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.8);">/ 30</p>
          </div>
          <div style="background: rgba(255,255,255,0.1); border-radius: 12px; padding: 12px;">
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.8); margin-bottom: 4px;">Organizational Readiness</p>
            <p style="font-size: 1.5rem; font-weight: 700; color: #fff;" id="org-score">0</p>
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.8);">/ 30</p>
          </div>
        </div>
      </div>

      <!-- Narrative Summary -->
      <div id="narrative-summary" class="card"></div>

      <!-- Product Leadership POV -->
      <div id="leadership-pov" class="card" style="background: rgba(255,255,255,0.03);"></div>

      <!-- Intelligent Product Engine Principles -->
      <div class="card" style="background: rgba(59, 130, 246, 0.08); border: 2px solid rgba(59, 130, 246, 0.25);">
        <h3 style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px; color: #fff;">
          <i data-lucide="sparkles" style="width: 20px; height: 20px; color: #60a5fa;"></i>
          Intelligent Product Engine Principles
        </h3>
        <div class="content-box" style="margin-bottom: 12px;">
          <p style="font-size: 0.875rem; color: rgba(255,255,255,0.85);">
            Intelligent Product Engine closes the AI execution gap with a governable control plane that moves teams from intent to safe production.
          </p>
        </div>
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 12px;">
          <div class="content-box">
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6); margin-bottom: 4px;">Intent</p>
            <p style="font-weight: 700; color: #fff;">Business goals</p>
          </div>
          <div class="content-box">
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6); margin-bottom: 4px;">Governed Context</p>
            <p style="font-weight: 700; color: #fff;">Rules + metadata</p>
          </div>
          <div class="content-box">
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6); margin-bottom: 4px;">Safe Execution</p>
            <p style="font-weight: 700; color: #fff;">Production-ready AI</p>
          </div>
        </div>
        <div style="display: flex; flex-direction: column; gap: 8px;">
          <div style="display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: rgba(255,255,255,0.85);">
            <span style="width: 8px; height: 8px; border-radius: 50%; background: #60a5fa;"></span>
            Governance > generation: AI is valuable only when it can act safely.
          </div>
          <div style="display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: rgba(255,255,255,0.85);">
            <span style="width: 8px; height: 8px; border-radius: 50%; background: #60a5fa;"></span>
            Context > prompts: rules and metadata are the durable advantage.
          </div>
          <div style="display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: rgba(255,255,255,0.85);">
            <span style="width: 8px; height: 8px; border-radius: 50%; background: #60a5fa;"></span>
            Activation > implementation: value comes from governed adoption.
          </div>
        </div>
      </div>

      <!-- Investment Path Recommendation -->
      <div class="card">
        <h3 style="display: flex; align-items: center; gap: 8px; margin-bottom: 24px;">
          <i data-lucide="git-branch" style="width: 20px; height: 20px; color: #a78bfa;"></i>
          Recommended Program
        </h3>
        <div id="path-recommendation"></div>
      </div>

      <!-- Deployment Tier -->
      <div class="card">
        <h3 style="display: flex; align-items: center; gap: 8px; margin-bottom: 24px;">
          <i data-lucide="server" style="width: 20px; height: 20px; color: #fbbf24;"></i>
          Deployment Tier Assessment
        </h3>
        <div id="deployment-recommendation"></div>
      </div>

      <!-- Trust & Governance Gate -->
      <div class="card" id="trust-governance"></div>

      <!-- Detailed Breakdown -->
      <div class="card">
        <h3 style="display: flex; align-items: center; gap: 8px; margin-bottom: 24px;">
          <i data-lucide="bar-chart-3" style="width: 20px; height: 20px; color: #3b82f6;"></i>
          Assessment Breakdown
        </h3>
        <div id="breakdown-details"></div>
      </div>

      <!-- ROI Business Case -->
      <div id="roi-business-case" class="card" style="background: rgba(16, 185, 129, 0.12); border: 2px solid rgba(16, 185, 129, 0.3);"></div>

      <!-- AI-Ready Next Step -->
      <div id="ai-ready-next-step" class="card" style="background: rgba(59, 130, 246, 0.12); border: 2px solid rgba(59, 130, 246, 0.35);"></div>

      <!-- Next Steps -->
      <div class="card" style="background: rgba(100, 54, 191, 0.1); border: 2px solid rgba(100, 54, 191, 0.3);">
        <h3 style="display: flex; align-items: center; gap: 8px; margin-bottom: 24px; color: #fff;">
          <i data-lucide="arrow-right" style="width: 20px; height: 20px; color: #a78bfa;"></i>
          Recommended Next Steps
        </h3>
        <div id="next-steps"></div>
      </div>

      <!-- Personalized Insights -->
      <div id="personalized-insights" class="card"></div>

      <!-- Cost of Inaction -->
      <div id="cost-of-inaction" class="card" style="background: rgba(228, 58, 92, 0.1); border: 2px solid rgba(228, 58, 92, 0.3);"></div>

      <!-- Connect with Knapsack CTA -->
      <div class="card" style="background: linear-gradient(135deg, #6436bf 0%, #3b82f6 100%); padding: 32px;">
        <div style="display: flex; flex-direction: column; gap: 24px;">
          <div style="flex: 1;">
            <h3 style="font-size: 1.5rem; font-weight: 700; color: #fff; margin-bottom: 8px;">Ready to take the next step?</h3>
            <p style="color: rgba(255,255,255,0.85); margin-bottom: 16px;">Schedule a personalized consultation with our IPE experts to discuss your assessment results and explore how the Intelligent Product Engine can accelerate your product delivery.</p>
            <div style="display: flex; flex-wrap: wrap; gap: 12px; font-size: 0.875rem;">
              <div style="display: flex; align-items: center; gap: 8px; background: rgba(255,255,255,0.2); border-radius: 8px; padding: 8px 12px;">
                <i data-lucide="calendar" style="width: 16px; height: 16px;"></i>
                <span>30-minute consultation</span>
              </div>
              <div style="display: flex; align-items: center; gap: 8px; background: rgba(255,255,255,0.2); border-radius: 8px; padding: 8px 12px;">
                <i data-lucide="file-text" style="width: 16px; height: 16px;"></i>
                <span>Detailed roadmap</span>
              </div>
              <div style="display: flex; align-items: center; gap: 8px; background: rgba(255,255,255,0.2); border-radius: 8px; padding: 8px 12px;">
                <i data-lucide="users" style="width: 16px; height: 16px;"></i>
                <span>Expert guidance</span>
              </div>
            </div>
          </div>
          <div style="display: flex; flex-direction: column; gap: 12px;">
            <a href="mailto:ipe@knapsack.cloud?subject=Product System Maturity Assessment Results - Consultation Request" style="background: #fff; color: #6436bf; padding: 12px 24px; border-radius: 8px; font-weight: 600; transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px; text-decoration: none; text-align: center;">
              <i data-lucide="mail" style="width: 20px; height: 20px;"></i>
              <span>Schedule Consultation</span>
            </a>
            <button onclick="downloadResults()" style="background: rgba(255,255,255,0.2); color: #fff; padding: 12px 24px; border-radius: 8px; font-weight: 500; border: 1px solid rgba(255,255,255,0.3); cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px;">
              <i data-lucide="download" style="width: 20px; height: 20px;"></i>
              <span>Download Results</span>
            </button>
          </div>
        </div>
      </div>

      <!-- Restart Button -->
      <button onclick="resetAssessment()" style="width: 100%; display: flex; align-items: center; justify-content: center; gap: 8px; padding: 12px 24px; background: rgba(255,255,255,0.1); color: #fff; border-radius: 8px; font-weight: 500; border: 1px solid rgba(100, 54, 191, 0.3); cursor: pointer; transition: all 0.2s; margin-bottom: 24px;">
        <i data-lucide="refresh-cw" style="width: 20px; height: 20px;"></i>
        Start New Assessment
      </button>
      </div>
    </div>
  </main>

  <script>
    // Assessment Questions
    const questions = [
      // Product System Foundation (40 points total)
      {
        category: 'Product System Foundation',
        weight: 40,
        question: 'What is the current state of your design system?',
        options: [
          { text: 'No design system exists', score: 0, value: 'none' },
          { text: 'Informal or scattered components', score: 5, value: 'informal' },
          { text: 'Design system exists but limited adoption', score: 10, value: 'limited' },
          { text: 'Design system deployed, moderate adoption (30-70%)', score: 15, value: 'moderate' },
          { text: 'Mature design system with high adoption (>70%)', score: 20, value: 'mature' }
        ]
      },
      {
        category: 'Product System Foundation',
        weight: 40,
        question: 'How is your design system governed?',
        options: [
          { text: 'No governance structure', score: 0, value: 'none' },
          { text: 'Informal or ad-hoc governance', score: 3, value: 'informal' },
          { text: 'Governance exists but not enforced', score: 6, value: 'exists' },
          { text: 'Active governance with decision authority', score: 10, value: 'active' },
          { text: 'Cross-system governance with clear rules', score: 12, value: 'cross-system' }
        ]
      },
      {
        category: 'Product System Foundation',
        weight: 40,
        question: 'What is the quality of your design system documentation?',
        helper: 'Examples: basic = usage + visual rules; comprehensive = usage + interaction + accessibility + code references.',
        options: [
          { text: 'No documentation', score: 0, value: 'none' },
          { text: 'Minimal or outdated documentation', score: 2, value: 'minimal' },
          { text: 'Basic documentation exists', score: 4, value: 'basic' },
          { text: 'Comprehensive, up-to-date documentation', score: 6, value: 'comprehensive' },
          { text: 'Living documentation integrated with code', score: 8, value: 'living' }
        ]
      },
      
      // AI & Automation Readiness (30 points total)
      {
        category: 'AI & Automation Readiness',
        weight: 30,
        question: 'How are your teams currently using AI coding tools?',
        options: [
          { text: 'No AI tools in use', score: 0, value: 'none' },
          { text: 'Limited experimentation', score: 3, value: 'experimental' },
          { text: 'Some teams using AI tools', score: 6, value: 'some' },
          { text: 'Widespread AI tool adoption', score: 10, value: 'widespread' },
          { text: 'AI tools integrated into workflows', score: 12, value: 'integrated' }
        ]
      },
      {
        category: 'AI & Automation Readiness',
        weight: 30,
        question: 'What is your API maturity and integration architecture?',
        helper: 'Think: documented endpoints, versioning, consistent patterns, reuse across teams.',
        options: [
          { text: 'No APIs or integration architecture', score: 0, value: 'none' },
          { text: 'Basic APIs exist', score: 3, value: 'basic' },
          { text: 'Well-defined APIs with documentation', score: 6, value: 'defined' },
          { text: 'Mature API architecture', score: 9, value: 'mature' },
          { text: 'API-first architecture with MCP compatibility', score: 12, value: 'mcp-ready' }
        ]
      },
      {
        category: 'AI & Automation Readiness',
        weight: 30,
        question: 'What is the quality of your product data and metadata?',
        helper: 'Includes tokens, components, states, accessibility metadata, and how consistently it is structured.',
        options: [
          { text: 'No structured data', score: 0, value: 'none' },
          { text: 'Fragmented or inconsistent data', score: 2, value: 'fragmented' },
          { text: 'Some structured data exists', score: 4, value: 'some' },
          { text: 'Well-structured, consistent data', score: 6, value: 'structured' },
          { text: 'Rich metadata with semantic relationships', score: 8, value: 'rich' }
        ]
      },
      
      // Organizational Readiness (30 points total)
      {
        category: 'Organizational Readiness',
        weight: 30,
        question: 'Is there an executive sponsor for this initiative?',
        options: [
          { text: 'No sponsor identified', score: 0, value: 'none' },
          { text: 'Influencer only (IC or Manager)', score: 3, value: 'influencer' },
          { text: 'Director-level champion', score: 6, value: 'director' },
          { text: 'VP-level executive sponsor', score: 10, value: 'vp' },
          { text: 'C-level executive sponsor', score: 12, value: 'c-level' }
        ]
      },
      {
        category: 'Organizational Readiness',
        weight: 30,
        question: 'What is the status of budget for this investment?',
        options: [
          { text: 'No budget allocated', score: 0, value: 'none' },
          { text: 'Budget would need to be found', score: 3, value: 'find' },
          { text: 'Budget exists, needs approval', score: 6, value: 'approval' },
          { text: 'Budget allocated and approved', score: 10, value: 'allocated' },
          { text: 'Budget allocated with multi-year commitment', score: 12, value: 'multi-year' }
        ]
      },
      {
        category: 'Organizational Readiness',
        weight: 30,
        question: 'What is your team capacity for change management?',
        helper: 'If you are unsure, choose "Not sure yet" and we can help assess.',
        options: [
          { text: 'No capacity for change', score: 0, value: 'none' },
          { text: 'Limited capacity', score: 2, value: 'limited' },
          { text: 'Moderate capacity', score: 4, value: 'moderate' },
          { text: 'Dedicated change management resources', score: 6, value: 'dedicated' },
          { text: 'Strong change management capability', score: 8, value: 'strong' },
          { text: 'Not sure yet', score: 0, value: 'unknown' }
        ]
      },
      
      // Deployment Tier Questions
      {
        category: 'Deployment',
        weight: 0,
        question: 'What are your compliance and infrastructure requirements?',
        helper: 'Select all that apply. We will use the highest requirement to recommend deployment tier.',
        options: [
          { text: 'Standard SaaS acceptable (SOC 2)', score: 0, value: 'D1', tier: 'D1' },
          { text: 'Dedicated environment needed (SOC 2, GDPR)', score: 0, value: 'D2', tier: 'D2' },
          { text: 'Private cloud required (PCI, HIPAA)', score: 0, value: 'D3', tier: 'D3' },
          { text: 'Self-hosted/on-premises (FedRAMP, Defense)', score: 0, value: 'D4', tier: 'D4' },
          { text: 'Unknown - need to validate', score: 0, value: 'unknown', tier: 'D1' }
        ]
      }
    ];

    let currentQuestionIndex = 0;
    let answers = {};
    let deploymentTier = 'D1';
    let recommendedPath = 'J1';
    let pendingResults = null;
    let selectedIndustry = 'Cross-industry';

    const journeyDetails = {
      J1: {
        name: 'Foundation Path',
        shortName: 'Foundation',
        color: 'slate',
        tcv: 'Starts at $50K',
        description: 'For organizations without a system of record. Build before governing.',
        path: 'Diagnostic → Foundation → Governance',
        focus: 'Establish a system of record and baseline governance so AI can safely act later.',
        outcome: 'Moves from fragmented delivery to a governed foundation that can scale.',
        accounts: ['Early-stage design system orgs', 'No engineering ownership yet']
      },
      J2: {
        name: 'Acceleration Path',
        shortName: 'Acceleration',
        color: 'blue',
        tcv: 'Starts at $50K + activation sprint',
        description: 'For mature orgs with sudden trigger. Fast activation, minimal services.',
        path: 'Diagnostic → Rapid Activation',
        focus: 'Compress time-to-value with a focused activation sprint during a trigger window.',
        outcome: 'Unlocks near-term launch goals without trading away governance.',
        accounts: ['Adobe-profile accounts', 'Enterprise rollout triggers']
      },
      J3: {
        name: 'Activation Path',
        shortName: 'Activation',
        color: 'emerald',
        tcv: 'Custom, multi-phase program',
        description: 'For high-value accounts blocked on activation. Full transformation.',
        path: 'Diagnostic → (Phase 0) → Foundation → Activation → Intelligence',
        focus: 'Turn an implemented system into a governed control plane with decision authority.',
        outcome: 'Unlocks the largest gains in delivery speed and consistency.',
        accounts: ['PNC', 'Edward Jones', 'DoubleVerify', 'Qualcomm', 'GSK US']
      },
      J4: {
        name: 'Intelligence Path',
        shortName: 'Intelligence',
        color: 'violet',
        tcv: 'Starts at $165K',
        description: 'For implemented accounts ready for AI enablement. Expansion-focused.',
        path: 'Diagnostic → MCP Activation → Expansion',
        focus: 'Activate MCP so AI operates with governed context and production guardrails.',
        outcome: 'Moves from AI assistance to safe, repeatable AI execution.',
        accounts: ['The Home Depot', 'CSX', 'GSK Global', 'Crown Equipment']
      }
    };

    const deploymentTiers = {
      D1: { name: 'Cloud Standard', premium: '—', time: '2-4 weeks', compliance: 'SOC 2' },
      D2: { name: 'Cloud Dedicated', premium: '+$50-100K', time: '4-8 weeks', compliance: 'SOC 2, GDPR' },
      D3: { name: 'Private Cloud', premium: '+$175-275K', time: '8-16 weeks', compliance: 'SOC 2, HIPAA, PCI-DSS' },
      D4: { name: 'Self-Hosted', premium: '+$350-550K', time: '16-24+ weeks', compliance: 'FedRAMP-ready, Custom' }
    };

    function renderQuestion() {
      if (currentQuestionIndex >= questions.length) {
        calculateResults();
        return;
      }

      const question = questions[currentQuestionIndex];
      const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
      
      document.getElementById('progress-text').textContent = `${Math.round(progress)}%`;
      document.getElementById('progress-bar').style.width = `${progress}%`;

      const categoryColors = {
        'Product System Foundation': 'emerald',
        'AI & Automation Readiness': 'violet',
        'Organizational Readiness': 'blue',
        'Deployment': 'amber'
      };

      const color = categoryColors[question.category] || 'slate';

      const colorMap = {
        'emerald': { bg: 'rgba(16, 185, 129, 0.15)', border: 'rgba(16, 185, 129, 0.3)', text: '#10b981' },
        'violet': { bg: 'rgba(100, 54, 191, 0.15)', border: 'rgba(100, 54, 191, 0.3)', text: '#a78bfa' },
        'blue': { bg: 'rgba(59, 130, 246, 0.15)', border: 'rgba(59, 130, 246, 0.3)', text: '#3b82f6' },
        'amber': { bg: 'rgba(251, 191, 36, 0.15)', border: 'rgba(251, 191, 36, 0.3)', text: '#fbbf24' },
        'slate': { bg: 'rgba(255,255,255,0.05)', border: 'rgba(255,255,255,0.1)', text: '#fff' }
      };
      const colorStyle = colorMap[color] || colorMap.slate;

      const optionsHtml = question.options.map((opt, idx) => {
        const isMultiSelect = question.category === 'Deployment';
        const selectedValues = Array.isArray(answers[currentQuestionIndex]) ? answers[currentQuestionIndex] : [];
        const isSelected = isMultiSelect ? selectedValues.includes(opt.value) : answers[currentQuestionIndex] === opt.value;
        return `
          <button
            onclick="${isMultiSelect ? `toggleMultiOption(${idx})` : `selectOption(${idx})`}"
            class="option-card"
            style="width: 100%; text-align: left; padding: 16px; border-radius: 8px; border: 2px solid ${isSelected ? '#6436bf' : 'rgba(100, 54, 191, 0.3)'}; background: ${isSelected ? 'rgba(100, 54, 191, 0.15)' : 'rgba(255,255,255,0.03)'}; margin-bottom: 12px; cursor: pointer;"
          >
            <div style="display: flex; align-items: center; justify-content: space-between; gap: 12px;">
              <span style="font-size: 0.875rem; font-weight: 500; color: rgba(255,255,255,0.8);">${opt.text}</span>
              ${isSelected ? '<i data-lucide="check-circle" style="width: 20px; height: 20px; color: #6436bf;"></i>' : ''}
            </div>
          </button>
        `;
      }).join('');

      document.getElementById('question-container').innerHTML = `
        <div class="card fade-in">
          <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px;">
            <span style="padding: 4px 12px; background: ${colorStyle.bg}; color: ${colorStyle.text}; border-radius: 8px; font-size: 0.75rem; font-weight: 600;">
              ${question.category}
            </span>
            ${question.weight > 0 ? `<span style="font-size: 0.75rem; color: rgba(255,255,255,0.5);">${question.weight} points max</span>` : ''}
          </div>
          <h2 style="font-size: 1.125rem; font-weight: 600; color: #fff; margin-bottom: 8px;">${question.question}</h2>
          ${question.helper ? `<p class="question-helper">${question.helper}</p>` : ''}
          <div class="question-instruction">${question.category === 'Deployment' ? 'Select all that apply' : 'Select one'}</div>
          <div style="display: flex; flex-direction: column; gap: 12px;">${optionsHtml}</div>
          ${question.category === 'Deployment' ? `
            <button
              onclick="advanceFromMultiSelect()"
              class="btn-primary"
              style="margin-top: 16px; display: inline-flex; align-items: center; gap: 8px;"
            >
              Continue
              <i data-lucide="arrow-right" style="width: 16px; height: 16px;"></i>
            </button>
          ` : ''}
          ${currentQuestionIndex > 0 ? `
            <button
              onclick="goBack()"
              style="margin-top: 16px; font-size: 0.875rem; color: rgba(255,255,255,0.5); display: flex; align-items: center; gap: 4px; background: none; border: none; cursor: pointer;"
            >
              <i data-lucide="arrow-left" style="width: 16px; height: 16px;"></i> Previous question
            </button>
          ` : ''}
        </div>
      `;

      lucide.createIcons();
    }

    function selectOption(index) {
      const question = questions[currentQuestionIndex];
      const option = question.options[index];
      
      answers[currentQuestionIndex] = option.value;
      
      if (option.tier) {
        deploymentTier = option.tier;
      }
      
      currentQuestionIndex++;
      setTimeout(() => renderQuestion(), 300);
    }

    function toggleMultiOption(index) {
      const question = questions[currentQuestionIndex];
      const option = question.options[index];
      const selectedValues = Array.isArray(answers[currentQuestionIndex]) ? [...answers[currentQuestionIndex]] : [];
      const existingIndex = selectedValues.indexOf(option.value);

      if (existingIndex >= 0) {
        selectedValues.splice(existingIndex, 1);
      } else {
        selectedValues.push(option.value);
      }

      answers[currentQuestionIndex] = selectedValues;
      renderQuestion();
    }

    function advanceFromMultiSelect() {
      const question = questions[currentQuestionIndex];
      const selectedValues = Array.isArray(answers[currentQuestionIndex]) ? answers[currentQuestionIndex] : [];
      const tierPriority = { D1: 1, D2: 2, D3: 3, D4: 4 };

      if (selectedValues.length === 0) {
        answers[currentQuestionIndex] = ['unknown'];
        deploymentTier = 'D1';
      } else {
        const selectedOptions = question.options.filter(opt => selectedValues.includes(opt.value));
        const highestTier = selectedOptions.reduce((highest, opt) => {
          if (!opt.tier) return highest;
          if (!highest) return opt.tier;
          return tierPriority[opt.tier] > tierPriority[highest] ? opt.tier : highest;
        }, null);
        deploymentTier = highestTier || 'D1';
      }

      currentQuestionIndex++;
      setTimeout(() => renderQuestion(), 300);
    }

    function goBack() {
      if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
        delete answers[currentQuestionIndex];
        renderQuestion();
      }
    }

    function calculateResults() {
      let foundationScore = 0;
      let aiScore = 0;
      let orgScore = 0;

      questions.forEach((q, idx) => {
        if (q.category === 'Deployment') return;
        
        const answerValue = answers[idx];
        const selectedOption = q.options.find(opt => opt.value === answerValue);
        
        if (selectedOption) {
          if (q.category === 'Product System Foundation') {
            foundationScore += selectedOption.score;
          } else if (q.category === 'AI & Automation Readiness') {
            aiScore += selectedOption.score;
          } else if (q.category === 'Organizational Readiness') {
            orgScore += selectedOption.score;
          }
        }
      });

      const totalScore = foundationScore + aiScore + orgScore;

      // Determine Investment Path
      recommendedPath = 'J1';
      
      if (totalScore >= 70 && foundationScore >= 25 && orgScore >= 20) {
        recommendedPath = 'J4';
      } else if (totalScore >= 40 && foundationScore >= 15 && orgScore >= 15) {
        recommendedPath = 'J3';
      } else if (totalScore >= 50 && orgScore >= 20) {
        recommendedPath = 'J2';
      } else {
        recommendedPath = 'J1';
      }

      // Display lead form before results
      pendingResults = { foundationScore, aiScore, orgScore, totalScore };
      document.getElementById('assessment-container').style.display = 'none';
      document.getElementById('results-container').style.display = 'block';
      document.getElementById('lead-form-container').style.display = 'block';
      document.getElementById('results-content').style.display = 'none';
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function renderResults(results) {
      if (!results) return;

      const { foundationScore, aiScore, orgScore, totalScore } = results;
      const journey = journeyDetails[recommendedPath];
      const tier = deploymentTiers[deploymentTier];

      document.getElementById('lead-form-container').style.display = 'none';
      document.getElementById('results-content').style.display = 'block';
      
      document.getElementById('overall-score').textContent = totalScore;
      document.getElementById('readiness-tier').textContent = journey.shortName;
      document.getElementById('overall-grade').textContent = `Grade ${getLetterGrade(totalScore)}`;
      document.getElementById('foundation-score').textContent = foundationScore;
      document.getElementById('ai-score').textContent = aiScore;
      document.getElementById('org-score').textContent = orgScore;
      document.getElementById('tier-outcome').textContent = getTierOutcome(recommendedPath);
      document.getElementById('mcp-readiness').textContent = getMcpReadinessStatus(foundationScore, aiScore);

      const journeyColorMap = {
        'slate': { bg: 'rgba(255,255,255,0.05)', border: 'rgba(255,255,255,0.1)', text: '#fff', badge: '#64748b' },
        'blue': { bg: 'rgba(59, 130, 246, 0.15)', border: 'rgba(59, 130, 246, 0.3)', text: '#93c5fd', badge: '#3b82f6' },
        'emerald': { bg: 'rgba(16, 185, 129, 0.15)', border: 'rgba(16, 185, 129, 0.3)', text: '#6ee7b7', badge: '#10b981' },
        'violet': { bg: 'rgba(100, 54, 191, 0.15)', border: 'rgba(100, 54, 191, 0.3)', text: '#c4b5fd', badge: '#6436bf' }
      };
      const journeyColor = journeyColorMap[journey.color] || journeyColorMap.slate;

      // Investment Path Recommendation
      document.getElementById('path-recommendation').innerHTML = `
        <div style="background: ${journeyColor.bg}; border: 2px solid ${journeyColor.border}; border-radius: 12px; padding: 20px;">
          <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 16px;">
            <div style="width: 64px; height: 64px; border-radius: 8px; background: ${journeyColor.badge}; display: flex; align-items: center; justify-content: center; color: #fff; font-weight: 700; font-size: 0.85rem; text-align: center; padding: 4px;">
              ${journey.shortName}
            </div>
            <div style="flex: 1;">
              <h4 style="font-size: 1.25rem; font-weight: 700; color: #fff;">${journey.name}</h4>
              <p style="font-size: 0.875rem; color: ${journeyColor.text};">${journey.description}</p>
            </div>
          </div>
          <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 16px;">
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-bottom: 4px;">Typical Investment</p>
              <p style="font-weight: 700; color: #fff;">${journey.tcv}</p>
            </div>
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-bottom: 4px;">Ideal Use Case</p>
              <p style="font-weight: 700; color: #fff;">${journey.description}</p>
            </div>
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-bottom: 4px;">Why This Path</p>
              <p style="font-weight: 600; color: #fff;">${journey.focus}</p>
            </div>
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-bottom: 4px;">Path</p>
              <p style="font-weight: 700; color: #fff; font-size: 0.75rem;">${journey.path}</p>
            </div>
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-bottom: 4px;">Expected Outcome</p>
              <p style="font-weight: 600; color: #fff;">${journey.outcome}</p>
            </div>
          </div>
        </div>
      `;

      // Deployment Tier
      document.getElementById('deployment-recommendation').innerHTML = `
        <div style="background: rgba(251, 191, 36, 0.15); border: 2px solid rgba(251, 191, 36, 0.3); border-radius: 12px; padding: 20px;">
          <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 16px;">
            <div style="width: 64px; height: 64px; border-radius: 8px; background: #fbbf24; display: flex; align-items: center; justify-content: center; color: #000; font-weight: 700; font-size: 1.25rem;">
              ${deploymentTier}
            </div>
            <div style="flex: 1;">
              <h4 style="font-size: 1.25rem; font-weight: 700; color: #fff;">${tier.name}</h4>
              <p style="font-size: 0.875rem; color: #fde047;">${tier.compliance}</p>
            </div>
          </div>
          <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;">
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-bottom: 4px;">Deploy Time</p>
              <p style="font-weight: 700; color: #fff;">${tier.time}</p>
            </div>
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-bottom: 4px;">Services Premium</p>
              <p style="font-weight: 700; color: #4ade80;">${tier.premium}</p>
            </div>
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-bottom: 4px;">Compliance</p>
              <p style="font-weight: 700; color: #fff; font-size: 0.75rem;">${tier.compliance}</p>
            </div>
          </div>
          ${deploymentTier === 'D3' || deploymentTier === 'D4' ? `
            <div style="margin-top: 16px; background: rgba(251, 191, 36, 0.2); border-radius: 8px; padding: 12px;">
              <p style="font-size: 0.75rem; font-weight: 600; color: #fde047; margin-bottom: 4px;">⚠️ Phase 0 Required</p>
              <p style="font-size: 0.875rem; color: #fde047;">D3/D4 deployments require Phase 0 (Deployment & Security) before Foundation can begin. This adds $175-450K and 8-16 weeks.</p>
            </div>
          ` : ''}
        </div>
      `;

      // Trust & Governance Gate
      const trustGate = getTrustGovernanceGate(deploymentTier, tier);
      document.getElementById('trust-governance').innerHTML = `
        <h3 style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px;">
          <i data-lucide="shield" style="width: 20px; height: 20px; color: #60a5fa;"></i>
          Trust & Governance Gate
        </h3>
        <div class="content-box">
          <p style="font-size: 0.875rem; color: rgba(255,255,255,0.85); margin-bottom: 8px;">${trustGate.summary}</p>
          <p style="font-size: 0.75rem; color: rgba(255,255,255,0.65);">${trustGate.detail}</p>
        </div>
      `;

      // Narrative Summary
      document.getElementById('narrative-summary').innerHTML = `
        <h3 style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px;">
          <i data-lucide="message-circle" style="width: 20px; height: 20px; color: #a78bfa;"></i>
          What This Means for You
        </h3>
        <div class="content-box">
          <p style="font-size: 0.9rem; color: rgba(255,255,255,0.85);">
            ${generateNarrativeSummary(foundationScore, aiScore, orgScore, totalScore, recommendedPath)}
          </p>
        </div>
      `;

      // Product Leadership POV
      const pov = getLeadershipPov(foundationScore, aiScore, orgScore, recommendedPath);
      document.getElementById('leadership-pov').innerHTML = `
        <h3 style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px;">
          <i data-lucide="sparkles" style="width: 20px; height: 20px; color: #60a5fa;"></i>
          Product Leadership POV
        </h3>
        <div class="content-box" style="margin-bottom: 12px;">
          <p style="font-size: 0.9rem; color: rgba(255,255,255,0.85);">${pov.summary}</p>
        </div>
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
          ${pov.bullets.map(item => `
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6); margin-bottom: 6px;">${item.title}</p>
              <p style="font-weight: 700; color: #fff;">${item.text}</p>
            </div>
          `).join('')}
        </div>
        <div style="margin-top: 12px; background: rgba(59, 130, 246, 0.15); border-radius: 8px; padding: 10px; border: 1px solid rgba(59, 130, 246, 0.35);">
          <p style="font-size: 0.8rem; color: #bfdbfe;">${pov.emphasis}</p>
        </div>
      `;

      // Breakdown Details
      document.getElementById('breakdown-details').innerHTML = `
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;">
          <div style="background: rgba(16, 185, 129, 0.15); border-radius: 12px; padding: 16px; border: 1px solid rgba(16, 185, 129, 0.3);">
            <h4 style="font-weight: 600; color: #6ee7b7; margin-bottom: 8px;">Product System Foundation</h4>
            <p style="font-size: 1.5rem; font-weight: 700; color: #6ee7b7; margin-bottom: 4px;">${foundationScore}/40</p>
            <div style="height: 8px; background: rgba(16, 185, 129, 0.2); border-radius: 9999px; overflow: hidden; margin-top: 8px;">
              <div style="height: 100%; background: #10b981; width: ${(foundationScore/40)*100}%"></div>
            </div>
            <p style="font-size: 0.75rem; color: #6ee7b7; margin-top: 8px;">${foundationScore >= 30 ? 'Strong foundation' : foundationScore >= 15 ? 'Moderate foundation' : 'Foundation needed'}</p>
          </div>
          <div style="background: rgba(100, 54, 191, 0.15); border-radius: 12px; padding: 16px; border: 1px solid rgba(100, 54, 191, 0.3);">
            <h4 style="font-weight: 600; color: #c4b5fd; margin-bottom: 8px;">AI & Automation Readiness</h4>
            <p style="font-size: 1.5rem; font-weight: 700; color: #c4b5fd; margin-bottom: 4px;">${aiScore}/30</p>
            <div style="height: 8px; background: rgba(100, 54, 191, 0.2); border-radius: 9999px; overflow: hidden; margin-top: 8px;">
              <div style="height: 100%; background: #6436bf; width: ${(aiScore/30)*100}%"></div>
            </div>
            <p style="font-size: 0.75rem; color: #c4b5fd; margin-top: 8px;">${aiScore >= 20 ? 'AI-ready' : aiScore >= 10 ? 'Moderate readiness' : 'AI prep needed'}</p>
          </div>
          <div style="background: rgba(59, 130, 246, 0.15); border-radius: 12px; padding: 16px; border: 1px solid rgba(59, 130, 246, 0.3);">
            <h4 style="font-weight: 600; color: #93c5fd; margin-bottom: 8px;">Organizational Readiness</h4>
            <p style="font-size: 1.5rem; font-weight: 700; color: #93c5fd; margin-bottom: 4px;">${orgScore}/30</p>
            <div style="height: 8px; background: rgba(59, 130, 246, 0.2); border-radius: 9999px; overflow: hidden; margin-top: 8px;">
              <div style="height: 100%; background: #3b82f6; width: ${(orgScore/30)*100}%"></div>
            </div>
            <p style="font-size: 0.75rem; color: #93c5fd; margin-top: 8px;">${orgScore >= 20 ? 'Strong org readiness' : orgScore >= 10 ? 'Moderate readiness' : 'Org prep needed'}</p>
          </div>
        </div>
      `;

      // Benchmark Comparison
      const benchmarkData = generateBenchmarkComparison(totalScore, foundationScore, aiScore, orgScore, recommendedPath, selectedIndustry);
      const benchmarkStory = getBenchmarkStory(foundationScore, aiScore, orgScore);
      const nextBestInvestment = getNextBestInvestment(foundationScore, aiScore, orgScore, recommendedPath);
      document.getElementById('benchmark-comparison').innerHTML = `
        <h3 style="font-size: 1.125rem; font-weight: 700; color: #fff; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
          <i data-lucide="trending-up" style="width: 20px; height: 20px; color: #3b82f6;"></i>
          How You Compare to Similar Organizations
        </h3>
        <div class="content-box" style="margin-bottom: 16px;">
          <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6); margin-bottom: 6px;">Industry benchmark: ${benchmarkData.industryLabel}</p>
          <p style="font-size: 0.875rem; color: rgba(255,255,255,0.85); margin-bottom: 8px;">${benchmarkStory}</p>
          <p style="font-size: 0.875rem; font-weight: 600; color: #e0d4f7;">Next best investment: ${nextBestInvestment}</p>
          <p style="font-size: 0.7rem; color: rgba(255,255,255,0.55); margin-top: 8px;">Benchmarks calibrated from 158 enterprise records (Jan 2026).</p>
        </div>
        <div style="display: flex; flex-direction: column; gap: 16px;">
          <div style="background: rgba(59, 130, 246, 0.15); border-radius: 12px; padding: 16px; border: 1px solid rgba(59, 130, 246, 0.3);">
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
              <p style="font-weight: 600; color: #93c5fd;">Your Overall Score</p>
              <p style="font-size: 1.5rem; font-weight: 700; color: #93c5fd;">${totalScore}/100</p>
            </div>
            <div style="display: flex; flex-direction: column; gap: 8px;">
              <div style="display: flex; align-items: center; justify-content: space-between; font-size: 0.875rem;">
                <span style="color: rgba(255,255,255,0.6);">Industry Average</span>
                <span style="font-weight: 500; color: rgba(255,255,255,0.8);">${benchmarkData.industryAvg}/100</span>
              </div>
              <div style="height: 8px; background: rgba(59, 130, 246, 0.2); border-radius: 9999px; overflow: hidden;">
                <div style="height: 100%; background: #60a5fa; width: ${benchmarkData.industryAvg}%"></div>
              </div>
              <div style="display: flex; align-items: center; justify-content: space-between; font-size: 0.875rem;">
                <span style="color: rgba(255,255,255,0.6);">Top Quartile</span>
                <span style="font-weight: 500; color: rgba(255,255,255,0.8);">${benchmarkData.topQuartile}/100</span>
              </div>
              <div style="height: 8px; background: rgba(59, 130, 246, 0.2); border-radius: 9999px; overflow: hidden;">
                <div style="height: 100%; background: #3b82f6; width: ${benchmarkData.topQuartile}%"></div>
              </div>
            </div>
            <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(59, 130, 246, 0.3);">
              <p style="font-size: 0.75rem; color: #93c5fd;">
                <span style="font-weight: 600;">${benchmarkData.comparison}</span> ${benchmarkData.comparisonDetail}
              </p>
            </div>
          </div>
          <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-bottom: 4px;">Foundation</p>
              <p style="font-size: 0.875rem; font-weight: 600; color: #fff;">${foundationScore >= 30 ? 'Top 25%' : foundationScore >= 20 ? 'Top 50%' : foundationScore >= 10 ? 'Bottom 50%' : 'Bottom 25%'}</p>
            </div>
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-bottom: 4px;">AI Readiness</p>
              <p style="font-size: 0.875rem; font-weight: 600; color: #fff;">${aiScore >= 20 ? 'Top 25%' : aiScore >= 10 ? 'Top 50%' : aiScore >= 5 ? 'Bottom 50%' : 'Bottom 25%'}</p>
            </div>
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-bottom: 4px;">Org Readiness</p>
              <p style="font-size: 0.875rem; font-weight: 600; color: #fff;">${orgScore >= 20 ? 'Top 25%' : orgScore >= 10 ? 'Top 50%' : orgScore >= 5 ? 'Bottom 50%' : 'Bottom 25%'}</p>
            </div>
          </div>
          <div class="content-box">
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">
              <span style="font-weight: 600;">Based on analysis of 50+ enterprise organizations</span> including PNC, Edward Jones, The Home Depot, CSX, and others across Financial Services, Retail, Technology, and Healthcare industries.
            </p>
          </div>
        </div>
      `;

      const foundationPosition = getPeerPosition(foundationScore, 40);
      const aiPosition = getPeerPosition(aiScore, 30);
      const orgPosition = getPeerPosition(orgScore, 30);
      const pointsToTopQuartile = Math.max(0, Math.round(benchmarkData.topQuartile - totalScore));
      document.getElementById('benchmark-visuals').innerHTML = `
        <h3 style="font-size: 1.125rem; font-weight: 700; color: #fff; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
          <i data-lucide="activity" style="width: 20px; height: 20px; color: #a78bfa;"></i>
          Benchmark Visualization
        </h3>
        <div class="content-box" style="margin-bottom: 16px;">
          <p style="font-size: 0.85rem; color: rgba(255,255,255,0.85); margin-bottom: 10px;">Distance to AI-ready production</p>
          <div style="position: relative; height: 10px; background: rgba(255,255,255,0.1); border-radius: 9999px; overflow: hidden;">
            <div style="height: 100%; width: ${totalScore}%; background: linear-gradient(90deg, #6436bf 0%, #a78bfa 100%);"></div>
            <div style="position: absolute; left: ${benchmarkData.industryAvg}%; top: -4px; width: 2px; height: 18px; background: #60a5fa;"></div>
            <div style="position: absolute; left: ${benchmarkData.topQuartile}%; top: -4px; width: 2px; height: 18px; background: #3b82f6;"></div>
          </div>
          <div style="display: flex; justify-content: space-between; font-size: 0.75rem; color: rgba(255,255,255,0.6); margin-top: 8px;">
            <span>Your score: ${totalScore}</span>
            <span>Industry avg: ${benchmarkData.industryAvg}</span>
            <span>Top quartile: ${benchmarkData.topQuartile}</span>
          </div>
          <p style="font-size: 0.75rem; color: rgba(255,255,255,0.7); margin-top: 8px;">
            ${pointsToTopQuartile} points to top-quartile readiness.
          </p>
        </div>
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
          ${[
            { label: 'Foundation', position: foundationPosition },
            { label: 'AI Context', position: aiPosition },
            { label: 'Org Alignment', position: orgPosition }
          ].map(item => `
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6); margin-bottom: 6px;">${item.label}</p>
              <div style="height: 6px; background: rgba(255,255,255,0.1); border-radius: 9999px; overflow: hidden; margin-bottom: 6px;">
                <div style="height: 100%; width: ${item.position.percent}%; background: #a78bfa;"></div>
              </div>
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.8);">${item.position.label}</p>
            </div>
          `).join('')}
        </div>
      `;

      // ROI Business Case
      const roiCase = getRoiBusinessCase(recommendedPath);
      document.getElementById('roi-business-case').innerHTML = `
        <h3 style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px; color: #fff;">
          <i data-lucide="trending-up" style="width: 20px; height: 20px; color: #34d399;"></i>
          Intelligent Product Engine ROI Business Case
        </h3>
        <div class="content-box" style="margin-bottom: 16px;">
          <p style="font-size: 0.875rem; color: rgba(255,255,255,0.9); margin-bottom: 6px;">${roiCase.summary}</p>
          <p style="font-size: 0.75rem; color: rgba(255,255,255,0.65);">${roiCase.assumption}</p>
        </div>
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 16px;">
          <div class="content-box">
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6); margin-bottom: 4px;">Annual ROI Range</p>
            <p style="font-size: 1.4rem; font-weight: 700; color: #fff;">${roiCase.annual}</p>
          </div>
          <div class="content-box">
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6); margin-bottom: 4px;">3-Year Total Return</p>
            <p style="font-size: 1.4rem; font-weight: 700; color: #fff;">${roiCase.threeYear}</p>
          </div>
        </div>
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
          ${roiCase.drivers.map(driver => `
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6); margin-bottom: 4px;">${driver.title}</p>
              <p style="font-size: 0.85rem; color: rgba(255,255,255,0.85);">${driver.desc}</p>
            </div>
          `).join('')}
        </div>
        <div style="margin-top: 16px; display: flex; gap: 12px; flex-wrap: wrap;">
          <a href="https://knapsack.cloud/roi" target="_blank" rel="noopener noreferrer" style="background: #fff; color: #059669; padding: 10px 16px; border-radius: 8px; font-weight: 600; text-decoration: none;">
            Open ROI Calculator
          </a>
          <span style="font-size: 0.75rem; color: rgba(255,255,255,0.6); align-self: center;">Use the calculator to tailor this estimate for your org.</span>
        </div>
      `;

      // AI-Ready Next Step
      const nextStep = getAiReadyNextStep(recommendedPath);
      document.getElementById('ai-ready-next-step').innerHTML = `
        <h3 style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px; color: #fff;">
          <i data-lucide="sparkles" style="width: 20px; height: 20px; color: #60a5fa;"></i>
          Intelligent Product Engine Next Step
        </h3>
        <p style="font-size: 0.9rem; color: rgba(255,255,255,0.9); margin-bottom: 12px;">${nextStep.title}</p>
        <div class="content-box" style="border-color: rgba(59, 130, 246, 0.35);">
          <p style="font-size: 0.85rem; color: rgba(255,255,255,0.85);">${nextStep.detail}</p>
        </div>
      `;

      // Next Steps
      const nextSteps = [];
      
      if (recommendedPath === 'J1') {
        nextSteps.push(
          'Schedule IPE Readiness Diagnostic ($50-60K) to establish baseline',
          'Identify executive sponsor and secure budget allocation',
          'Begin foundation-building activities',
          'Monitor for maturity signals before proposing platform'
        );
      } else if (recommendedPath === 'J2') {
        nextSteps.push(
          'Confirm trigger event and urgency timeline',
          'Schedule rapid activation sprint ($225-325K)',
          'Compress timeline with premium pricing',
          'Focus on speed, not education'
        );
      } else if (recommendedPath === 'J3') {
        nextSteps.push(
          'Begin with IPE Readiness Diagnostic ($50-60K)',
          'Quantify activation gaps and value blockers',
          'Propose Foundation Phase ($350-450K over 16-20 weeks)',
          deploymentTier === 'D3' || deploymentTier === 'D4' ? 'Plan Phase 0 (Deployment & Security) before Foundation' : '',
          'Do NOT propose expansion until production activation achieved'
        );
      } else if (recommendedPath === 'J4') {
        nextSteps.push(
          'Monitor for trigger events (org changes, AI initiatives, budget cycles)',
          'Have Intelligence Phase proposal ready ($165-325K)',
          'Move fast when timing aligns',
          'Focus on MCP activation and platform expansion'
        );
      }

      document.getElementById('next-steps').innerHTML = nextSteps.filter(s => s).map((step, idx) => `
        <div style="display: flex; align-items: flex-start; gap: 12px; padding: 12px; background: rgba(255,255,255,0.03); border-radius: 8px; border: 1px solid rgba(100, 54, 191, 0.3); margin-bottom: 12px;">
          <div style="width: 24px; height: 24px; border-radius: 50%; background: #6436bf; color: #fff; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: 700; flex-shrink: 0;">${idx + 1}</div>
          <p style="font-size: 0.875rem; color: rgba(255,255,255,0.9);">${step}</p>
        </div>
      `).join('');

      // Personalized Insights
      const insights = generatePersonalizedInsights(foundationScore, aiScore, orgScore, totalScore, recommendedPath);
      if (insights.length > 0) {
        const insightColorMap = {
          'emerald': { bg: 'rgba(16, 185, 129, 0.15)', border: 'rgba(16, 185, 129, 0.3)', text: '#6ee7b7', badge: '#10b981' },
          'violet': { bg: 'rgba(100, 54, 191, 0.15)', border: 'rgba(100, 54, 191, 0.3)', text: '#c4b5fd', badge: '#6436bf' },
          'blue': { bg: 'rgba(59, 130, 246, 0.15)', border: 'rgba(59, 130, 246, 0.3)', text: '#93c5fd', badge: '#3b82f6' },
          'amber': { bg: 'rgba(251, 191, 36, 0.15)', border: 'rgba(251, 191, 36, 0.3)', text: '#fde047', badge: '#fbbf24' }
        };
        document.getElementById('personalized-insights').innerHTML = `
          <h3 style="font-size: 1.125rem; font-weight: 700; color: #fff; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
            <i data-lucide="lightbulb" style="width: 20px; height: 20px; color: #fbbf24;"></i>
            Personalized Insights for Your Organization
          </h3>
          <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px;">
            ${insights.map(insight => {
              const colors = insightColorMap[insight.color] || insightColorMap.emerald;
              return `
              <div style="background: ${colors.bg}; border-radius: 12px; padding: 16px; border: 1px solid ${colors.border};">
                <div style="display: flex; align-items: flex-start; gap: 12px; margin-bottom: 12px;">
                  <div style="width: 40px; height: 40px; border-radius: 8px; background: ${colors.badge}; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                    <i data-lucide="${insight.icon}" style="width: 20px; height: 20px; color: #fff;"></i>
                  </div>
                  <div style="flex: 1;">
                    <h4 style="font-weight: 600; color: #fff; margin-bottom: 4px;">${insight.title}</h4>
                    <p style="font-size: 0.875rem; color: ${colors.text}; margin-bottom: 8px;">${insight.text}</p>
                    <div style="background: rgba(255,255,255,0.05); border-radius: 8px; padding: 8px; border: 1px solid ${colors.border};">
                      <p style="font-size: 0.75rem; font-weight: 600; color: ${colors.text}; margin-bottom: 4px;">Value Insight</p>
                      <p style="font-size: 0.75rem; color: ${colors.text};">${insight.value}</p>
                    </div>
                  </div>
                </div>
              </div>
            `;
            }).join('')}
          </div>
        `;
      } else {
        document.getElementById('personalized-insights').innerHTML = '';
      }

      // Cost of Inaction
      const inactionCosts = generateCostOfInaction(foundationScore, aiScore, orgScore, totalScore, recommendedPath);
      document.getElementById('cost-of-inaction').innerHTML = `
        <h3 style="font-size: 1.125rem; font-weight: 700; color: #fff; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
          <i data-lucide="alert-triangle" style="width: 20px; height: 20px; color: #f87171;"></i>
          What Delays Cost in AI-Assisted Delivery
        </h3>
        <p style="font-size: 0.875rem; color: rgba(255,255,255,0.8); margin-bottom: 16px;">Based on your assessment, here's what happens if you delay IPE activation:</p>
        <div style="display: flex; flex-direction: column; gap: 12px;">
          ${inactionCosts.map(cost => `
            <div style="background: rgba(255,255,255,0.03); border-radius: 12px; padding: 16px; border: 1px solid rgba(228, 58, 92, 0.3);">
              <div style="display: flex; align-items: flex-start; gap: 12px;">
                <div style="width: 32px; height: 32px; border-radius: 8px; background: #e43a5c; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                  <i data-lucide="${cost.icon}" style="width: 16px; height: 16px; color: #fff;"></i>
                </div>
                <div style="flex: 1;">
                  <h4 style="font-weight: 600; color: #fff; margin-bottom: 4px;">${cost.title}</h4>
                  <p style="font-size: 0.875rem; color: rgba(255,255,255,0.8);">${cost.description}</p>
                  ${cost.impact ? `<p style="font-size: 0.75rem; font-weight: 600; color: #f87171; margin-top: 8px;">Impact: ${cost.impact}</p>` : ''}
                </div>
              </div>
            </div>
          `).join('')}
        </div>
        <div style="margin-top: 16px; background: rgba(228, 58, 92, 0.15); border-radius: 12px; padding: 16px; border: 1px solid rgba(228, 58, 92, 0.3);">
          <p style="font-size: 0.875rem; font-weight: 600; color: #fff; margin-bottom: 4px;">The Opportunity Cost</p>
          <p style="font-size: 0.875rem; color: rgba(255,255,255,0.8);">${getOpportunityCostMessage(recommendedPath, totalScore)} Organizations that act now see measurable improvements within 8-12 weeks.</p>
        </div>
      `;

      lucide.createIcons();
    }

    function startAssessment() {
      document.getElementById('intro-container').style.display = 'none';
      document.getElementById('assessment-container').style.display = 'block';
      renderQuestion();
    }

    function resetAssessment() {
      currentQuestionIndex = 0;
      answers = {};
      deploymentTier = 'D1';
      pendingResults = null;
      document.getElementById('intro-container').style.display = 'block';
      document.getElementById('assessment-container').style.display = 'none';
      document.getElementById('results-container').style.display = 'none';
      document.getElementById('lead-form-container').style.display = 'block';
      document.getElementById('results-content').style.display = 'none';
      const leadForm = document.getElementById('lead-form');
      if (leadForm) {
        leadForm.reset();
      }
      // Scroll to top
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function submitLeadForm(event) {
      event.preventDefault();
      const form = event.target;
      if (!form.reportValidity()) return;
      const industryInput = form.elements.namedItem('industry');
      if (industryInput && industryInput.value) {
        selectedIndustry = industryInput.value;
      }
      renderResults(pendingResults);
    }

    function downloadResults() {
      const results = {
        overallScore: document.getElementById('overall-score').textContent,
        foundationScore: document.getElementById('foundation-score').textContent,
        aiScore: document.getElementById('ai-score').textContent,
        orgScore: document.getElementById('org-score').textContent,
        deploymentTier: deploymentTier,
        recommendedPath: recommendedPath,
        industry: selectedIndustry,
        timestamp: new Date().toISOString()
      };
      
      const blob = new Blob([JSON.stringify(results, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `ipe-assessment-results-${new Date().toISOString().split('T')[0]}.json`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function generatePersonalizedInsights(foundationScore, aiScore, orgScore, totalScore, recommendedPath) {
      const insights = [];
      
      // Foundation insights
      if (foundationScore < 15) {
        insights.push({
          type: 'foundation',
          icon: 'building',
          color: 'emerald',
          title: 'Foundation Building Opportunity',
          text: 'Your design system foundation needs strengthening. This is actually an advantage—you can build governance in from the start rather than retrofitting it later.',
          value: 'Organizations that build governance early see 3x faster activation timelines.'
        });
      } else if (foundationScore >= 30) {
        insights.push({
          type: 'foundation',
          icon: 'check-circle',
          color: 'emerald',
          title: 'Strong Foundation Detected',
          text: 'Your mature design system positions you well for rapid IPE activation. The Control Plane can leverage your existing system immediately.',
          value: 'Mature design systems typically see ROI within 8-12 weeks of IPE activation.'
        });
      }

      // AI readiness insights
      if (aiScore < 10) {
        insights.push({
          type: 'ai',
          icon: 'sparkles',
          color: 'violet',
          title: 'AI Adoption Window',
          text: 'Low AI tool adoption suggests your organization is early in the AI journey. IPE can help establish best practices from the start.',
          value: 'Early AI governance prevents technical debt that costs 2-3x more to fix later.'
        });
      } else if (aiScore >= 20) {
        insights.push({
          type: 'ai',
          icon: 'zap',
          color: 'violet',
          title: 'AI-Ready Organization',
          text: 'Your teams are already using AI tools. IPE\'s Control Plane will help ensure AI-generated code aligns with your design system standards.',
          value: 'Organizations with AI tool adoption see 40-60% improvement in AI output quality with IPE context.'
        });
      }

      // Organizational insights
      if (orgScore < 10) {
        insights.push({
          type: 'org',
          icon: 'users',
          color: 'blue',
          title: 'Sponsorship Strategy Needed',
          text: 'Securing executive sponsorship is critical for IPE success. Consider starting with a pilot program to demonstrate value.',
          value: 'Pilot programs with clear ROI metrics help secure executive buy-in in 60% of cases.'
        });
      } else if (orgScore >= 20) {
        insights.push({
          type: 'org',
          icon: 'trending-up',
          color: 'blue',
          title: 'Strong Organizational Readiness',
          text: 'Your executive sponsorship and budget alignment indicate readiness for transformation. This positions you for accelerated value delivery.',
          value: 'Organizations with strong sponsorship see 50% faster time-to-value.'
        });
      }

      // Path-specific insights
      if (recommendedPath === 'J3') {
        insights.push({
          type: 'path',
          icon: 'rocket',
          color: 'emerald',
          title: 'High-Value Transformation Opportunity',
          text: 'The Activation Path represents 60% of IPE ARR. Your organization shows the right signals for a full transformation journey.',
          value: 'J3 accounts typically see $2-5M in value unlocked over 18-24 months.'
        });
      } else if (recommendedPath === 'J4') {
        insights.push({
          type: 'path',
          icon: 'brain',
          color: 'violet',
          title: 'Intelligence Phase Ready',
          text: 'Your mature foundation and AI readiness make you an ideal candidate for Intelligence Phase activation. Focus on MCP integration and expansion.',
          value: 'J4 accounts see fastest ROI—typically 6-8 weeks to first AI-assisted production deployment.'
        });
      }

      return insights;
    }

    function generateCostOfInaction(foundationScore, aiScore, orgScore, totalScore, recommendedPath) {
      const costs = [];

      // Foundation-related costs
      if (foundationScore < 20) {
        costs.push({
          icon: 'trending-down',
          title: 'Fragmentation grows over time',
          description: 'Without a governed system of record, teams build overlapping patterns and one-off components that slow delivery.',
          impact: 'Technical debt compounds ~15–25% per quarter without intervention'
        });
      } else if (foundationScore >= 20 && foundationScore < 30) {
        costs.push({
          icon: 'users-x',
          title: 'Adoption stalls without activation',
          description: 'The system exists, but value is uneven without activation and governance.',
          impact: 'Adoption typically stalls around 30–70% without activation'
        });
      }

      // AI-related costs
      if (aiScore >= 10) {
        costs.push({
          icon: 'code',
          title: 'AI output requires more rework',
          description: 'Teams use AI tools, but outputs lack governed context. This creates review cycles and slows time-to-merge.',
          impact: '40–60% of AI-generated code requires manual fixes without governed context'
        });
      } else if (aiScore < 10) {
        costs.push({
          icon: 'clock',
          title: 'AI readiness gap widens',
          description: 'AI adoption is accelerating. Establishing governance early prevents costly retrofits later.',
          impact: 'Delayed governance costs 2–3x more than building it early'
        });
      }

      // Organizational costs
      if (orgScore < 15) {
        costs.push({
          icon: 'dollar-sign',
          title: 'Momentum and budget windows shrink',
          description: 'Without sponsorship, initiatives compete with other priorities and lose momentum.',
          impact: 'Budget windows typically reset every 6–12 months'
        });
      }

      // Path-specific costs
      if (recommendedPath === 'J3') {
        costs.push({
          icon: 'x-circle',
          title: 'Activation value stays unrealized',
          description: 'The largest gains come from activation. Delays push measurable outcomes further out.',
          impact: 'J3 accounts unlock ~$2–5M over 18–24 months when activated'
        });
      } else if (recommendedPath === 'J4') {
        costs.push({
          icon: 'zap',
          title: 'AI advantage erodes',
          description: 'You have the foundation to move quickly. Waiting reduces the opportunity to lead with AI-enabled delivery.',
          impact: 'Delays can surrender a 6–8 week head start to competitors'
        });
      } else if (recommendedPath === 'J2') {
        costs.push({
          icon: 'calendar-x',
          title: 'Time-bound opportunities pass',
          description: 'Rapid activation works best with a clear trigger (launch, rollout, org change).',
          impact: 'Trigger windows typically last 3–6 months'
        });
      } else if (recommendedPath === 'J1') {
        costs.push({
          icon: 'building',
          title: 'Foundation becomes harder to standardize',
          description: 'As more teams ship independently, alignment becomes more complex.',
          impact: 'Each quarter of delay makes foundation 15–20% harder to establish'
        });
      }

      // Velocity cost (always relevant)
      costs.push({
        icon: 'gauge',
        title: 'Delivery speed stays flat',
        description: 'While competitors improve delivery cycles with governed systems, your teams maintain current speed.',
        impact: 'Organizations with activation see 40–60% faster development cycles'
      });

      return costs.slice(0, 4); // Limit to 4 most relevant costs
    }

    function getOpportunityCostMessage(recommendedPath, totalScore) {
      const messages = {
        'J1': 'Starting earlier keeps the foundation small enough to align quickly and avoids costly retrofits later.',
        'J2': 'Timing matters for rapid activation. Acting during the trigger window preserves speed and momentum.',
        'J3': 'Activation unlocks the largest gains. J3 accounts typically unlock $2–5M over 18–24 months when activated.',
        'J4': 'You are positioned to move fast. Delays can forfeit a 6–8 week AI delivery advantage.'
      };
      return messages[recommendedPath] || 'Every quarter you delay, you\'re missing out on significant value and competitive advantage.';
    }

    function getRoiBusinessCase(recommendedPath) {
      const cases = {
        J1: {
          summary: 'Foundation-focused organizations typically see early ROI from reduced rework and faster enablement.',
          annual: '$150K – $350K',
          threeYear: '$450K – $1.1M',
          assumption: 'Based on conservative productivity and governance gains in the first 12 months.',
          drivers: [
            { title: 'Rework reduction', desc: 'Fewer one-off components and duplicated effort.' },
            { title: 'Faster onboarding', desc: 'Teams ramp on shared patterns sooner.' },
            { title: 'Governance efficiency', desc: 'Clear decision flow reduces delays.' }
          ]
        },
        J2: {
          summary: 'Acceleration paths capture near-term gains when timing is critical.',
          annual: '$300K – $700K',
          threeYear: '$900K – $2.1M',
          assumption: 'Based on compressing delivery timelines during an active trigger window.',
          drivers: [
            { title: 'Release velocity', desc: 'Compressed timelines for launch-critical work.' },
            { title: 'Fewer escalations', desc: 'Clear guardrails reduce back-and-forth.' },
            { title: 'Time-to-market', desc: 'Earlier launches drive revenue impact.' }
          ]
        },
        J3: {
          summary: 'Activation programs deliver the largest measurable gains across teams.',
          annual: '$900K – $1.7M',
          threeYear: '$2.7M – $5.1M',
          assumption: 'Based on typical activation outcomes in regulated or complex environments.',
          drivers: [
            { title: 'Cycle-time reduction', desc: '40–60% faster delivery cycles with governed context.' },
            { title: 'AI output quality', desc: 'Higher signal-to-noise in AI-assisted code.' },
            { title: 'Adoption depth', desc: 'More teams shipping with the system of record.' }
          ]
        },
        J4: {
          summary: 'Intelligence paths convert readiness into AI-assisted execution.',
          annual: '$500K – $1.2M',
          threeYear: '$1.5M – $3.6M',
          assumption: 'Based on MCP activation and expansion of governed AI workflows.',
          drivers: [
            { title: 'Governed AI workflows', desc: 'AI that can act safely at scale.' },
            { title: 'Policy automation', desc: 'Rules enforce consistency without manual review.' },
            { title: 'Faster iteration', desc: 'More changes shipped with confidence.' }
          ]
        }
      };
      return cases[recommendedPath] || cases.J1;
    }

    function generateBenchmarkComparison(totalScore, foundationScore, aiScore, orgScore, recommendedPath, industry) {
      const benchmarks = getIndustryBenchmarks(industry);
      const industryAvg = benchmarks.industryAvg;
      const topQuartile = benchmarks.topQuartile;
      
      let comparison = '';
      let comparisonDetail = '';
      
      if (totalScore >= topQuartile) {
        comparison = 'You\'re in the top quartile';
        comparisonDetail = '—organizations at this level typically see 40-60% faster development cycles with IPE activation.';
      } else if (totalScore >= industryAvg) {
        comparison = 'You\'re above industry average';
        comparisonDetail = '—organizations in this range unlock significant value through targeted activation programs.';
      } else if (totalScore >= 30) {
        comparison = 'You\'re below industry average';
        comparisonDetail = '—but within range for transformation. Organizations at this level see the highest ROI from foundation-building.';
      } else {
        comparison = 'You\'re in the early stages';
        comparisonDetail = '—organizations starting here benefit most from building governance early, before technical debt compounds.';
      }
      
      return {
        industryAvg,
        topQuartile,
        comparison,
        comparisonDetail,
        industryLabel: benchmarks.label
      };
    }

    function getIndustryBenchmarks(industry) {
      const benchmarkMap = {
        'Financial Services': { industryAvg: 83.4, topQuartile: 88.0, label: 'Financial Services' },
        'Enterprise Software': { industryAvg: 86.7, topQuartile: 99.0, label: 'Enterprise Software' },
        'Technology / Media': { industryAvg: 85.0, topQuartile: 99.0, label: 'Technology / Media' },
        'Healthcare': { industryAvg: 81.4, topQuartile: 81.0, label: 'Healthcare' },
        'Retail / E-commerce': { industryAvg: 82.6, topQuartile: 81.0, label: 'Retail / E-commerce' },
        'Telecommunications / Media': { industryAvg: 78.2, topQuartile: 77.0, label: 'Telecommunications / Media' },
        'Regulated / Industrial': { industryAvg: 81.0, topQuartile: 81.0, label: 'Regulated / Industrial' },
        'International / Industrial': { industryAvg: 93.0, topQuartile: 99.0, label: 'International / Industrial' },
        'Travel / Hospitality': { industryAvg: 81.0, topQuartile: 81.0, label: 'Travel / Hospitality' },
        'Aerospace / Space': { industryAvg: 52.0, topQuartile: 52.0, label: 'Aerospace / Space' },
        'Education (Nonprofit)': { industryAvg: 65.0, topQuartile: 65.0, label: 'Education (Nonprofit)' },
        'Utilities (Electric)': { industryAvg: 58.0, topQuartile: 58.0, label: 'Utilities (Electric)' },
        'Other / Unknown': { industryAvg: 72.6, topQuartile: 81.0, label: 'Cross-industry' },
        'Unknown': { industryAvg: 57.7, topQuartile: 58.0, label: 'Cross-industry' }
      };
      return benchmarkMap[industry] || { industryAvg: 72.6, topQuartile: 81.0, label: 'Cross-industry' };
    }

    function generateNarrativeSummary(foundationScore, aiScore, orgScore, totalScore, recommendedPath) {
      const grade = getLetterGrade(totalScore);
      const foundation = foundationScore >= 30 ? 'strong' : foundationScore >= 15 ? 'moderate' : 'early';
      const ai = aiScore >= 20 ? 'ready' : aiScore >= 10 ? 'emerging' : 'early';
      const org = orgScore >= 20 ? 'strong' : orgScore >= 10 ? 'moderate' : 'early';
      const pathNames = { J1: 'Foundation', J2: 'Acceleration', J3: 'Activation', J4: 'Intelligence' };
      return `Your overall readiness is ${grade} with a ${foundation} foundation, ${ai} AI adoption, and ${org} organizational readiness. This combination aligns with the ${pathNames[recommendedPath]} Path and focuses on making delivery faster, cheaper, and more consistent by tightening governance and enabling safe AI-assisted development. Implemented ≠ activated; activation is the unlock for measurable outcomes.`;
    }

    function getLeadershipPov(foundationScore, aiScore, orgScore, recommendedPath) {
      const pathFocus = {
        J1: 'Start by establishing a system of record so governance can scale without rework.',
        J2: 'Speed matters, but governance keeps speed from becoming risk.',
        J3: 'Activation is where value compounds. The system must drive decisions, not just documentation.',
        J4: 'MCP turns governed context into safe AI execution at scale.'
      };

      return {
        summary: `AI can generate fast. The real advantage is governed execution—turning intent into production-safe changes. ${pathFocus[recommendedPath] || pathFocus.J1}`,
        bullets: [
          { title: 'AI Execution Gap', text: 'Move from advisory AI to governed action.' },
          { title: 'Control Plane', text: 'Rules + metadata guide every change.' },
          { title: 'Activation > Implementation', text: 'Value comes when adoption is enforced.' }
        ],
        emphasis: 'When governance is the control plane, AI becomes a safe accelerator—not a liability.'
      };
    }

    function getLetterGrade(totalScore) {
      if (totalScore >= 85) return 'A';
      if (totalScore >= 70) return 'B';
      if (totalScore >= 55) return 'C';
      if (totalScore >= 40) return 'D';
      return 'E';
    }

    function getTierOutcome(recommendedPath) {
      const outcomes = {
        J1: 'This tier builds the foundation that unlocks consistent delivery and sets you up for AI-ready scale.',
        J2: 'This tier compresses timelines with a focused activation sprint to hit near-term launch goals.',
        J3: 'This tier typically unlocks 40–60% faster delivery in 12–16 weeks with full activation support.',
        J4: 'This tier accelerates AI-enabled delivery by applying governed context to production workflows.'
      };
      return outcomes[recommendedPath] || 'This tier focuses on measurable delivery improvements and readiness acceleration.';
    }

    function getMcpReadinessStatus(foundationScore, aiScore) {
      if (foundationScore >= 30 && aiScore >= 20) return 'Ready';
      if (foundationScore >= 20 && aiScore >= 10) return 'Prep';
      return 'Locked';
    }

    function getTrustGovernanceGate(deploymentTier, tier) {
      if (deploymentTier === 'D3' || deploymentTier === 'D4') {
        return {
          summary: 'Deployment is the first trust gate for AI-assisted delivery. Your tier indicates a regulated environment where governance must be proven before activation.',
          detail: `Expect Phase 0 requirements (security, networking, compliance) before activation. ${tier.time} is typical for deployment readiness.`
        };
      }
      return {
        summary: 'Deployment is the first trust gate for AI-assisted delivery. Your tier supports faster path to governed activation.',
        detail: `Cloud-first deployment typically enables activation in ${tier.time}. Governance remains the primary unlock.`
      };
    }

    function getAiReadyNextStep(recommendedPath) {
      const nextSteps = {
        J1: {
          title: 'Start with a Readiness Diagnostic to establish governance and system-of-record foundations.',
          detail: 'This creates the baseline AI context and rules needed to accelerate safely later.'
        },
        J2: {
          title: 'Run a focused Activation Sprint to capture timing-sensitive gains.',
          detail: 'Compress the timeline and move quickly while the trigger window is open.'
        },
        J3: {
          title: 'Begin Activation to move from “implemented” to “activated.”',
          detail: 'Governance + activation unlock the largest delivery gains and measurable outcomes.'
        },
        J4: {
          title: 'Activate MCP to operationalize AI workflows with governed context.',
          detail: 'Apply rules and context so AI output meets production standards from day one.'
        }
      };
      return nextSteps[recommendedPath] || nextSteps.J1;
    }

    function getPeerPosition(score, maxScore) {
      const ratio = score / maxScore;
      if (ratio >= 0.75) return { label: 'Above ~75% of peers', percent: 75 };
      if (ratio >= 0.5) return { label: 'Above ~60% of peers', percent: 60 };
      if (ratio >= 0.25) return { label: 'Below ~60% of peers', percent: 40 };
      return { label: 'Below ~75% of peers', percent: 25 };
    }

    function getBenchmarkStory(foundationScore, aiScore, orgScore) {
      const foundationBand = foundationScore >= 30 ? 'top' : foundationScore >= 20 ? 'above' : foundationScore >= 10 ? 'below' : 'early';
      const aiBand = aiScore >= 20 ? 'top' : aiScore >= 10 ? 'above' : aiScore >= 5 ? 'below' : 'early';
      const orgBand = orgScore >= 20 ? 'top' : orgScore >= 10 ? 'above' : orgScore >= 5 ? 'below' : 'early';
      const bandMap = {
        top: 'above ~75% of peers',
        above: 'above ~60% of peers',
        below: 'below ~60% of peers',
        early: 'below ~75% of peers'
      };
      return `You are ${bandMap[foundationBand]} in Foundation, ${bandMap[aiBand]} in AI readiness, and ${bandMap[orgBand]} in Organizational readiness.`;
    }

    function getNextBestInvestment(foundationScore, aiScore, orgScore, recommendedPath) {
      if (foundationScore < 15) return 'Component inventory + governance baseline';
      if (aiScore < 10) return 'AI context + rules engine alignment';
      if (orgScore < 10) return 'Executive sponsorship + change enablement plan';
      if (recommendedPath === 'J4') return 'MCP activation + AI workflow integration';
      if (recommendedPath === 'J3') return 'Activation program + adoption enforcement';
      if (recommendedPath === 'J2') return 'Rapid activation sprint';
      return 'Readiness diagnostic + foundation roadmap';
    }

    // Initialize
    lucide.createIcons();
  </script>
</body>
</html>

