<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product System Maturity & AI Readiness Assessment</title>
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #1a1a2e;
      color: #fff;
      min-height: 100vh;
    }
    .container {
      max-width: 1000px;
      margin: 0 auto;
      padding: 20px;
    }
    .card {
      background: linear-gradient(145deg, #16213e 0%, #1a1a2e 100%);
      border-radius: 16px;
      padding: 32px 48px;
      margin-bottom: 24px;
      border: 1px solid rgba(100, 54, 191, 0.3);
      box-shadow: 0 20px 60px rgba(0,0,0,0.4);
    }
    .progress-bar { transition: width 0.3s ease; }
    .option-card { 
      transition: all 0.2s; 
      background: rgba(255,255,255,0.03);
      border: 1px solid rgba(100, 54, 191, 0.3);
      color: rgba(255,255,255,0.8);
    }
    .option-card:hover { 
      transform: translateY(-2px); 
      box-shadow: 0 4px 12px rgba(100, 54, 191, 0.3);
      border-color: rgba(100, 54, 191, 0.5);
    }
    .option-card.selected { 
      border-color: #6436bf; 
      background: rgba(100, 54, 191, 0.15);
    }
    .fade-in { animation: fadeIn 0.3s ease-in; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    h1 {
      font-size: 2.4rem;
      font-weight: 700;
      line-height: 1.2;
      margin-bottom: 16px;
      background: linear-gradient(135deg, #fff 0%, #e0d4f7 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    h2 {
      font-size: 1.8rem;
      font-weight: 700;
      margin-bottom: 24px;
      color: #fff;
    }
    h3 {
      font-size: 1.1rem;
      font-weight: 600;
      color: #a78bfa;
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .logo-badge {
      display: inline-block;
      background: linear-gradient(135deg, #6436bf 0%, #42247f 100%);
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 1px;
      margin-bottom: 24px;
    }
    .btn-primary {
      background: linear-gradient(135deg, #6436bf 0%, #42247f 100%);
      color: white;
      padding: 12px 32px;
      border-radius: 8px;
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(100, 54, 191, 0.4);
    }
    .content-box {
      background: rgba(255,255,255,0.03);
      border-radius: 12px;
      padding: 24px;
      border: 1px solid rgba(255,255,255,0.08);
    }
    .text-muted { color: rgba(255,255,255,0.6); }
    .text-light { color: rgba(255,255,255,0.8); }
    .form-row { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; }
    .form-label { font-size: 0.75rem; font-weight: 600; color: rgba(255,255,255,0.8); text-transform: uppercase; letter-spacing: 1px; }
    .form-input {
      margin-top: 8px;
      width: 100%;
      padding: 12px 14px;
      border-radius: 8px;
      border: 1px solid rgba(100, 54, 191, 0.4);
      background: rgba(255,255,255,0.03);
      color: #fff;
      font-size: 0.9rem;
    }
    .form-input:focus { outline: 2px solid rgba(100, 54, 191, 0.6); border-color: rgba(100, 54, 191, 0.8); }
    .form-helper { font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-top: 8px; }
    .question-helper {
      font-size: 0.8rem;
      color: rgba(255,255,255,0.6);
      margin-bottom: 12px;
    }
    .question-instruction {
      font-size: 0.75rem;
      color: rgba(255,255,255,0.5);
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
  </style>
</head>
<body>
  <!-- Main Content -->
  <main id="app" class="container">
    <!-- Intro Section (shown before assessment starts) -->
    <div id="intro-container">
      <!-- Hero Section -->
      <div class="card" style="text-align: center;">
        <div class="logo-badge">KNAPSACK ASSESSMENT</div>
        <h1>Assess Your Product System Maturity & AI Readiness</h1>
        <p class="subtitle" style="max-width: 640px; margin: 0 auto 12px;">Get a benchmarked readiness score, a recommended path, and clear next steps to move from AI experimentation to governed execution.</p>
        <p style="max-width: 600px; margin: 0 auto 16px; font-size: 0.8rem; color: rgba(255,255,255,0.65);">
          Benchmark, path, and next‑step roadmap in 5 minutes.
        </p>
        <button onclick="startAssessment()" class="btn-primary" style="display: inline-flex; align-items: center; gap: 8px; font-size: 1rem; padding: 16px 32px;">
          <span>Get My Readiness Score</span>
          <i data-lucide="arrow-right" style="width: 20px; height: 20px;"></i>
        </button>
        <p style="font-size: 0.85rem; color: rgba(255,255,255,0.55); margin-top: 18px;">Takes 5 minutes • Benchmarked across 50+ enterprise product systems</p>
      </div>

      <div class="card" style="padding: 14px 18px;">
        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
          <i data-lucide="sparkles" style="width: 18px; height: 18px; color: #a78bfa;"></i>
          <h3 style="font-size: 0.95rem; font-weight: 700; color: #fff;">Why teams complete this assessment</h3>
        </div>
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px;">
          <div>
            <p style="font-size: 0.8rem; font-weight: 600; color: #fff; margin-bottom: 6px;">Why this assessment is different</p>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">
              <div class="content-box">
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.7); margin-bottom: 6px;">Governance + AI readiness</p>
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">We evaluate activation and AI execution, not just tool adoption.</p>
              </div>
              <div class="content-box">
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.7); margin-bottom: 6px;">Actionable path</p>
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">You get a personalized path with timelines and success criteria.</p>
              </div>
            </div>
          </div>

          <div>
            <p style="font-size: 0.8rem; font-weight: 600; color: #fff; margin-bottom: 6px;">Benchmarking context</p>
            <p style="font-size: 0.8rem; color: rgba(255,255,255,0.7); margin-bottom: 10px;">Benchmarked against 50+ enterprise product systems (PNC, Edward Jones, The Home Depot, CSX) across Financial Services, Retail, Technology, and Healthcare.</p>
            <div style="display: flex; flex-wrap: wrap; gap: 8px;">
              <span style="padding: 4px 10px; background: rgba(255,255,255,0.1); color: rgba(255,255,255,0.8); border-radius: 8px; font-size: 0.75rem; font-weight: 500;">Financial Services</span>
              <span style="padding: 4px 10px; background: rgba(255,255,255,0.1); color: rgba(255,255,255,0.8); border-radius: 8px; font-size: 0.75rem; font-weight: 500;">Retail</span>
              <span style="padding: 4px 10px; background: rgba(255,255,255,0.1); color: rgba(255,255,255,0.8); border-radius: 8px; font-size: 0.75rem; font-weight: 500;">Technology</span>
              <span style="padding: 4px 10px; background: rgba(255,255,255,0.1); color: rgba(255,255,255,0.8); border-radius: 8px; font-size: 0.75rem; font-weight: 500;">Healthcare</span>
            </div>
          </div>

          <div style="grid-column: 1 / -1;">
            <p style="font-size: 0.8rem; font-weight: 600; color: #fff; margin-bottom: 6px;">Key terms</p>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">
              <div class="content-box">
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.7); margin-bottom: 6px;">Product System</p>
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">Shared design + engineering assets that ensure consistency and speed.</p>
              </div>
              <div class="content-box">
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.7); margin-bottom: 6px;">API Maturity</p>
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">How well APIs are documented, versioned, and reusable.</p>
              </div>
              <div class="content-box">
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.7); margin-bottom: 6px;">Product Data & Metadata</p>
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">Structured UI data that powers tools and AI.</p>
              </div>
              <div class="content-box">
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.7); margin-bottom: 6px;">AI Readiness</p>
                <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">Ability to adopt AI with governance that reduces rework.</p>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- Assessment Form -->
    <div id="assessment-container" style="display: none;">
      <!-- Progress Indicator -->
      <div class="card" style="padding: 24px;">
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
          <span style="font-size: 0.875rem; font-weight: 500; color: rgba(255,255,255,0.6);">Assessment Progress</span>
          <span style="font-size: 0.875rem; color: rgba(255,255,255,0.5);" id="progress-text">0%</span>
        </div>
        <div style="height: 8px; background: rgba(255,255,255,0.1); border-radius: 9999px; overflow: hidden;">
          <div id="progress-bar" class="progress-bar" style="height: 100%; background: linear-gradient(90deg, #6436bf 0%, #a78bfa 100%); width: 0%;"></div>
        </div>
      </div>

      <!-- Current Question -->
      <div id="question-container"></div>
    </div>

    <!-- Results -->
    <div id="results-container" style="display: none;">
      <!-- Lead Capture -->
      <div id="lead-form-container" class="card" style="background: rgba(255,255,255,0.03);">
        <h3 style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px;">
          <i data-lucide="mail" style="width: 20px; height: 20px; color: #a78bfa;"></i>
          Get Your Results
        </h3>
        <p style="font-size: 0.875rem; color: rgba(255,255,255,0.7); margin-bottom: 16px;">
          Share a few details and we’ll reveal your full readiness score and recommendations.
        </p>
        <div id="results-preview" class="content-box" style="margin-bottom: 16px; border-color: rgba(100, 54, 191, 0.35);"></div>
        <form id="lead-form" onsubmit="submitLeadForm(event)">
          <div class="form-row">
            <label class="form-label">
              First Name
              <input class="form-input" name="firstName" type="text" autocomplete="given-name" required>
            </label>
            <label class="form-label">
              Last Name
              <input class="form-input" name="lastName" type="text" autocomplete="family-name" required>
            </label>
          </div>
          <div class="form-row" style="margin-top: 16px;">
            <label class="form-label">
              Work Email
              <input class="form-input" name="workEmail" type="email" autocomplete="email" required>
            </label>
            <label class="form-label">
              Company
              <input class="form-input" name="company" type="text" autocomplete="organization" required>
            </label>
          </div>
          <div class="form-row" style="margin-top: 16px;">
            <label class="form-label">
              Company Size (optional)
              <select class="form-input" name="companySize">
                <option value="" disabled selected>Select size</option>
                <option value="1-100">1–100</option>
                <option value="101-500">101–500</option>
                <option value="501-2000">501–2,000</option>
                <option value="2001-10000">2,001–10,000</option>
                <option value="10000+">10,000+</option>
              </select>
            </label>
            <label class="form-label">
              Regulatory Environment (optional)
              <select class="form-input" name="regulatoryEnv">
                <option value="" disabled selected>Select environment</option>
                <option value="Standard">Standard</option>
                <option value="Regulated">Regulated</option>
                <option value="Highly regulated">Highly regulated</option>
              </select>
            </label>
          </div>
          <div class="form-row" style="margin-top: 16px;">
            <label class="form-label">
              Role
              <input class="form-input" name="role" type="text" autocomplete="organization-title">
            </label>
          </div>
          <div class="form-row" style="margin-top: 16px;">
            <label class="form-label">
              Industry
              <select class="form-input" name="industry" required>
                <option value="" disabled selected>Select your industry</option>
                <option value="Financial Services">Financial Services</option>
                <option value="Enterprise Software">Enterprise Software</option>
                <option value="Technology / Media">Technology / Media</option>
                <option value="Healthcare">Healthcare</option>
                <option value="Retail / E-commerce">Retail / E-commerce</option>
                <option value="Telecommunications / Media">Telecommunications / Media</option>
                <option value="Regulated / Industrial">Regulated / Industrial</option>
                <option value="International / Industrial">International / Industrial</option>
                <option value="Travel / Hospitality">Travel / Hospitality</option>
                <option value="Aerospace / Space">Aerospace / Space</option>
                <option value="Education (Nonprofit)">Education (Nonprofit)</option>
                <option value="Utilities (Electric)">Utilities (Electric)</option>
                <option value="Other / Unknown">Other / Unknown</option>
              </select>
            </label>
          </div>
          <label class="form-label" style="margin-top: 16px;">
            Additional Context (optional)
            <textarea class="form-input" name="context" rows="4" placeholder="Share any context that could help interpret your results."></textarea>
          </label>
          <p class="form-helper">We’ll only use this to personalize your assessment results.</p>
          <p class="form-helper">Privacy: your details are used only for this assessment and follow-up you request.</p>
          <button type="submit" class="btn-primary" style="margin-top: 16px; width: 100%;">
            Reveal My Results
          </button>
        </form>
      </div>

      <div id="results-content" style="display: none;">
      <!-- Benchmark Comparison -->
      <div id="benchmark-comparison" class="card"></div>

      <!-- Benchmark Visualization -->
      <div id="benchmark-visuals" class="card"></div>

      <!-- Overall Score -->
      <div class="card" style="background: linear-gradient(135deg, #6436bf 0%, #42247f 100%); padding: 32px;">
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px;">
          <div>
            <p style="color: rgba(255,255,255,0.8); font-size: 0.875rem; font-weight: 500; margin-bottom: 4px;">READINESS TIER</p>
            <div style="display: flex; align-items: baseline; gap: 12px; flex-wrap: wrap;">
              <h2 style="font-size: 2.2rem; font-weight: 700; color: #fff; margin: 0;" id="readiness-tier">Foundation</h2>
              <span id="benchmark-label" style="font-size: 0.85rem; font-weight: 700; color: #e0d4f7; text-transform: uppercase; letter-spacing: 1px;">Benchmark —</span>
              <span style="font-size: 0.875rem; color: rgba(255,255,255,0.7);">Score <span id="overall-score">0</span>/100</span>
            </div>
            <p id="tier-outcome" style="color: rgba(255,255,255,0.85); font-size: 0.875rem; margin-top: 8px;">—</p>
            <p style="color: rgba(255,255,255,0.7); font-size: 0.75rem; margin-top: 6px;">Implemented ≠ adopted. Adoption is the unlock for measurable outcomes.</p>
            <div style="margin-top: 12px; display: inline-flex; align-items: center; gap: 8px; background: rgba(255,255,255,0.15); border-radius: 999px; padding: 6px 10px;">
              <span style="font-size: 0.7rem; letter-spacing: 1px; text-transform: uppercase; color: rgba(255,255,255,0.7);">AI Readiness</span>
              <span id="mcp-readiness" style="font-size: 0.75rem; font-weight: 700; color: #fff;">—</span>
            </div>
            <div style="margin-top: 12px; background: rgba(59, 130, 246, 0.2); border-radius: 8px; padding: 10px; border: 1px solid rgba(59, 130, 246, 0.4);">
              <p style="font-size: 0.8rem; color: #bfdbfe;">
                Intelligent Product Engine is the governable control plane that turns AI from advisory to production-safe execution.
              </p>
            </div>
          </div>
          <div style="width: 96px; height: 96px; border-radius: 50%; background: rgba(255,255,255,0.2); display: flex; align-items: center; justify-content: center;">
            <i data-lucide="target" style="width: 48px; height: 48px; color: #fff;"></i>
          </div>
        </div>
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-top: 24px;">
          <div style="background: rgba(255,255,255,0.1); border-radius: 12px; padding: 12px;">
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.8); margin-bottom: 4px;">Product System Foundation</p>
            <p style="font-size: 1.5rem; font-weight: 700; color: #fff;" id="foundation-score">0</p>
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.8);">/ 40</p>
          </div>
          <div style="background: rgba(255,255,255,0.1); border-radius: 12px; padding: 12px;">
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.8); margin-bottom: 4px;">AI & Automation Readiness</p>
            <p style="font-size: 1.5rem; font-weight: 700; color: #fff;" id="ai-score">0</p>
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.8);">/ 30</p>
          </div>
          <div style="background: rgba(255,255,255,0.1); border-radius: 12px; padding: 12px;">
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.8); margin-bottom: 4px;">Organizational Readiness</p>
            <p style="font-size: 1.5rem; font-weight: 700; color: #fff;" id="org-score">0</p>
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.8);">/ 30</p>
          </div>
        </div>
      </div>

      <!-- Narrative Summary -->
      <div id="narrative-summary" class="card"></div>

      <!-- Product Leadership POV -->
      <div id="leadership-pov" class="card" style="background: rgba(255,255,255,0.03);"></div>


      <!-- Investment Path Recommendation -->
      <div class="card">
        <h3 style="display: flex; align-items: center; gap: 8px; margin-bottom: 24px;">
          <i data-lucide="git-branch" style="width: 20px; height: 20px; color: #a78bfa;"></i>
          Recommended Focus
        </h3>
        <div id="path-recommendation"></div>
      </div>


      <!-- Detailed Breakdown -->
      <div class="card">
        <h3 style="display: flex; align-items: center; gap: 8px; margin-bottom: 24px;">
          <i data-lucide="bar-chart-3" style="width: 20px; height: 20px; color: #3b82f6;"></i>
          Assessment Breakdown
        </h3>
        <div id="breakdown-details"></div>
      </div>

      <!-- ROI Business Case -->
      <div id="roi-business-case" class="card" style="background: rgba(16, 185, 129, 0.12); border: 2px solid rgba(16, 185, 129, 0.3);"></div>


      <!-- Next Steps -->
      <div class="card" style="background: rgba(100, 54, 191, 0.1); border: 2px solid rgba(100, 54, 191, 0.3);">
        <h3 style="display: flex; align-items: center; gap: 8px; margin-bottom: 24px; color: #fff;">
          <i data-lucide="arrow-right" style="width: 20px; height: 20px; color: #a78bfa;"></i>
          Recommended Next Steps
        </h3>
        <div id="next-steps"></div>
      </div>

      <!-- Personalized Insights -->
      <div id="personalized-insights" class="card"></div>

      <!-- Cost of Inaction -->
      <div id="cost-of-inaction" class="card" style="background: rgba(228, 58, 92, 0.1); border: 2px solid rgba(228, 58, 92, 0.3);"></div>

      <!-- Connect with Knapsack CTA -->
      <div class="card" style="background: linear-gradient(135deg, #6436bf 0%, #3b82f6 100%); padding: 32px;">
        <div style="display: flex; flex-direction: column; gap: 24px;">
          <div style="flex: 1;">
            <h3 style="font-size: 1.5rem; font-weight: 700; color: #fff; margin-bottom: 8px;">Ready to take the next step?</h3>
            <p style="color: rgba(255,255,255,0.85); margin-bottom: 16px;">Schedule a personalized consultation with our IPE experts to discuss your assessment results and explore how the Intelligent Product Engine can accelerate your product delivery.</p>
            <div style="display: flex; flex-wrap: wrap; gap: 12px; font-size: 0.875rem;">
              <div style="display: flex; align-items: center; gap: 8px; background: rgba(255,255,255,0.2); border-radius: 8px; padding: 8px 12px;">
                <i data-lucide="calendar" style="width: 16px; height: 16px;"></i>
                <span>30-minute consultation</span>
              </div>
              <div style="display: flex; align-items: center; gap: 8px; background: rgba(255,255,255,0.2); border-radius: 8px; padding: 8px 12px;">
                <i data-lucide="file-text" style="width: 16px; height: 16px;"></i>
                <span>Detailed roadmap</span>
              </div>
              <div style="display: flex; align-items: center; gap: 8px; background: rgba(255,255,255,0.2); border-radius: 8px; padding: 8px 12px;">
                <i data-lucide="users" style="width: 16px; height: 16px;"></i>
                <span>Expert guidance</span>
              </div>
            </div>
          </div>
          <div style="display: flex; flex-direction: column; gap: 12px;">
            <a href="mailto:ipe@knapsack.cloud?subject=Product System Maturity Assessment Results - Consultation Request" onclick="trackEvent('cta_schedule_consult')" style="background: #fff; color: #6436bf; padding: 12px 24px; border-radius: 8px; font-weight: 600; transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px; text-decoration: none; text-align: center;">
              <i data-lucide="mail" style="width: 20px; height: 20px;"></i>
              <span>Schedule Consultation</span>
            </a>
            <button onclick="downloadResults()" style="background: rgba(255,255,255,0.2); color: #fff; padding: 12px 24px; border-radius: 8px; font-weight: 500; border: 1px solid rgba(255,255,255,0.3); cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px;">
              <i data-lucide="download" style="width: 20px; height: 20px;"></i>
              <span>Download Results</span>
            </button>
            <button onclick="emailResults()" style="background: rgba(255,255,255,0.12); color: #fff; padding: 12px 24px; border-radius: 8px; font-weight: 500; border: 1px solid rgba(255,255,255,0.25); cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px;">
              <i data-lucide="mail" style="width: 20px; height: 20px;"></i>
              <span>Email Me a Copy</span>
            </button>
            <button onclick="copyResultsSummary()" style="background: rgba(255,255,255,0.08); color: #fff; padding: 12px 24px; border-radius: 8px; font-weight: 500; border: 1px solid rgba(255,255,255,0.2); cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px;">
              <i data-lucide="copy" style="width: 20px; height: 20px;"></i>
              <span>Copy Summary</span>
            </button>
          </div>
        </div>
      </div>

      <!-- Restart Button -->
      <button onclick="resetAssessment()" style="width: 100%; display: flex; align-items: center; justify-content: center; gap: 8px; padding: 12px 24px; background: rgba(255,255,255,0.1); color: #fff; border-radius: 8px; font-weight: 500; border: 1px solid rgba(100, 54, 191, 0.3); cursor: pointer; transition: all 0.2s; margin-bottom: 24px;">
        <i data-lucide="refresh-cw" style="width: 20px; height: 20px;"></i>
        Start New Assessment
      </button>
      </div>
    </div>
  </main>

  <script>
    // Assessment Questions
    const questions = [
      // Product System Foundation (40 points total)
      {
        category: 'Product System Foundation',
        weight: 40,
        question: 'What is the current state of your design system?',
        options: [
          { text: 'No design system exists', score: 0, value: 'none' },
          { text: 'Informal or scattered components', score: 5, value: 'informal' },
          { text: 'Design system exists but limited adoption', score: 10, value: 'limited' },
          { text: 'Design system deployed, moderate adoption (30-70%)', score: 15, value: 'moderate' },
          { text: 'Mature design system with high adoption (>70%)', score: 20, value: 'mature' }
        ]
      },
      {
        category: 'Product System Foundation',
        weight: 40,
        question: 'How is your design system governed?',
        options: [
          { text: 'No governance structure', score: 0, value: 'none' },
          { text: 'Informal or ad-hoc governance', score: 3, value: 'informal' },
          { text: 'Governance exists but not enforced', score: 6, value: 'exists' },
          { text: 'Active governance with decision authority', score: 10, value: 'active' },
          { text: 'Cross-system governance with clear rules', score: 12, value: 'cross-system' }
        ]
      },
      {
        category: 'Product System Foundation',
        weight: 40,
        question: 'What is the quality of your design system documentation?',
        helper: 'Examples: basic = usage + visual rules; comprehensive = usage + interaction + accessibility + code references.',
        options: [
          { text: 'No documentation', score: 0, value: 'none' },
          { text: 'Minimal or outdated documentation', score: 2, value: 'minimal' },
          { text: 'Basic documentation exists', score: 4, value: 'basic' },
          { text: 'Comprehensive, up-to-date documentation', score: 6, value: 'comprehensive' },
          { text: 'Living documentation integrated with code', score: 8, value: 'living' }
        ]
      },
      
      // AI & Automation Readiness (30 points total)
      {
        category: 'AI & Automation Readiness',
        weight: 30,
        question: 'How are your teams currently using AI coding tools?',
        options: [
          { text: 'No AI tools in use', score: 0, value: 'none' },
          { text: 'Limited experimentation', score: 3, value: 'experimental' },
          { text: 'Some teams using AI tools', score: 6, value: 'some' },
          { text: 'Widespread AI tool adoption', score: 10, value: 'widespread' },
          { text: 'AI tools integrated into workflows', score: 12, value: 'integrated' }
        ]
      },
      {
        category: 'AI & Automation Readiness',
        weight: 30,
        question: 'What is your API maturity and integration architecture?',
        helper: 'Think: documented endpoints, versioning, consistent patterns, reuse across teams.',
        options: [
          { text: 'No APIs or integration architecture', score: 0, value: 'none' },
          { text: 'Basic APIs exist', score: 3, value: 'basic' },
          { text: 'Well-defined APIs with documentation', score: 6, value: 'defined' },
          { text: 'Mature API architecture', score: 9, value: 'mature' },
          { text: 'API-first architecture built for AI workflows', score: 12, value: 'mcp-ready' }
        ]
      },
      {
        category: 'AI & Automation Readiness',
        weight: 30,
        question: 'What is the quality of your product data and metadata?',
        helper: 'Includes tokens, components, states, accessibility metadata, and how consistently it is structured.',
        options: [
          { text: 'No structured data', score: 0, value: 'none' },
          { text: 'Fragmented or inconsistent data', score: 2, value: 'fragmented' },
          { text: 'Some structured data exists', score: 4, value: 'some' },
          { text: 'Well-structured, consistent data', score: 6, value: 'structured' },
          { text: 'Rich metadata with semantic relationships', score: 8, value: 'rich' }
        ]
      },
      
      // Organizational Readiness (30 points total)
      {
        category: 'Organizational Readiness',
        weight: 30,
        question: 'Is there an executive sponsor for this initiative?',
        options: [
          { text: 'No sponsor identified', score: 0, value: 'none' },
          { text: 'Influencer only (IC or Manager)', score: 3, value: 'influencer' },
          { text: 'Director-level champion', score: 6, value: 'director' },
          { text: 'VP-level executive sponsor', score: 10, value: 'vp' },
          { text: 'C-level executive sponsor', score: 12, value: 'c-level' }
        ]
      },
      {
        category: 'Organizational Readiness',
        weight: 30,
        question: 'What is the status of budget for this investment?',
        options: [
          { text: 'No budget allocated', score: 0, value: 'none' },
          { text: 'Budget would need to be found', score: 3, value: 'find' },
          { text: 'Budget exists, needs approval', score: 6, value: 'approval' },
          { text: 'Budget allocated and approved', score: 10, value: 'allocated' },
          { text: 'Budget allocated with multi-year commitment', score: 12, value: 'multi-year' }
        ]
      },
      {
        category: 'Organizational Readiness',
        weight: 30,
        question: 'What is your team capacity for change management?',
        helper: 'If you are unsure, choose "Not sure yet" and we can help assess.',
        options: [
          { text: 'No capacity for change', score: 0, value: 'none' },
          { text: 'Limited capacity', score: 2, value: 'limited' },
          { text: 'Moderate capacity', score: 4, value: 'moderate' },
          { text: 'Dedicated change management resources', score: 6, value: 'dedicated' },
          { text: 'Strong change management capability', score: 8, value: 'strong' },
          { text: 'Not sure yet', score: 0, value: 'unknown' }
        ]
      },
      
      // Delivery & Culture Snapshot (integrated into assessment flow)
      {
        category: 'Delivery & Culture',
        weight: 0,
        key: 'decisionClarity',
        question: 'How clear are product decision rights and ownership?',
        options: [
          { text: 'Unclear or shifting ownership', score: 0, value: 'low' },
          { text: 'Mostly clear, with some gaps', score: 0, value: 'medium' },
          { text: 'Very clear and consistent', score: 0, value: 'high' }
        ]
      },
      {
        category: 'Delivery & Culture',
        weight: 0,
        key: 'experimentPace',
        question: 'How fast can you run experiments or validate ideas?',
        options: [
          { text: 'Slow (monthly or longer)', score: 0, value: 'low' },
          { text: 'Steady (every 2–4 weeks)', score: 0, value: 'medium' },
          { text: 'Fast (weekly or faster)', score: 0, value: 'high' }
        ]
      },
      {
        category: 'Delivery & Culture',
        weight: 0,
        key: 'collaboration',
        question: 'How well do product, design, and engineering collaborate?',
        options: [
          { text: 'Siloed with frequent handoff friction', score: 0, value: 'low' },
          { text: 'Aligned but inconsistent', score: 0, value: 'medium' },
          { text: 'Highly integrated and continuous', score: 0, value: 'high' }
        ]
      },
      {
        category: 'Delivery & Culture',
        weight: 0,
        key: 'toolchain',
        question: 'How mature is your tool chain for design-to-code delivery?',
        options: [
          { text: 'Fragmented tools, limited automation', score: 0, value: 'low' },
          { text: 'Partially integrated with some automation', score: 0, value: 'medium' },
          { text: 'Integrated tool chain with strong automation', score: 0, value: 'high' }
        ]
      },
      {
        category: 'Delivery & Culture',
        weight: 0,
        key: 'workflow',
        question: 'How consistent is your delivery workflow from idea to release?',
        options: [
          { text: 'Inconsistent, varies by team', score: 0, value: 'low' },
          { text: 'Mostly consistent with exceptions', score: 0, value: 'medium' },
          { text: 'Consistent and repeatable across teams', score: 0, value: 'high' }
        ]
      },

      // Deployment Tier Questions
      {
        category: 'Deployment',
        weight: 0,
        question: 'What are your compliance and infrastructure requirements?',
        helper: 'Select all that apply. We will use the highest requirement to recommend deployment tier.',
        options: [
          { text: 'Standard SaaS acceptable (SOC 2)', score: 0, value: 'D1', tier: 'D1' },
          { text: 'Dedicated environment needed (SOC 2, GDPR)', score: 0, value: 'D2', tier: 'D2' },
          { text: 'Private cloud required (PCI, HIPAA)', score: 0, value: 'D3', tier: 'D3' },
          { text: 'Self-hosted/on-premises (FedRAMP, Defense)', score: 0, value: 'D4', tier: 'D4' },
          { text: 'Unknown - need to validate', score: 0, value: 'unknown', tier: 'D1' }
        ]
      }
    ];

    let currentQuestionIndex = 0;
    let answers = {};
    let deploymentTier = 'D1';
    let recommendedPath = 'J1';
    let pendingResults = null;
    let selectedIndustry = 'Cross-industry';

    const journeyDetails = {
      J1: {
        name: 'Foundation Tier',
        shortName: 'Foundation',
        color: 'slate',
        description: 'For organizations without a system of record. Build before governing.',
        focus: 'Establish a system of record and baseline governance so AI can safely act later.',
        outcome: 'Moves from fragmented delivery to a governed foundation that can scale.',
        accounts: ['Early-stage design system orgs', 'No engineering ownership yet']
      },
      J2: {
        name: 'Momentum Tier',
        shortName: 'Momentum',
        color: 'blue',
        description: 'For mature orgs with a time‑bound trigger. Fast enablement with minimal disruption.',
        focus: 'Compress time-to-value with a focused enablement sprint during a trigger window.',
        outcome: 'Unlocks near-term launch goals without trading away governance.',
        accounts: ['Adobe-profile accounts', 'Enterprise rollout triggers']
      },
      J3: {
        name: 'Scale Tier',
        shortName: 'Scale',
        color: 'emerald',
        description: 'For high-value orgs blocked on adoption. Full transformation.',
        focus: 'Turn an implemented system into a governed control plane with decision authority.',
        outcome: 'Unlocks the largest gains in delivery speed and consistency.',
        accounts: ['PNC', 'Edward Jones', 'DoubleVerify', 'Qualcomm', 'GSK US']
      },
      J4: {
        name: 'Intelligence Tier',
        shortName: 'Intelligence',
        color: 'violet',
        description: 'For implemented accounts ready for AI enablement. Expansion-focused.',
        focus: 'Enable AI workflows so teams ship with governed context and production guardrails.',
        outcome: 'Moves from AI assistance to safe, repeatable AI execution.',
        accounts: ['The Home Depot', 'CSX', 'GSK Global', 'Crown Equipment']
      }
    };


    function trackEvent(name, payload = {}) {
      const data = { event: name, ...payload, timestamp: new Date().toISOString() };
      if (window.dataLayer && typeof window.dataLayer.push === 'function') {
        window.dataLayer.push(data);
      } else if (window.gtag) {
        window.gtag('event', name, payload);
      } else if (window.analytics && typeof window.analytics.track === 'function') {
        window.analytics.track(name, payload);
      } else {
        console.info('trackEvent', data);
      }
    }


    function renderQuestion() {
      if (currentQuestionIndex >= questions.length) {
        calculateResults();
        return;
      }

      const question = questions[currentQuestionIndex];
      trackEvent('question_view', { index: currentQuestionIndex, category: question.category, total: questions.length });
      const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
      
      document.getElementById('progress-text').textContent = `${Math.round(progress)}%`;
      document.getElementById('progress-bar').style.width = `${progress}%`;

      const categoryColors = {
        'Product System Foundation': 'emerald',
        'AI & Automation Readiness': 'violet',
        'Organizational Readiness': 'blue',
        'Delivery & Culture': 'slate',
        'Deployment': 'amber'
      };

      const color = categoryColors[question.category] || 'slate';

      const colorMap = {
        'emerald': { bg: 'rgba(16, 185, 129, 0.15)', border: 'rgba(16, 185, 129, 0.3)', text: '#10b981' },
        'violet': { bg: 'rgba(100, 54, 191, 0.15)', border: 'rgba(100, 54, 191, 0.3)', text: '#a78bfa' },
        'blue': { bg: 'rgba(59, 130, 246, 0.15)', border: 'rgba(59, 130, 246, 0.3)', text: '#3b82f6' },
        'amber': { bg: 'rgba(251, 191, 36, 0.15)', border: 'rgba(251, 191, 36, 0.3)', text: '#fbbf24' },
        'slate': { bg: 'rgba(255,255,255,0.05)', border: 'rgba(255,255,255,0.1)', text: '#fff' }
      };
      const colorStyle = colorMap[color] || colorMap.slate;

      const optionsHtml = question.options.map((opt, idx) => {
        const isMultiSelect = question.category === 'Deployment';
        const selectedValues = Array.isArray(answers[currentQuestionIndex]) ? answers[currentQuestionIndex] : [];
        const isSelected = isMultiSelect ? selectedValues.includes(opt.value) : answers[currentQuestionIndex] === opt.value;
        return `
          <button
            onclick="${isMultiSelect ? `toggleMultiOption(${idx})` : `selectOption(${idx})`}"
            class="option-card"
            style="width: 100%; text-align: left; padding: 16px; border-radius: 8px; border: 2px solid ${isSelected ? '#6436bf' : 'rgba(100, 54, 191, 0.3)'}; background: ${isSelected ? 'rgba(100, 54, 191, 0.15)' : 'rgba(255,255,255,0.03)'}; margin-bottom: 12px; cursor: pointer;"
          >
            <div style="display: flex; align-items: center; justify-content: space-between; gap: 12px;">
              <span style="font-size: 0.875rem; font-weight: 500; color: rgba(255,255,255,0.8);">${opt.text}</span>
              ${isSelected ? '<i data-lucide="check-circle" style="width: 20px; height: 20px; color: #6436bf;"></i>' : ''}
            </div>
          </button>
        `;
      }).join('');

      document.getElementById('question-container').innerHTML = `
        <div class="card fade-in">
          <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px;">
            <span style="padding: 4px 12px; background: ${colorStyle.bg}; color: ${colorStyle.text}; border-radius: 8px; font-size: 0.75rem; font-weight: 600;">
              ${question.category}
            </span>
            ${question.weight > 0 ? `<span style="font-size: 0.75rem; color: rgba(255,255,255,0.5);">${question.weight} points max</span>` : ''}
          </div>
          <h2 style="font-size: 1.125rem; font-weight: 600; color: #fff; margin-bottom: 8px;">${question.question}</h2>
          ${question.helper ? `<p class="question-helper">${question.helper}</p>` : ''}
          <div class="question-instruction">${question.category === 'Deployment' ? 'Select all that apply' : 'Select one'}</div>
          <div style="display: flex; flex-direction: column; gap: 12px;">${optionsHtml}</div>
          ${question.category === 'Deployment' ? `
            <button
              onclick="advanceFromMultiSelect()"
              class="btn-primary"
              style="margin-top: 16px; display: inline-flex; align-items: center; gap: 8px;"
            >
              Continue
              <i data-lucide="arrow-right" style="width: 16px; height: 16px;"></i>
            </button>
          ` : ''}
          ${currentQuestionIndex > 0 ? `
            <button
              onclick="goBack()"
              style="margin-top: 16px; font-size: 0.875rem; color: rgba(255,255,255,0.5); display: flex; align-items: center; gap: 4px; background: none; border: none; cursor: pointer;"
            >
              <i data-lucide="arrow-left" style="width: 16px; height: 16px;"></i> Previous question
            </button>
          ` : ''}
        </div>
      `;

      lucide.createIcons();
    }

    function selectOption(index) {
      const question = questions[currentQuestionIndex];
      const option = question.options[index];
      
      answers[currentQuestionIndex] = option.value;
      trackEvent('option_select', { index: currentQuestionIndex, category: question.category, value: option.value });
      
      if (option.tier) {
        deploymentTier = option.tier;
      }
      
      currentQuestionIndex++;
      setTimeout(() => renderQuestion(), 300);
    }

    function toggleMultiOption(index) {
      const question = questions[currentQuestionIndex];
      const option = question.options[index];
      const selectedValues = Array.isArray(answers[currentQuestionIndex]) ? [...answers[currentQuestionIndex]] : [];
      const existingIndex = selectedValues.indexOf(option.value);

      if (existingIndex >= 0) {
        selectedValues.splice(existingIndex, 1);
      } else {
        selectedValues.push(option.value);
      }

      trackEvent('option_toggle', { index: currentQuestionIndex, category: question.category, value: option.value, selected: existingIndex < 0 });
      answers[currentQuestionIndex] = selectedValues;
      renderQuestion();
    }

    function advanceFromMultiSelect() {
      const question = questions[currentQuestionIndex];
      const selectedValues = Array.isArray(answers[currentQuestionIndex]) ? answers[currentQuestionIndex] : [];
      const tierPriority = { D1: 1, D2: 2, D3: 3, D4: 4 };

      if (selectedValues.length === 0) {
        answers[currentQuestionIndex] = ['unknown'];
        deploymentTier = 'D1';
      } else {
        const selectedOptions = question.options.filter(opt => selectedValues.includes(opt.value));
        const highestTier = selectedOptions.reduce((highest, opt) => {
          if (!opt.tier) return highest;
          if (!highest) return opt.tier;
          return tierPriority[opt.tier] > tierPriority[highest] ? opt.tier : highest;
        }, null);
        deploymentTier = highestTier || 'D1';
      }

      currentQuestionIndex++;
      trackEvent('multi_select_continue', { index: currentQuestionIndex - 1, category: question.category, selected: selectedValues });
      setTimeout(() => renderQuestion(), 300);
    }

    function goBack() {
      if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
        delete answers[currentQuestionIndex];
        renderQuestion();
      }
    }

    function calculateResults() {
      let foundationScore = 0;
      let aiScore = 0;
      let orgScore = 0;

      questions.forEach((q, idx) => {
        if (q.category === 'Deployment') return;
        
        const answerValue = answers[idx];
        const selectedOption = q.options.find(opt => opt.value === answerValue);
        
        if (selectedOption) {
          if (q.category === 'Product System Foundation') {
            foundationScore += selectedOption.score;
          } else if (q.category === 'AI & Automation Readiness') {
            aiScore += selectedOption.score;
          } else if (q.category === 'Organizational Readiness') {
            orgScore += selectedOption.score;
          }
        }
      });

      const totalScore = foundationScore + aiScore + orgScore;

      // Determine Investment Path
      recommendedPath = 'J1';
      
      if (totalScore >= 70 && foundationScore >= 25 && orgScore >= 20) {
        recommendedPath = 'J4';
      } else if (totalScore >= 40 && foundationScore >= 15 && orgScore >= 15) {
        recommendedPath = 'J3';
      } else if (totalScore >= 50 && orgScore >= 20) {
        recommendedPath = 'J2';
      } else {
        recommendedPath = 'J1';
      }

      // Display lead form before results
      pendingResults = { foundationScore, aiScore, orgScore, totalScore };
      trackEvent('assessment_complete', { foundationScore, aiScore, orgScore, totalScore, recommendedPath, deploymentTier });
      document.getElementById('assessment-container').style.display = 'none';
      document.getElementById('results-container').style.display = 'block';
      document.getElementById('lead-form-container').style.display = 'block';
      document.getElementById('results-content').style.display = 'none';
      renderResultsPreview(pendingResults);
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function renderResults(results) {
      if (!results) return;

      const { foundationScore, aiScore, orgScore, totalScore } = results;
      const journey = journeyDetails[recommendedPath];

      document.getElementById('lead-form-container').style.display = 'none';
      document.getElementById('results-content').style.display = 'block';
      trackEvent('results_reveal', { totalScore, recommendedPath, deploymentTier });
      
      document.getElementById('overall-score').textContent = totalScore;
      document.getElementById('readiness-tier').textContent = journey.shortName;
      const benchmarkData = generateBenchmarkComparison(totalScore, foundationScore, aiScore, orgScore, recommendedPath, selectedIndustry);
      document.getElementById('benchmark-label').textContent = `Benchmark ${getBenchmarkLabel(totalScore, benchmarkData)}`;
      document.getElementById('foundation-score').textContent = foundationScore;
      document.getElementById('ai-score').textContent = aiScore;
      document.getElementById('org-score').textContent = orgScore;
      document.getElementById('tier-outcome').textContent = getTierOutcome(recommendedPath);
      document.getElementById('mcp-readiness').textContent = getMcpReadinessStatus(foundationScore, aiScore);

      const journeyColorMap = {
        'slate': { bg: 'rgba(255,255,255,0.05)', border: 'rgba(255,255,255,0.1)', text: '#fff', badge: '#64748b' },
        'blue': { bg: 'rgba(59, 130, 246, 0.15)', border: 'rgba(59, 130, 246, 0.3)', text: '#93c5fd', badge: '#3b82f6' },
        'emerald': { bg: 'rgba(16, 185, 129, 0.15)', border: 'rgba(16, 185, 129, 0.3)', text: '#6ee7b7', badge: '#10b981' },
        'violet': { bg: 'rgba(100, 54, 191, 0.15)', border: 'rgba(100, 54, 191, 0.3)', text: '#c4b5fd', badge: '#6436bf' }
      };
      const journeyColor = journeyColorMap[journey.color] || journeyColorMap.slate;

      // Investment Focus Recommendation
      document.getElementById('path-recommendation').innerHTML = `
        <div style="background: ${journeyColor.bg}; border: 2px solid ${journeyColor.border}; border-radius: 12px; padding: 20px;">
          <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 16px;">
            <div style="width: 64px; height: 64px; border-radius: 8px; background: ${journeyColor.badge}; display: flex; align-items: center; justify-content: center; color: #fff; font-weight: 700; font-size: 0.85rem; text-align: center; padding: 4px;">
              ${journey.shortName}
            </div>
            <div style="flex: 1;">
              <h4 style="font-size: 1.25rem; font-weight: 700; color: #fff;">${journey.name}</h4>
              <p style="font-size: 0.875rem; color: ${journeyColor.text};">${journey.description}</p>
            </div>
          </div>
          <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 16px;">
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-bottom: 4px;">Why This Focus</p>
              <p style="font-weight: 600; color: #fff;">${journey.focus}</p>
            </div>
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-bottom: 4px;">Expected Outcome</p>
              <p style="font-weight: 600; color: #fff;">${journey.outcome}</p>
            </div>
          </div>
        </div>
      `;


      // Narrative Summary
      document.getElementById('narrative-summary').innerHTML = `
        <h3 style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px;">
          <i data-lucide="message-circle" style="width: 20px; height: 20px; color: #a78bfa;"></i>
          What This Means for You
        </h3>
        <div class="content-box">
          <p style="font-size: 0.9rem; color: rgba(255,255,255,0.85);">
            ${generateNarrativeSummary(foundationScore, aiScore, orgScore, totalScore, recommendedPath)}
          </p>
        </div>
      `;

      // Product Leadership POV
      const pov = getLeadershipPov(foundationScore, aiScore, orgScore, recommendedPath);
      document.getElementById('leadership-pov').innerHTML = `
        <h3 style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px;">
          <i data-lucide="sparkles" style="width: 20px; height: 20px; color: #60a5fa;"></i>
          What Top Teams Do Next
        </h3>
        <div class="content-box" style="margin-bottom: 12px;">
          <p style="font-size: 0.9rem; color: rgba(255,255,255,0.85);">${pov.summary}</p>
        </div>
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
          ${pov.bullets.map(item => `
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6); margin-bottom: 6px;">${item.title}</p>
              <p style="font-weight: 700; color: #fff;">${item.text}</p>
            </div>
          `).join('')}
        </div>
        <div style="margin-top: 12px; background: rgba(59, 130, 246, 0.15); border-radius: 8px; padding: 10px; border: 1px solid rgba(59, 130, 246, 0.35);">
          <p style="font-size: 0.8rem; color: #bfdbfe;">${pov.emphasis}</p>
        </div>
      `;

      // Breakdown Details
      document.getElementById('breakdown-details').innerHTML = `
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;">
          <div style="background: rgba(16, 185, 129, 0.15); border-radius: 12px; padding: 16px; border: 1px solid rgba(16, 185, 129, 0.3);">
            <h4 style="font-weight: 600; color: #6ee7b7; margin-bottom: 8px;">Product System Foundation</h4>
            <p style="font-size: 1.5rem; font-weight: 700; color: #6ee7b7; margin-bottom: 4px;">${foundationScore}/40</p>
            <div style="height: 8px; background: rgba(16, 185, 129, 0.2); border-radius: 9999px; overflow: hidden; margin-top: 8px;">
              <div style="height: 100%; background: #10b981; width: ${(foundationScore/40)*100}%"></div>
            </div>
            <p style="font-size: 0.75rem; color: #6ee7b7; margin-top: 8px;">${foundationScore >= 30 ? 'Strong foundation' : foundationScore >= 15 ? 'Moderate foundation' : 'Foundation needed'}</p>
          </div>
          <div style="background: rgba(100, 54, 191, 0.15); border-radius: 12px; padding: 16px; border: 1px solid rgba(100, 54, 191, 0.3);">
            <h4 style="font-weight: 600; color: #c4b5fd; margin-bottom: 8px;">AI & Automation Readiness</h4>
            <p style="font-size: 1.5rem; font-weight: 700; color: #c4b5fd; margin-bottom: 4px;">${aiScore}/30</p>
            <div style="height: 8px; background: rgba(100, 54, 191, 0.2); border-radius: 9999px; overflow: hidden; margin-top: 8px;">
              <div style="height: 100%; background: #6436bf; width: ${(aiScore/30)*100}%"></div>
            </div>
            <p style="font-size: 0.75rem; color: #c4b5fd; margin-top: 8px;">${aiScore >= 20 ? 'AI-ready' : aiScore >= 10 ? 'Moderate readiness' : 'AI prep needed'}</p>
          </div>
          <div style="background: rgba(59, 130, 246, 0.15); border-radius: 12px; padding: 16px; border: 1px solid rgba(59, 130, 246, 0.3);">
            <h4 style="font-weight: 600; color: #93c5fd; margin-bottom: 8px;">Organizational Readiness</h4>
            <p style="font-size: 1.5rem; font-weight: 700; color: #93c5fd; margin-bottom: 4px;">${orgScore}/30</p>
            <div style="height: 8px; background: rgba(59, 130, 246, 0.2); border-radius: 9999px; overflow: hidden; margin-top: 8px;">
              <div style="height: 100%; background: #3b82f6; width: ${(orgScore/30)*100}%"></div>
            </div>
            <p style="font-size: 0.75rem; color: #93c5fd; margin-top: 8px;">${orgScore >= 20 ? 'Strong org readiness' : orgScore >= 10 ? 'Moderate readiness' : 'Org prep needed'}</p>
          </div>
        </div>
      `;

      // Benchmark Comparison
      
      const benchmarkStory = getBenchmarkStory(foundationScore, aiScore, orgScore);
      const nextBestInvestment = getNextBestInvestment(foundationScore, aiScore, orgScore, recommendedPath);
      document.getElementById('benchmark-comparison').innerHTML = `
        <h3 style="font-size: 1.125rem; font-weight: 700; color: #fff; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
          <i data-lucide="trending-up" style="width: 20px; height: 20px; color: #3b82f6;"></i>
          How You Compare to Similar Organizations
        </h3>
        <div class="content-box" style="margin-bottom: 16px;">
          <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6); margin-bottom: 6px;">Industry benchmark: ${benchmarkData.industryLabel}</p>
          <p style="font-size: 0.875rem; color: rgba(255,255,255,0.85); margin-bottom: 8px;">${benchmarkStory}</p>
          <p style="font-size: 0.875rem; font-weight: 600; color: #e0d4f7;">Most valuable next step: ${nextBestInvestment}</p>
          <p style="font-size: 0.7rem; color: rgba(255,255,255,0.55); margin-top: 8px;">Benchmarks calibrated from 158 enterprise records (Jan 2026).</p>
        </div>
        <div style="display: flex; flex-direction: column; gap: 16px;">
          <div style="background: rgba(59, 130, 246, 0.15); border-radius: 12px; padding: 16px; border: 1px solid rgba(59, 130, 246, 0.3);">
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
              <p style="font-weight: 600; color: #93c5fd;">Your Overall Score</p>
              <p style="font-size: 1.5rem; font-weight: 700; color: #93c5fd;">${totalScore}/100</p>
            </div>
            <div style="display: flex; flex-direction: column; gap: 8px;">
              <div style="display: flex; align-items: center; justify-content: space-between; font-size: 0.875rem;">
                <span style="color: rgba(255,255,255,0.6);">Industry Average</span>
                <span style="font-weight: 500; color: rgba(255,255,255,0.8);">${benchmarkData.industryAvg}/100</span>
              </div>
              <div style="height: 8px; background: rgba(59, 130, 246, 0.2); border-radius: 9999px; overflow: hidden;">
                <div style="height: 100%; background: #60a5fa; width: ${benchmarkData.industryAvg}%"></div>
              </div>
              <div style="display: flex; align-items: center; justify-content: space-between; font-size: 0.875rem;">
                <span style="color: rgba(255,255,255,0.6);">Top Quartile</span>
                <span style="font-weight: 500; color: rgba(255,255,255,0.8);">${benchmarkData.topQuartile}/100</span>
              </div>
              <div style="height: 8px; background: rgba(59, 130, 246, 0.2); border-radius: 9999px; overflow: hidden;">
                <div style="height: 100%; background: #3b82f6; width: ${benchmarkData.topQuartile}%"></div>
              </div>
            </div>
            <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(59, 130, 246, 0.3);">
              <p style="font-size: 0.75rem; color: #93c5fd;">
                <span style="font-weight: 600;">${benchmarkData.comparison}</span> ${benchmarkData.comparisonDetail}
              </p>
            </div>
          </div>
          <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-bottom: 4px;">Foundation</p>
              <p style="font-size: 0.875rem; font-weight: 600; color: #fff;">${foundationScore >= 30 ? 'Top 25%' : foundationScore >= 20 ? 'Top 50%' : foundationScore >= 10 ? 'Bottom 50%' : 'Bottom 25%'}</p>
            </div>
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-bottom: 4px;">AI Readiness</p>
              <p style="font-size: 0.875rem; font-weight: 600; color: #fff;">${aiScore >= 20 ? 'Top 25%' : aiScore >= 10 ? 'Top 50%' : aiScore >= 5 ? 'Bottom 50%' : 'Bottom 25%'}</p>
            </div>
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-bottom: 4px;">Org Readiness</p>
              <p style="font-size: 0.875rem; font-weight: 600; color: #fff;">${orgScore >= 20 ? 'Top 25%' : orgScore >= 10 ? 'Top 50%' : orgScore >= 5 ? 'Bottom 50%' : 'Bottom 25%'}</p>
            </div>
          </div>
          <div class="content-box">
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">
              <span style="font-weight: 600;">Based on analysis of 50+ enterprise organizations</span> including PNC, Edward Jones, The Home Depot, CSX, and others across Financial Services, Retail, Technology, and Healthcare industries.
            </p>
          </div>
        </div>
      `;

      const foundationPosition = getPeerPosition(foundationScore, 40);
      const aiPosition = getPeerPosition(aiScore, 30);
      const orgPosition = getPeerPosition(orgScore, 30);
      const pointsToTopQuartile = Math.max(0, Math.round(benchmarkData.topQuartile - totalScore));
      document.getElementById('benchmark-visuals').innerHTML = `
        <h3 style="font-size: 1.125rem; font-weight: 700; color: #fff; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
          <i data-lucide="activity" style="width: 20px; height: 20px; color: #a78bfa;"></i>
          Benchmark Visualization
        </h3>
        <div class="content-box" style="margin-bottom: 16px;">
          <p style="font-size: 0.85rem; color: rgba(255,255,255,0.85); margin-bottom: 10px;">Distance to AI-ready production</p>
          <div style="position: relative; height: 10px; background: rgba(255,255,255,0.1); border-radius: 9999px; overflow: hidden;">
            <div style="height: 100%; width: ${totalScore}%; background: linear-gradient(90deg, #6436bf 0%, #a78bfa 100%);"></div>
            <div style="position: absolute; left: ${benchmarkData.industryAvg}%; top: -4px; width: 2px; height: 18px; background: #60a5fa;"></div>
            <div style="position: absolute; left: ${benchmarkData.topQuartile}%; top: -4px; width: 2px; height: 18px; background: #3b82f6;"></div>
          </div>
          <div style="display: flex; justify-content: space-between; font-size: 0.75rem; color: rgba(255,255,255,0.6); margin-top: 8px;">
            <span>Your score: ${totalScore}</span>
            <span>Industry avg: ${benchmarkData.industryAvg}</span>
            <span>Top quartile: ${benchmarkData.topQuartile}</span>
          </div>
          <p style="font-size: 0.75rem; color: rgba(255,255,255,0.7); margin-top: 8px;">
            ${pointsToTopQuartile} points to top-quartile readiness.
          </p>
        </div>
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
          ${[
            { label: 'Foundation', position: foundationPosition },
            { label: 'AI Context', position: aiPosition },
            { label: 'Org Alignment', position: orgPosition }
          ].map(item => `
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6); margin-bottom: 6px;">${item.label}</p>
              <div style="height: 6px; background: rgba(255,255,255,0.1); border-radius: 9999px; overflow: hidden; margin-bottom: 6px;">
                <div style="height: 100%; width: ${item.position.percent}%; background: #a78bfa;"></div>
              </div>
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.8);">${item.position.label}</p>
            </div>
          `).join('')}
        </div>
      `;

      // ROI Business Case
      const roiCase = getRoiBusinessCase(recommendedPath);
      document.getElementById('roi-business-case').innerHTML = `
        <h3 style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px; color: #fff;">
          <i data-lucide="trending-up" style="width: 20px; height: 20px; color: #34d399;"></i>
          Intelligent Product Engine Value Case
        </h3>
        <div class="content-box" style="margin-bottom: 16px;">
          <p style="font-size: 0.875rem; color: rgba(255,255,255,0.9); margin-bottom: 6px;">${roiCase.summary}</p>
          <p style="font-size: 0.75rem; color: rgba(255,255,255,0.65);">${roiCase.assumption}</p>
        </div>
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 16px;">
          <div class="content-box">
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6); margin-bottom: 4px;">Value Potential</p>
            <p style="font-size: 1.4rem; font-weight: 700; color: #fff;">${roiCase.annual}</p>
          </div>
          <div class="content-box">
            <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6); margin-bottom: 4px;">Impact Horizon</p>
            <p style="font-size: 1.4rem; font-weight: 700; color: #fff;">${roiCase.threeYear}</p>
          </div>
        </div>
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
          ${roiCase.drivers.map(driver => `
            <div class="content-box">
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6); margin-bottom: 4px;">${driver.title}</p>
              <p style="font-size: 0.85rem; color: rgba(255,255,255,0.85);">${driver.desc}</p>
            </div>
          `).join('')}
        </div>
        <div style="margin-top: 16px; display: flex; gap: 12px; flex-wrap: wrap;">
          <a href="https://knapsack.cloud/roi" target="_blank" rel="noopener noreferrer" style="background: #fff; color: #059669; padding: 10px 16px; border-radius: 8px; font-weight: 600; text-decoration: none;">
            Open ROI Calculator
          </a>
          <span style="font-size: 0.75rem; color: rgba(255,255,255,0.6); align-self: center;">Use the calculator to tailor this estimate for your org.</span>
        </div>
      `;


      // Next Steps
      const nextSteps = [];
      
      if (recommendedPath === 'J1') {
        nextSteps.push(
          'Schedule a readiness review to establish your baseline',
          'Align ownership and decision rights for the product system',
          'Inventory core components, tokens, and usage patterns',
          'Define governance standards before scaling adoption'
        );
      } else if (recommendedPath === 'J2') {
        nextSteps.push(
          'Confirm trigger event and urgency timeline',
          'Run a rapid enablement sprint for priority workflows',
          'Compress timeline with a focus on speed and clarity',
          'Standardize the highest‑impact experiences first'
        );
      } else if (recommendedPath === 'J3') {
        nextSteps.push(
          'Run a readiness review and quantify adoption gaps',
          'Tighten governance rules and decision flow',
          'Drive adoption across priority teams and products',
          'Measure usage and quality signals every release'
        );
      } else if (recommendedPath === 'J4') {
        nextSteps.push(
          'Identify AI workflows to pilot with governed context',
          'Ensure rules and metadata are production‑ready',
          'Expand AI‑assisted delivery to more teams',
          'Measure impact and iterate on governance'
        );
      }

      document.getElementById('next-steps').innerHTML = nextSteps.filter(s => s).map((step, idx) => `
        <div style="display: flex; align-items: flex-start; gap: 12px; padding: 12px; background: rgba(255,255,255,0.03); border-radius: 8px; border: 1px solid rgba(100, 54, 191, 0.3); margin-bottom: 12px;">
          <div style="width: 24px; height: 24px; border-radius: 50%; background: #6436bf; color: #fff; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: 700; flex-shrink: 0;">${idx + 1}</div>
          <p style="font-size: 0.875rem; color: rgba(255,255,255,0.9);">${step}</p>
        </div>
      `).join('');

      // Personalized Insights
      const insights = generatePersonalizedInsights(foundationScore, aiScore, orgScore, totalScore, recommendedPath);
      if (insights.length > 0) {
        const insightColorMap = {
          'emerald': { bg: 'rgba(16, 185, 129, 0.15)', border: 'rgba(16, 185, 129, 0.3)', text: '#6ee7b7', badge: '#10b981' },
          'violet': { bg: 'rgba(100, 54, 191, 0.15)', border: 'rgba(100, 54, 191, 0.3)', text: '#c4b5fd', badge: '#6436bf' },
          'blue': { bg: 'rgba(59, 130, 246, 0.15)', border: 'rgba(59, 130, 246, 0.3)', text: '#93c5fd', badge: '#3b82f6' },
          'amber': { bg: 'rgba(251, 191, 36, 0.15)', border: 'rgba(251, 191, 36, 0.3)', text: '#fde047', badge: '#fbbf24' }
        };
        document.getElementById('personalized-insights').innerHTML = `
          <h3 style="font-size: 1.125rem; font-weight: 700; color: #fff; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
            <i data-lucide="lightbulb" style="width: 20px; height: 20px; color: #fbbf24;"></i>
            Personalized Insights for Your Organization
          </h3>
          <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px;">
            ${insights.map(insight => {
              const colors = insightColorMap[insight.color] || insightColorMap.emerald;
              return `
              <div style="background: ${colors.bg}; border-radius: 12px; padding: 16px; border: 1px solid ${colors.border};">
                <div style="display: flex; align-items: flex-start; gap: 12px; margin-bottom: 12px;">
                  <div style="width: 40px; height: 40px; border-radius: 8px; background: ${colors.badge}; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                    <i data-lucide="${insight.icon}" style="width: 20px; height: 20px; color: #fff;"></i>
                  </div>
                  <div style="flex: 1;">
                    <h4 style="font-weight: 600; color: #fff; margin-bottom: 4px;">${insight.title}</h4>
                    <p style="font-size: 0.875rem; color: ${colors.text}; margin-bottom: 8px;">${insight.text}</p>
                    <div style="background: rgba(255,255,255,0.05); border-radius: 8px; padding: 8px; border: 1px solid ${colors.border};">
                      <p style="font-size: 0.75rem; font-weight: 600; color: ${colors.text}; margin-bottom: 4px;">Value Insight</p>
                      <p style="font-size: 0.75rem; color: ${colors.text};">${insight.value}</p>
                    </div>
                  </div>
                </div>
              </div>
            `;
            }).join('')}
          </div>
        `;
      } else {
        document.getElementById('personalized-insights').innerHTML = '';
      }

      // Cost of Inaction
      const inactionCosts = generateCostOfInaction(foundationScore, aiScore, orgScore, totalScore, recommendedPath);
      document.getElementById('cost-of-inaction').innerHTML = `
        <h3 style="font-size: 1.125rem; font-weight: 700; color: #fff; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
          <i data-lucide="alert-triangle" style="width: 20px; height: 20px; color: #f87171;"></i>
          What Delays Cost in AI-Assisted Delivery
        </h3>
        <p style="font-size: 0.875rem; color: rgba(255,255,255,0.8); margin-bottom: 16px;">Based on your assessment, here's what happens if you delay IPE activation:</p>
        <div style="display: flex; flex-direction: column; gap: 12px;">
          ${inactionCosts.map(cost => `
            <div style="background: rgba(255,255,255,0.03); border-radius: 12px; padding: 16px; border: 1px solid rgba(228, 58, 92, 0.3);">
              <div style="display: flex; align-items: flex-start; gap: 12px;">
                <div style="width: 32px; height: 32px; border-radius: 8px; background: #e43a5c; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                  <i data-lucide="${cost.icon}" style="width: 16px; height: 16px; color: #fff;"></i>
                </div>
                <div style="flex: 1;">
                  <h4 style="font-weight: 600; color: #fff; margin-bottom: 4px;">${cost.title}</h4>
                  <p style="font-size: 0.875rem; color: rgba(255,255,255,0.8);">${cost.description}</p>
                  ${cost.impact ? `<p style="font-size: 0.75rem; font-weight: 600; color: #f87171; margin-top: 8px;">Impact: ${cost.impact}</p>` : ''}
                </div>
              </div>
            </div>
          `).join('')}
        </div>
        <div style="margin-top: 16px; background: rgba(228, 58, 92, 0.15); border-radius: 12px; padding: 16px; border: 1px solid rgba(228, 58, 92, 0.3);">
          <p style="font-size: 0.875rem; font-weight: 600; color: #fff; margin-bottom: 4px;">The Opportunity Cost</p>
          <p style="font-size: 0.875rem; color: rgba(255,255,255,0.8);">${getOpportunityCostMessage(recommendedPath, totalScore)} Organizations that act now see measurable improvements within 8-12 weeks.</p>
        </div>
      `;

      lucide.createIcons();
    }

    function startAssessment() {
      document.getElementById('intro-container').style.display = 'none';
      document.getElementById('assessment-container').style.display = 'block';
      trackEvent('assessment_start');
      renderQuestion();
    }

    function resetAssessment() {
      currentQuestionIndex = 0;
      answers = {};
      deploymentTier = 'D1';
      pendingResults = null;
      document.getElementById('intro-container').style.display = 'block';
      document.getElementById('assessment-container').style.display = 'none';
      document.getElementById('results-container').style.display = 'none';
      document.getElementById('lead-form-container').style.display = 'block';
      document.getElementById('results-content').style.display = 'none';
      const leadForm = document.getElementById('lead-form');
      if (leadForm) {
        leadForm.reset();
      }
      // Scroll to top
      trackEvent('assessment_reset');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function submitLeadForm(event) {
      event.preventDefault();
      const form = event.target;
      if (!form.reportValidity()) return;
      const industryInput = form.elements.namedItem('industry');
      const companySize = form.elements.namedItem('companySize');
      const regulatoryEnv = form.elements.namedItem('regulatoryEnv');
      const roleInput = form.elements.namedItem('role');
      if (industryInput && industryInput.value) {
        selectedIndustry = industryInput.value;
      }
      trackEvent('lead_form_submit', {
        industry: industryInput && industryInput.value ? industryInput.value : 'Unknown',
        companySize: companySize && companySize.value ? companySize.value : 'Unknown',
        regulatoryEnv: regulatoryEnv && regulatoryEnv.value ? regulatoryEnv.value : 'Unknown',
        role: roleInput && roleInput.value ? roleInput.value : 'Unknown'
      });
      renderResults(pendingResults);
    }

    function downloadResults() {
      trackEvent('cta_download_results');
      const results = {
        overallScore: document.getElementById('overall-score').textContent,
        foundationScore: document.getElementById('foundation-score').textContent,
        aiScore: document.getElementById('ai-score').textContent,
        orgScore: document.getElementById('org-score').textContent,
        deploymentTier: deploymentTier,
        recommendedPath: recommendedPath,
        industry: selectedIndustry,
        timestamp: new Date().toISOString()
      };
      
      const blob = new Blob([JSON.stringify(results, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `ipe-assessment-results-${new Date().toISOString().split('T')[0]}.json`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function buildResultsSummary() {
      const totalScore = document.getElementById('overall-score')?.textContent || '—';
      const tier = document.getElementById('readiness-tier')?.textContent || '—';
      const benchmark = document.getElementById('benchmark-label')?.textContent || 'Benchmark —';
      return `IPE Readiness Summary\nTier: ${tier}\n${benchmark}\nScore: ${totalScore}/100\nDeployment: ${deploymentTier}\nIndustry: ${selectedIndustry}`;
    }

    function emailResults() {
      trackEvent('cta_email_results');
      const subject = encodeURIComponent('My IPE Assessment Results');
      const body = encodeURIComponent(buildResultsSummary());
      window.location.href = `mailto:?subject=${subject}&body=${body}`;
    }

    function copyResultsSummary() {
      const summary = buildResultsSummary();
      trackEvent('cta_copy_summary');
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(summary);
      } else {
        const temp = document.createElement('textarea');
        temp.value = summary;
        document.body.appendChild(temp);
        temp.select();
        document.execCommand('copy');
        document.body.removeChild(temp);
      }
    }

    function renderResultsPreview(results) {
      const preview = document.getElementById('results-preview');
      if (!preview || !results) return;
      const journey = journeyDetails[recommendedPath];
      const benchmarkData = generateBenchmarkComparison(results.totalScore, results.foundationScore, results.aiScore, results.orgScore, recommendedPath, selectedIndustry);
      preview.innerHTML = `
        <p style="font-size: 0.8rem; color: rgba(255,255,255,0.6); margin-bottom: 6px;">Preview your results</p>
        <div style="display: flex; flex-wrap: wrap; gap: 10px; align-items: center;">
          <span style="font-weight: 700; color: #fff;">${journey.shortName}</span>
          <span style="font-size: 0.75rem; color: rgba(255,255,255,0.7);">Score ${results.totalScore}/100</span>
          <span style="font-size: 0.75rem; color: rgba(255,255,255,0.7);">Benchmark ${getBenchmarkLabel(results.totalScore, benchmarkData)}</span>
        </div>
        <p style="font-size: 0.75rem; color: rgba(255,255,255,0.55); margin-top: 6px;">Submit details to reveal the full breakdown and roadmap.</p>
      `;
    }

    function generatePersonalizedInsights(foundationScore, aiScore, orgScore, totalScore, recommendedPath) {
      const insights = [];
      
      // Foundation insights
      if (foundationScore < 15) {
        insights.push({
          type: 'foundation',
          icon: 'building',
          color: 'emerald',
          title: 'Foundation Building Opportunity',
          text: 'Your design system foundation needs strengthening. This is actually an advantage—you can build governance in from the start rather than retrofitting it later.',
          value: 'Organizations that build governance early see 3x faster activation timelines.'
        });
      } else if (foundationScore >= 30) {
        insights.push({
          type: 'foundation',
          icon: 'check-circle',
          color: 'emerald',
          title: 'Strong Foundation Detected',
          text: 'Your mature design system positions you well for rapid IPE activation. The Control Plane can leverage your existing system immediately.',
          value: 'Mature design systems typically see ROI within 8-12 weeks of IPE activation.'
        });
      }

      // AI readiness insights
      if (aiScore < 10) {
        insights.push({
          type: 'ai',
          icon: 'sparkles',
          color: 'violet',
          title: 'AI Adoption Window',
          text: 'Low AI tool adoption suggests your organization is early in the AI journey. IPE can help establish best practices from the start.',
          value: 'Early AI governance prevents technical debt that costs 2-3x more to fix later.'
        });
      } else if (aiScore >= 20) {
        insights.push({
          type: 'ai',
          icon: 'zap',
          color: 'violet',
          title: 'AI-Ready Organization',
          text: 'Your teams are already using AI tools. IPE\'s Control Plane will help ensure AI-generated code aligns with your design system standards.',
          value: 'Organizations with AI tool adoption see 40-60% improvement in AI output quality with IPE context.'
        });
      }

      // Organizational insights
      if (orgScore < 10) {
        insights.push({
          type: 'org',
          icon: 'users',
          color: 'blue',
          title: 'Sponsorship Strategy Needed',
          text: 'Securing executive sponsorship is critical for IPE success. Consider starting with a pilot program to demonstrate value.',
          value: 'Pilot programs with clear ROI metrics help secure executive buy-in in 60% of cases.'
        });
      } else if (orgScore >= 20) {
        insights.push({
          type: 'org',
          icon: 'trending-up',
          color: 'blue',
          title: 'Strong Organizational Readiness',
          text: 'Your executive sponsorship and budget alignment indicate readiness for transformation. This positions you for accelerated value delivery.',
          value: 'Organizations with strong sponsorship see 50% faster time-to-value.'
        });
      }

      // Path-specific insights
      if (recommendedPath === 'J3') {
        insights.push({
          type: 'path',
          icon: 'rocket',
          color: 'emerald',
          title: 'Scale-Ready Opportunity',
          text: 'Scaling represents the largest share of enterprise value. Your organization shows the right signals for a full transformation.',
          value: 'Organizations at this tier typically unlock material value over 18-24 months.'
        });
      } else if (recommendedPath === 'J4') {
        insights.push({
          type: 'path',
          icon: 'brain',
          color: 'violet',
          title: 'Intelligence Phase Ready',
          text: 'Your mature foundation and AI readiness make you an ideal candidate for AI workflow expansion. Focus on governed AI integration and scale.',
          value: 'J4 accounts see fastest ROI—typically 6-8 weeks to first AI-assisted production deployment.'
        });
      }

      return insights;
    }

    function generateCostOfInaction(foundationScore, aiScore, orgScore, totalScore, recommendedPath) {
      const costs = [];

      // Foundation-related costs
      if (foundationScore < 20) {
        costs.push({
          icon: 'trending-down',
          title: 'Fragmentation grows over time',
          description: 'Without a governed system of record, teams build overlapping patterns and one-off components that slow delivery.',
          impact: 'Technical debt compounds ~15–25% per quarter without intervention'
        });
      } else if (foundationScore >= 20 && foundationScore < 30) {
        costs.push({
          icon: 'users-x',
          title: 'Adoption stalls without governance',
          description: 'The system exists, but value is uneven without governance and adoption enablement.',
          impact: 'Adoption typically stalls around 30–70% without governance'
        });
      }

      // AI-related costs
      if (aiScore >= 10) {
        costs.push({
          icon: 'code',
          title: 'AI output requires more rework',
          description: 'Teams use AI tools, but outputs lack governed context. This creates review cycles and slows time-to-merge.',
          impact: '40–60% of AI-generated code requires manual fixes without governed context'
        });
      } else if (aiScore < 10) {
        costs.push({
          icon: 'clock',
          title: 'AI readiness gap widens',
          description: 'AI adoption is accelerating. Establishing governance early prevents costly retrofits later.',
          impact: 'Delayed governance costs 2–3x more than building it early'
        });
      }

      // Organizational costs
      if (orgScore < 15) {
        costs.push({
          icon: 'dollar-sign',
          title: 'Momentum and budget windows shrink',
          description: 'Without sponsorship, initiatives compete with other priorities and lose momentum.',
          impact: 'Budget windows typically reset every 6–12 months'
        });
      }

      // Path-specific costs
      if (recommendedPath === 'J3') {
        costs.push({
          icon: 'x-circle',
          title: 'Scale value stays unrealized',
          description: 'The largest gains come from scaling adoption. Delays push measurable outcomes further out.',
          impact: 'Scale programs unlock material value over 18–24 months when executed'
        });
      } else if (recommendedPath === 'J4') {
        costs.push({
          icon: 'zap',
          title: 'AI advantage erodes',
          description: 'You have the foundation to move quickly. Waiting reduces the opportunity to lead with AI-enabled delivery.',
          impact: 'Delays can surrender a 6–8 week head start to competitors'
        });
      } else if (recommendedPath === 'J2') {
        costs.push({
          icon: 'calendar-x',
          title: 'Time-bound opportunities pass',
          description: 'Rapid enablement works best with a clear trigger (launch, rollout, org change).',
          impact: 'Trigger windows typically last 3–6 months'
        });
      } else if (recommendedPath === 'J1') {
        costs.push({
          icon: 'building',
          title: 'Foundation becomes harder to standardize',
          description: 'As more teams ship independently, alignment becomes more complex.',
          impact: 'Each quarter of delay makes foundation 15–20% harder to establish'
        });
      }

      // Velocity cost (always relevant)
      costs.push({
        icon: 'gauge',
        title: 'Delivery speed stays flat',
        description: 'While competitors improve delivery cycles with governed systems, your teams maintain current speed.',
        impact: 'Organizations with governed systems see 40–60% faster development cycles'
      });

      return costs.slice(0, 4); // Limit to 4 most relevant costs
    }

    function getOpportunityCostMessage(recommendedPath, totalScore) {
      const messages = {
        'J1': 'Starting earlier keeps the foundation small enough to align quickly and avoids costly retrofits later.',
        'J2': 'Timing matters for rapid activation. Acting during the trigger window preserves speed and momentum.',
        'J3': 'Scaling unlocks the largest gains. Organizations at this tier see material value within 18–24 months when adoption scales.',
        'J4': 'You are positioned to move fast. Delays can forfeit a 6–8 week AI delivery advantage.'
      };
      return messages[recommendedPath] || 'Every quarter you delay, you\'re missing out on significant value and competitive advantage.';
    }

    function getRoiBusinessCase(recommendedPath) {
      const cases = {
        J1: {
          summary: 'Foundation-focused organizations typically see early ROI from reduced rework and faster enablement.',
          annual: 'Moderate',
          threeYear: 'Short to mid-term',
          assumption: 'Based on conservative productivity and governance gains in the first 12 months.',
          drivers: [
            { title: 'Rework reduction', desc: 'Fewer one-off components and duplicated effort.' },
            { title: 'Faster onboarding', desc: 'Teams ramp on shared patterns sooner.' },
            { title: 'Governance efficiency', desc: 'Clear decision flow reduces delays.' }
          ]
        },
        J2: {
          summary: 'Momentum paths capture near-term gains when timing is critical.',
          annual: 'High',
          threeYear: 'Short-term',
          assumption: 'Based on compressing delivery timelines during an active trigger window.',
          drivers: [
            { title: 'Release velocity', desc: 'Compressed timelines for launch-critical work.' },
            { title: 'Fewer escalations', desc: 'Clear guardrails reduce back-and-forth.' },
            { title: 'Time-to-market', desc: 'Earlier launches drive revenue impact.' }
          ]
        },
        J3: {
          summary: 'Scale programs deliver the largest measurable gains across teams.',
          annual: 'Very high',
          threeYear: 'Mid-term',
          assumption: 'Based on typical activation outcomes in regulated or complex environments.',
          drivers: [
            { title: 'Cycle-time reduction', desc: '40–60% faster delivery cycles with governed context.' },
            { title: 'AI output quality', desc: 'Higher signal-to-noise in AI-assisted code.' },
            { title: 'Adoption depth', desc: 'More teams shipping with the system of record.' }
          ]
        },
        J4: {
          summary: 'Intelligence paths convert readiness into AI-assisted execution.',
          annual: 'High',
          threeYear: 'Mid to long-term',
          assumption: 'Based on AI workflow enablement and expansion of governed AI delivery.',
          drivers: [
            { title: 'Governed AI workflows', desc: 'AI that can act safely at scale.' },
            { title: 'Policy automation', desc: 'Rules enforce consistency without manual review.' },
            { title: 'Faster iteration', desc: 'More changes shipped with confidence.' }
          ]
        }
      };
      return cases[recommendedPath] || cases.J1;
    }

    function getBenchmarkLabel(totalScore, benchmarkData) {
      if (totalScore >= benchmarkData.topQuartile) return 'Top Quartile';
      if (totalScore >= benchmarkData.industryAvg) return 'Above Average';
      if (totalScore >= 30) return 'Below Average';
      return 'Early Stage';
    }

    function generateBenchmarkComparison(totalScore, foundationScore, aiScore, orgScore, recommendedPath, industry) {
      const benchmarks = getIndustryBenchmarks(industry);
      const industryAvg = benchmarks.industryAvg;
      const topQuartile = benchmarks.topQuartile;
      
      let comparison = '';
      let comparisonDetail = '';
      
      if (totalScore >= topQuartile) {
        comparison = 'You\'re in the top quartile';
        comparisonDetail = '—organizations at this level typically see 40-60% faster development cycles with IPE activation.';
      } else if (totalScore >= industryAvg) {
        comparison = 'You\'re above industry average';
        comparisonDetail = '—organizations in this range unlock significant value through targeted activation programs.';
      } else if (totalScore >= 30) {
        comparison = 'You\'re below industry average';
        comparisonDetail = '—but within range for transformation. Organizations at this level see the highest ROI from foundation-building.';
      } else {
        comparison = 'You\'re in the early stages';
        comparisonDetail = '—organizations starting here benefit most from building governance early, before technical debt compounds.';
      }
      
      return {
        industryAvg,
        topQuartile,
        comparison,
        comparisonDetail,
        industryLabel: benchmarks.label
      };
    }

    function getIndustryBenchmarks(industry) {
      const benchmarkMap = {
        'Financial Services': { industryAvg: 83.4, topQuartile: 88.0, label: 'Financial Services' },
        'Enterprise Software': { industryAvg: 86.7, topQuartile: 99.0, label: 'Enterprise Software' },
        'Technology / Media': { industryAvg: 85.0, topQuartile: 99.0, label: 'Technology / Media' },
        'Healthcare': { industryAvg: 81.4, topQuartile: 81.0, label: 'Healthcare' },
        'Retail / E-commerce': { industryAvg: 82.6, topQuartile: 81.0, label: 'Retail / E-commerce' },
        'Telecommunications / Media': { industryAvg: 78.2, topQuartile: 77.0, label: 'Telecommunications / Media' },
        'Regulated / Industrial': { industryAvg: 81.0, topQuartile: 81.0, label: 'Regulated / Industrial' },
        'International / Industrial': { industryAvg: 93.0, topQuartile: 99.0, label: 'International / Industrial' },
        'Travel / Hospitality': { industryAvg: 81.0, topQuartile: 81.0, label: 'Travel / Hospitality' },
        'Aerospace / Space': { industryAvg: 52.0, topQuartile: 52.0, label: 'Aerospace / Space' },
        'Education (Nonprofit)': { industryAvg: 65.0, topQuartile: 65.0, label: 'Education (Nonprofit)' },
        'Utilities (Electric)': { industryAvg: 58.0, topQuartile: 58.0, label: 'Utilities (Electric)' },
        'Other / Unknown': { industryAvg: 72.6, topQuartile: 81.0, label: 'Cross-industry' },
        'Unknown': { industryAvg: 57.7, topQuartile: 58.0, label: 'Cross-industry' }
      };
      return benchmarkMap[industry] || { industryAvg: 72.6, topQuartile: 81.0, label: 'Cross-industry' };
    }

    function generateNarrativeSummary(foundationScore, aiScore, orgScore, totalScore, recommendedPath) {
      const foundation = foundationScore >= 30 ? 'strong' : foundationScore >= 15 ? 'moderate' : 'early';
      const ai = aiScore >= 20 ? 'ready' : aiScore >= 10 ? 'emerging' : 'early';
      const org = orgScore >= 20 ? 'strong' : orgScore >= 10 ? 'moderate' : 'early';
      const tierNames = { J1: 'Foundation', J2: 'Momentum', J3: 'Scale', J4: 'Intelligence' };
      const deliveryCulture = getDeliveryCultureSummary();
      return `Your results show a ${foundation} product system foundation, ${ai} AI readiness, and ${org} organizational alignment. This combination aligns with the ${tierNames[recommendedPath]} tier and highlights where to focus first so your design system evolves into a governed product system that ships faster and more consistently.${deliveryCulture ? ` ${deliveryCulture}` : ''}`;
    }

    function getDeliveryCultureSummary() {
      const decision = getAssessmentAnswer('decisionClarity');
      const pace = getAssessmentAnswer('experimentPace');
      const collaboration = getAssessmentAnswer('collaboration');
      const workflow = getAssessmentAnswer('workflow');

      const labels = {
        low: 'early',
        medium: 'developing',
        high: 'strong'
      };

      const parts = [];
      if (decision) parts.push(`decision clarity is ${labels[decision] || decision}`);
      if (pace) parts.push(`experimentation pace is ${labels[pace] || pace}`);
      if (collaboration) parts.push(`cross‑functional collaboration is ${labels[collaboration] || collaboration}`);
      if (workflow) parts.push(`delivery workflow consistency is ${labels[workflow] || workflow}`);
      if (parts.length === 0) return '';
      return `You also reported that ${parts.join(', ')}.`;
    }

    function getAssessmentAnswer(key) {
      const index = questions.findIndex(q => q.key === key);
      if (index < 0) return '';
      return answers[index];
    }

    function getLeadershipPov(foundationScore, aiScore, orgScore, recommendedPath) {
      const pathFocus = {
        J1: 'Start by establishing a system of record so standards scale without rework.',
        J2: 'Speed matters, but governance keeps speed from creating risk.',
        J3: 'Scaling is where value compounds. The system must drive decisions, not just documentation.',
        J4: 'Governed context unlocks safe AI execution at scale.'
      };

      return {
        summary: `The best teams treat the design system as a product system—governed, measurable, and used in production. ${pathFocus[recommendedPath] || pathFocus.J1}`,
        bullets: [
          { title: 'Governed standards', text: 'Rules and metadata guide every change.' },
          { title: 'Adoption focus', text: 'Value shows up when teams ship with the system.' },
          { title: 'AI readiness', text: 'Context turns AI from experiments into safe execution.' }
        ],
        emphasis: 'Your next steps should deepen governance, adoption, and AI readiness in that order.'
      };
    }

    function getTierOutcome(recommendedPath) {
      const outcomes = {
        J1: 'This tier builds the foundation that unlocks consistent delivery and sets you up for AI-ready scale.',
        J2: 'This tier compresses timelines with a focused activation sprint to hit near-term launch goals.',
        J3: 'This tier typically unlocks 40–60% faster delivery in 12–16 weeks with full activation support.',
        J4: 'This tier accelerates AI-enabled delivery by applying governed context to production workflows.'
      };
      return outcomes[recommendedPath] || 'This tier focuses on measurable delivery improvements and readiness acceleration.';
    }

    function getMcpReadinessStatus(foundationScore, aiScore) {
      if (foundationScore >= 30 && aiScore >= 20) return 'Ready';
      if (foundationScore >= 20 && aiScore >= 10) return 'Prep';
      return 'Locked';
    }

    function getPeerPosition(score, maxScore) {
      const ratio = score / maxScore;
      if (ratio >= 0.75) return { label: 'Above ~75% of peers', percent: 75 };
      if (ratio >= 0.5) return { label: 'Above ~60% of peers', percent: 60 };
      if (ratio >= 0.25) return { label: 'Below ~60% of peers', percent: 40 };
      return { label: 'Below ~75% of peers', percent: 25 };
    }

    function getBenchmarkStory(foundationScore, aiScore, orgScore) {
      const foundationBand = foundationScore >= 30 ? 'top' : foundationScore >= 20 ? 'above' : foundationScore >= 10 ? 'below' : 'early';
      const aiBand = aiScore >= 20 ? 'top' : aiScore >= 10 ? 'above' : aiScore >= 5 ? 'below' : 'early';
      const orgBand = orgScore >= 20 ? 'top' : orgScore >= 10 ? 'above' : orgScore >= 5 ? 'below' : 'early';
      const bandMap = {
        top: 'above ~75% of peers',
        above: 'above ~60% of peers',
        below: 'below ~60% of peers',
        early: 'below ~75% of peers'
      };
      return `You are ${bandMap[foundationBand]} in Foundation, ${bandMap[aiBand]} in AI readiness, and ${bandMap[orgBand]} in Organizational readiness.`;
    }

    function getNextBestInvestment(foundationScore, aiScore, orgScore, recommendedPath) {
      if (foundationScore < 15) return 'Component inventory + governance baseline';
      if (aiScore < 10) return 'AI context + rules engine alignment';
      if (orgScore < 10) return 'Executive sponsorship + change enablement plan';
      if (recommendedPath === 'J4') return 'Governed AI workflows + safe scale-out';
      if (recommendedPath === 'J3') return 'Governance activation + adoption depth';
      if (recommendedPath === 'J2') return 'Rapid enablement on priority workflows';
      return 'Readiness review + foundation roadmap';
    }

    // Initialize
    lucide.createIcons();
  </script>
</body>
</html>

